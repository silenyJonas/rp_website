
<div class="product-card-list-container">
  <div *ngFor="let product of products" class="product-card" (click)="openPopup(product)">
    <div class="product-info">
      <h3 class="product-name">{{ product.name }}</h3>
      <p class="product-short-description">{{ product.shortDescription }}</p>
      <div class="product-price">{{ product.price }}</div>
      <button class="product-details-button">Zobrazit detaily</button>
    </div>
  </div>
</div>

<div *ngIf="isPopupOpen" class="product-popup-overlay" (click)="onOverlayClick($event)">
  <div class="product-popup-content">

    <div class="popup-fixed-header">
      <button class="popup-close-button" (click)="closePopup()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          <path d="M0 0h24v24H0z" fill="none"/>
        </svg>
      </button>

      <div class="popup-header">
        <div class="popup-product-name">{{ selectedProduct?.name }}</div>
        <div class="popup-product-price">{{ selectedProduct?.price }}</div>
      </div>
    </div>

    <div class="popup-scrollable-body">
      
      <div *ngIf="selectedProduct?.popupType === 'survey-software'" class="popup-details-section popup-type-survey-software">
        <h3>Podrobnosti</h3>
        <p [innerHTML]="selectedProduct?.details?.longDescription"></p>
        <h4>Klíčové vlastnosti:</h4>
        <ul>
          <li *ngFor="let feature of selectedProduct?.details?.features">{{ feature }}</li>
        </ul>
        <p>Technologie: <strong>{{ selectedProduct?.details?.technologyStack }}</strong></p>
        <img [src]="selectedProduct?.details?.screenshotUrl" alt="Snímek dotazníkového softwaru" class="popup-detail-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/333333/FFFFFF?text=Obrázek+není+dostupný';" />
        <p>Podpora: {{ selectedProduct?.details?.supportInfo }}</p>
      </div>

      <div *ngIf="selectedProduct?.popupType === 'user-management-system'" class="popup-details-section popup-type-user-management">
        <h3>Podrobnosti</h3>
        <p [innerHTML]="selectedProduct?.details?.longDescription"></p>
        <h4>Hlavní funkce:</h4>
        <ul>
          <li *ngFor="let feature of selectedProduct?.details?.features">{{ feature }}</li>
        </ul>
        <p>Technologie: <strong>{{ selectedProduct?.details?.technologyStack }}</strong></p>
        <img [src]="selectedProduct?.details?.screenshotUrl" alt="Snímek systému správy" class="popup-detail-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/333333/FFFFFF?text=Obrázek+není+dostupný';" />
        <p>Podpora: {{ selectedProduct?.details?.supportInfo }}</p>
      </div>
      
      <div *ngIf="selectedProduct?.popupType === 'analytics-tool'" class="popup-details-section popup-type-analytics-tool">
        <h3>Podrobnosti</h3>
        <p [innerHTML]="selectedProduct?.details?.longDescription"></p>
        <h4>Klíčové vlastnosti:</h4>
        <ul>
          <li *ngFor="let feature of selectedProduct?.details?.features">{{ feature }}</li>
        </ul>
        <p>Technologie: <strong>{{ selectedProduct?.details?.technologyStack }}</strong></p>
        <img [src]="selectedProduct?.details?.screenshotUrl" alt="Snímek analytického nástroje" class="popup-detail-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/333333/FFFFFF?text=Obrázek+není+dostupný';" />
        <p>Podpora: {{ selectedProduct?.details?.supportInfo }}</p>
      </div>

      <div *ngIf="!selectedProduct?.popupType || (selectedProduct?.popupType !== 'survey-software' && selectedProduct?.popupType !== 'user-management-system' && selectedProduct?.popupType !== 'analytics-tool')" class="popup-details-section popup-type-default">
        <h3>Obecné detaily</h3>
        <p>{{ selectedProduct?.details?.longDescription || selectedProduct?.shortDescription }}</p>
        <p>Pro více informací o tomto produktu nás prosím kontaktujte přímo.</p>
      </div>

      <div class="popup-footer">
        <button class="popup-action-button" (click)="closePopup()">Zavřít</button>
      </div>
    </div>
  </div>
</div>