import{a as j}from"./chunk-2KAUNJ32.js";import{d as Te,e as A,f as De,g as Ie,i as V}from"./chunk-VF4TSUWI.js";import{b as Re,c as Fe,f as ze,i as $e,j as Le,k as Ae,q as Q}from"./chunk-EDBXCDAV.js";import{A as se,B as ke,C as J,j as Se,k as Z,l as L,m as Oe,n as Ee,o as we,r as K,s as Me,t as M}from"./chunk-BPBWVEAM.js";import{$ as re,$a as a,Ab as ye,Bb as Pe,Ea as f,Fb as $,G as me,J as R,Ja as E,K as G,Ka as fe,La as he,N as F,Na as W,O as ge,Oa as u,S as D,Va as be,Wa as p,Y as B,Z as _,_ as C,_a as o,a as de,aa as ue,ab as w,bb as x,cb as v,db as ae,h as pe,hb as P,ib as d,m as S,nb as _e,ob as c,p as I,pb as z,qb as O,rb as Ce,sb as U,tb as q,ub as H,wa as oe,x as b,xb as xe,yb as ve,za as l}from"./chunk-KQIGX7DT.js";function Ve(r,t){if(r&1&&(x(0),c(1),v()),r&2){let e=d();l(),O(" ",e.userEmail," | ")}}function Ge(r,t){r&1&&(x(0),c(1," Nep\u0159ihl\xE1\u0161en\xFD u\u017Eivatel | "),v())}var X=class r{constructor(t,e){this.router=t;this.authService=e}userEmail=null;isLoggedIn=!1;authSubscription;currentDate=new Date;ngOnInit(){this.authSubscription=this.authService.isLoggedIn$.subscribe(t=>{this.isLoggedIn=t,t?this.userEmail=this.authService.getUserEmail():this.userEmail=null}),this.authService.checkAuth().subscribe(t=>{this.isLoggedIn=t,t?this.userEmail=this.authService.getUserEmail():this.userEmail=null})}logout(){this.authService.logout().subscribe({next:()=>{console.log("Odhl\xE1\u0161en\xED \xFAsp\u011B\u0161n\xE9."),this.router.navigate(["/auth/login"])},error:t=>{console.error("Chyba p\u0159i odhl\xE1\u0161en\xED:",t),this.router.navigate(["/auth/login"])}})}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||r)(f(A),f(j))};static \u0275cmp=E({type:r,selectors:[["app-admin-layout"]],decls:24,vars:6,consts:[[1,"header-item"],[4,"ngIf"],[1,"admin-dashboard-wrapper"],[1,"admin-sidebar"],[1,"admin-nav"],["routerLink","/admin/dashboard","routerLinkActive","active"],["routerLink","/admin/user-request","routerLinkActive","active"],[1,"sidebar-footer"],[3,"click"],[1,"admin-content"]],template:function(e,n){e&1&&(o(0,"header")(1,"div",0),u(2,Ve,2,1,"ng-container",1)(3,Ge,2,0,"ng-container",1),a(),o(4,"div",0),c(5," (sysadmin) | "),a(),o(6,"div",0),c(7),ve(8,"date"),a()(),o(9,"div",2)(10,"aside",3)(11,"nav",4)(12,"ul")(13,"li")(14,"a",5),c(15,"Dashboard"),a()(),o(16,"li")(17,"a",6),c(18,"User Requests"),a()()()(),o(19,"div",7)(20,"button",8),P("click",function(){return n.logout()}),c(21,"Logout"),a()()(),o(22,"main",9),w(23,"router-outlet"),a()()),e&2&&(l(2),p("ngIf",n.isLoggedIn&&n.userEmail),l(),p("ngIf",!n.isLoggedIn&&!n.userEmail),l(4),O(" ",ye(8,3,n.currentDate,"HH:mm dd. MMMM yyyy"),`
`))},dependencies:[M,L,K,V,Te,De,Ie],styles:[".admin-dashboard-wrapper[_ngcontent-%COMP%]{display:flex;min-height:calc(100vh - 25px);background-color:#f0f2f5;font-family:Segoe UI,Roboto,sans-serif;font-size:.95rem}.admin-sidebar[_ngcontent-%COMP%]{width:160px;background-color:#fff;color:#546e7a;display:flex;flex-direction:column;border-right:none;border-right:1px solid rgb(121,121,121)}.sidebar-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;padding:0 10px}.sidebar-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem;margin:0;color:#64b5f6;font-weight:600}.admin-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:6px 25px;color:#000;text-decoration:none;font-size:.9rem;border-left:3px solid transparent}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#e3f2fd;color:#000;border-left-color:#42a5f5}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#bbdefb;color:#1e88e5;font-weight:600;border-left-color:#1e88e5}.sidebar-footer[_ngcontent-%COMP%]{margin-top:auto;padding:15px;text-align:center;border-top:1px solid #eceff1}.sidebar-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#ff7043;color:#fff;border:none;padding:8px 18px;border-radius:4px;cursor:pointer;font-size:.9em;font-weight:500;transition:background-color .2s ease,box-shadow .2s ease}.sidebar-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f4511e;box-shadow:0 4px 8px #00000026}.admin-content[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;background-color:#fff;color:#424242;padding:10px}header[_ngcontent-%COMP%]{width:100vw;border-bottom:1px solid rgb(121,121,121);display:flex;align-items:center;background-color:#fff}.header-item[_ngcontent-%COMP%]{height:100%;width:auto;padding:3px}"]})};var Y=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-dashboard"]],decls:7,vars:0,consts:[[1,"dashboard-container"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"h1"),c(2,"Admin Dashboard"),a(),o(3,"p"),c(4,"Welcome to the administration panel!"),a(),o(5,"p"),c(6,"Here you can manage your website's content."),a()())},dependencies:[M],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:40px;text-align:center;max-width:900px;margin:50px auto;background-color:#e8f5e9;border-radius:8px;box-shadow:0 4px 12px #0000001a;border:1px solid #c8e6c9}h1[_ngcontent-%COMP%]{color:#2e7d32;margin-bottom:20px}p[_ngcontent-%COMP%]{color:#43a047;line-height:1.6}"]})};var T=class r{constructor(t){this.http=t}getHeaders(t="application/json"){return t==="application/json"?new se({"Content-Type":"application/json",Accept:"application/json"}):new se({Accept:"application/json"})}handleError=t=>{let e="Nastala nezn\xE1m\xE1 chyba!";if(t.error instanceof ErrorEvent)e=`Chyba na stran\u011B klienta: ${t.error.message}`;else if(console.error(`Backend vr\xE1til k\xF3d ${t.status}, t\u011Blo odpov\u011Bdi: ${JSON.stringify(t.error)}`),t.status===0)e="Nelze se p\u0159ipojit k serveru. Zkontrolujte s\xED\u0165ov\xE9 p\u0159ipojen\xED nebo zda API b\u011B\u017E\xED.";else if(t.status>=400&&t.status<500)if(t.error&&t.error.message)e=`Chyba klienta (${t.status}): ${t.error.message}`;else if(t.error&&t.error.errors){let n=Object.values(t.error.errors).flat().join("; ");e=`Chyba validace (${t.status}): ${n}`}else e=`Chyba klienta: ${t.status} ${t.statusText||""}`;else t.status>=500&&(e=`Chyba serveru (${t.status}): ${t.statusText||"Intern\xED chyba serveru"}`);return console.error(`Chyba API: ${e}`),S(()=>new Error(e))};getCollection(t){return this.http.get(t,{headers:this.getHeaders()}).pipe(I(e=>e.data),b(this.handleError))}getOne(t){return this.http.get(t,{headers:this.getHeaders()}).pipe(I(e=>e.data),b(this.handleError))}post(t,e){return this.http.post(t,e,{headers:this.getHeaders()}).pipe(I(n=>n.data),b(this.handleError))}put(t,e){return this.http.put(t,e,{headers:this.getHeaders()}).pipe(I(n=>n.data),b(this.handleError))}patch(t,e){return this.http.patch(t,e,{headers:this.getHeaders()}).pipe(I(n=>n.data),b(this.handleError))}delete(t){return console.log(`DataService: Ma\u017Eu data z ${t}`),this.http.delete(t,{headers:this.getHeaders()}).pipe(b(this.handleError))}upload(t,e){console.log("DataService: Odes\xEDl\xE1m FormData na",t);let n={};return e.forEach((i,s)=>{try{n[s]=JSON.parse(i)}catch{n[s]=i}}),console.log("Data formul\xE1\u0159e k odesl\xE1n\xED (bez soubor\u016F):",JSON.stringify(n,null,2)),this.http.post(t,e,{headers:this.getHeaders("multipart/form-data")}).pipe(b(this.handleError))}static \u0275fac=function(e){return new(e||r)(D(J))};static \u0275prov=F({token:r,factory:r.\u0275fac,providedIn:"root"})};var N=class r{constructor(t,e){this.dataHandler=t;this.cd=e}data=[];isLoading=!1;errorMessage=null;destroy$=new pe;ngOnInit(){}ngOnChanges(t){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadData(){if(!this.apiEndpoint){let t="Chyba: API endpoint nen\xED definov\xE1n v d\u011Bd\xEDc\xED komponent\u011B. Nelze na\u010D\xEDst data.";this.errorMessage=t,console.error(t);return}this.isLoading=!0,this.errorMessage=null,this.dataHandler.getCollection(this.apiEndpoint).pipe(R(this.destroy$),b(t=>(this.isLoading=!1,this.errorMessage=t.message||"Nezn\xE1m\xE1 chyba p\u0159i na\u010D\xEDt\xE1n\xED dat.",console.error(`Chyba p\u0159i na\u010D\xEDt\xE1n\xED z ${this.apiEndpoint}:`,t),this.cd.markForCheck(),S(()=>t)))).subscribe({next:t=>{this.data=t,this.isLoading=!1,this.cd.markForCheck()},error:t=>{},complete:()=>{this.isLoading=!1,this.cd.markForCheck()}})}postData(t){return this.isLoading=!0,this.errorMessage=null,this.dataHandler.post(this.apiEndpoint,t).pipe(R(this.destroy$),b(e=>(this.isLoading=!1,this.errorMessage=e.message||"Nezn\xE1m\xE1 chyba p\u0159i vytv\xE1\u0159en\xED dat.",console.error(`Chyba p\u0159i POST na ${this.apiEndpoint}:`,e),this.cd.markForCheck(),S(()=>e))))}updateData(t,e){if(t==null){let i="Chyba: ID z\xE1znamu pro aktualizaci nen\xED definov\xE1no.";return this.errorMessage=i,console.error(i),S(()=>new Error(i))}this.isLoading=!0,this.errorMessage=null;let n=`${this.apiEndpoint}/${t}`;return this.dataHandler.put(n,e).pipe(R(this.destroy$),b(i=>(this.isLoading=!1,this.errorMessage=i.message||"Nezn\xE1m\xE1 chyba p\u0159i aktualizaci dat.",console.error(`Chyba p\u0159i PUT na ${n}:`,i),this.cd.markForCheck(),S(()=>i))))}deleteData(t){if(t==null){let n="Chyba: ID z\xE1znamu pro smaz\xE1n\xED nen\xED definov\xE1no.";return this.errorMessage=n,console.error(n),S(()=>new Error(n))}this.isLoading=!0,this.errorMessage=null;let e=`${this.apiEndpoint}/${t}`;return this.dataHandler.delete(e).pipe(R(this.destroy$),b(n=>(this.isLoading=!1,this.errorMessage=n.message||"Nezn\xE1m\xE1 chyba p\u0159i maz\xE1n\xED dat.",console.error(`Chyba p\u0159i DELETE na ${e}:`,n),this.cd.markForCheck(),S(()=>n))))}uploadData(t,e){let n=e||this.apiEndpoint;return this.isLoading=!0,this.errorMessage=null,this.dataHandler.upload(n,t).pipe(R(this.destroy$),b(i=>(this.isLoading=!1,this.errorMessage=i.message||"Nezn\xE1m\xE1 chyba p\u0159i nahr\xE1v\xE1n\xED dat.",console.error(`Chyba p\u0159i nahr\xE1v\xE1n\xED na ${n}:`,i),this.cd.markForCheck(),S(()=>i))))}static \u0275fac=function(e){return new(e||r)(f(T),f($))};static \u0275dir=he({type:r,features:[B]})};function We(r,t){if(r&1&&(o(0,"caption")(1,"div",5)(2,"div",6),c(3),a()()()),r&2){let e=d();l(3),O(" ",e.tableCaption," ")}}function Ze(r,t){if(r&1&&(o(0,"th"),x(1),o(2,"span",7),c(3),a(),v(),a()),r&2){let e=t.$implicit;l(3),O(" ",e.header," ")}}function Ke(r,t){if(r&1&&w(0,"img",12),r&2){let e=d(3).$implicit,n=d().$implicit,i=d(2);p("src",i.getCellValue(n,e),oe)}}function Je(r,t){r&1&&(o(0,"span"),c(1,"Nen\xED obr\xE1zek"),a())}function Qe(r,t){if(r&1&&(x(0),u(1,Ke,1,1,"img",11)(2,Je,2,0,"span",2),v()),r&2){let e=d(2).$implicit,n=d().$implicit,i=d(2);l(),p("ngIf",i.getCellValue(n,e)),l(),p("ngIf",!i.getCellValue(n,e))}}function Xe(r,t){if(r&1&&(x(0),o(1,"a",13),c(2),a(),v()),r&2){let e=d(2).$implicit,n=d().$implicit,i=d(2);l(),p("href",i.getCellValue(n,e),oe),l(),z(i.getCellValue(n,e))}}function Ye(r,t){if(r&1&&(x(0),c(1),v()),r&2){let e=d(2).$implicit,n=d().$implicit,i=d(2);l(),O(" ",i.getCellValue(n,e)," ")}}function et(r,t){if(r&1&&(o(0,"td"),x(1,8),u(2,Qe,3,2,"ng-container",9)(3,Xe,3,2,"ng-container",9)(4,Ye,2,1,"ng-container",10),v(),a()),r&2){let e=d().$implicit;l(),p("ngSwitch",e.type),l(),p("ngSwitchCase","image"),l(),p("ngSwitchCase","link")}}function tt(r,t){if(r&1&&(x(0),u(1,et,5,3,"td",2),v()),r&2){let e=t.$implicit;l(),p("ngIf",!e.hidden)}}function nt(r,t){if(r&1&&(o(0,"tr"),u(1,tt,2,1,"ng-container",3),a()),r&2){let e=d(2);l(),p("ngForOf",e.columnDefinitions)}}function it(r,t){if(r&1&&(x(0),u(1,nt,2,1,"tr",3),v()),r&2){let e=d();l(),p("ngForOf",e.data)}}function rt(r,t){if(r&1&&(o(0,"tr")(1,"td",14),c(2," Nebyla nalezena \u017E\xE1dn\xE1 data. "),a()()),r&2){let e=d();l(),be("colspan",e.columnDefinitions.length)}}var ee=class r extends N{constructor(e,n){super(e,n);this.dataHandler=e;this.cd=n}data=[];columnDefinitions=[];tableCaption;apiEndpoint="";isLoading=!1;uploadsBaseUrl="";ngOnChanges(e){super.ngOnChanges(e)}ngOnInit(){super.ngOnInit()}getCellValue(e,n){let s=n.key.split(".").reduce((m,y)=>m?.[y],e);switch(n.type){case"currency":return s?new Me("cs-CZ").transform(s,"CZK","symbol-narrow","1.2-2"):"";case"date":return s?new K("cs-CZ").transform(s,n.format||"shortDate"):"";case"boolean":return s?"Ano":"Ne";case"image":return s?`${this.uploadsBaseUrl}${s}`:"";case"array":return Array.isArray(s)?s.join(", "):s;case"object":return this.isObject(s)?JSON.stringify(s):s;default:return s}}isObject(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}static \u0275fac=function(n){return new(n||r)(f(T),f($))};static \u0275cmp=E({type:r,selectors:[["app-generic-table"]],inputs:{data:"data",columnDefinitions:[0,"columns","columnDefinitions"],tableCaption:"tableCaption",apiEndpoint:"apiEndpoint",isLoading:"isLoading",uploadsBaseUrl:"uploadsBaseUrl"},features:[W,B],decls:10,vars:4,consts:[["noDataContent",""],[1,"table-responsive"],[4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"caption-content-wrapper"],[1,"caption-text"],[1,"header-content"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["alt","Obr\xE1zek","class","table-cell-image",3,"src",4,"ngIf"],["alt","Obr\xE1zek",1,"table-cell-image",3,"src"],["target","_blank",3,"href"],[1,"no-data-msg"]],template:function(n,i){if(n&1&&(o(0,"div",1)(1,"table"),u(2,We,4,1,"caption",2),o(3,"thead")(4,"tr"),u(5,Ze,4,1,"th",3),a()(),o(6,"tbody"),u(7,it,2,1,"ng-container",4)(8,rt,3,1,"ng-template",null,0,Pe),a()()()),n&2){let s=_e(9);l(2),p("ngIf",i.tableCaption),l(3),p("ngForOf",i.columnDefinitions),l(2),p("ngIf",i.data&&i.data.length>0)("ngIfElse",s)}},dependencies:[M,Z,L,Oe,Ee,we,Q],styles:[".table-responsive[_ngcontent-%COMP%]{overflow-x:auto;margin-bottom:1rem;border:1px solid #dee2e6;border-radius:6px;max-width:100%}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-family:Arial,sans-serif;font-size:.85rem;table-layout:fixed}caption[_ngcontent-%COMP%]{caption-side:top;font-weight:700;text-align:left;padding:.4rem;border-bottom:1px solid #dee2e6;font-size:.9rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.4rem .6rem;text-align:left;border:1px solid #dee2e6;vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}thead[_ngcontent-%COMP%]{background-color:#f1f1f1}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#fafafa}tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}p[_ngcontent-%COMP%]{font-style:normal;color:#444;margin:0;padding:0;font-size:.85rem;line-height:1.5}.table-cell-image[_ngcontent-%COMP%]{max-width:50px;max-height:50px;object-fit:cover;border-radius:4px;display:block;margin:0 auto}.no-data-msg[_ngcontent-%COMP%]{color:#888;font-style:italic;font-size:.85rem;padding-left:15px;text-align:center}"],changeDetection:0})};var te=class r{constructor(t){this.http=t}baseUrl="/api";pageCache=new Map;lastFilterParams={};getPaginatedData(t,e=1,n=15,i={}){JSON.stringify(i)!==JSON.stringify(this.lastFilterParams)&&(this.clearCache(),this.lastFilterParams=de({},i),console.log("Filtry se zm\u011Bnily, cache vy\u010Di\u0161t\u011Bna."));let s=this.getCacheKey(t,e,n,i);if(this.pageCache.has(s))return console.log(`Cache hit for ${s}`),this.pageCache.get(s);let m=new ke;m=m.append("page",e.toString()),m=m.append("per_page",n.toString());for(let g in i)i.hasOwnProperty(g)&&i[g]!==void 0&&i[g]!==null&&i[g]!==""&&(m=m.append(g,i[g].toString()));let y=this.http.get(`${this.baseUrl}/${t}`,{params:m}).pipe(G(()=>console.log(`Fetched from API: ${s}`)),me(1));return this.pageCache.set(s,y),y}preloadAdjacentPages(t,e,n,i,s=2,m={}){let y=[];for(let g=1;g<=s;g++){let h=e-g;h>=1&&y.push(h)}for(let g=1;g<=s;g++){let h=e+g;h<=n&&y.push(h)}y.forEach(g=>{let h=this.getCacheKey(t,g,i,m);this.pageCache.has(h)||(console.log(`Preloading ${h}...`),this.getPaginatedData(t,g,i,m).subscribe({error:He=>console.error(`Failed to preload ${h}:`,He)}))})}clearCache(){this.pageCache.clear(),console.log("Pagination cache cleared.")}getCacheKey(t,e,n,i){let m=Object.keys(i).sort().reduce((y,g)=>{let h=i[g];return h!=null&&h!==""&&(y[g]=h),y},{});return`${t}-${e}-${n}-${JSON.stringify(m)}`}static \u0275fac=function(e){return new(e||r)(D(J))};static \u0275prov=F({token:r,factory:r.\u0275fac,providedIn:"root"})};var at=r=>({"active-page":r});function st(r,t){r&1&&(o(0,"div",4),c(1,"Na\u010D\xEDt\xE1n\xED dat..."),a())}function lt(r,t){if(r&1&&(o(0,"div",5),c(1),a()),r&2){let e=d();l(),z(e.errorMessage)}}function ct(r,t){if(r&1&&(o(0,"option",43),c(1),a()),r&2){let e=t.$implicit;p("value",e),l(),z(e)}}function dt(r,t){if(r&1&&(o(0,"option",43),c(1),a()),r&2){let e=t.$implicit;p("value",e),l(),z(e)}}function pt(r,t){if(r&1){let e=ae();x(0),o(1,"button",44),P("click",function(){let i=_(e).$implicit,s=d(2);return C(s.goToPage(i))}),c(2),a(),v()}if(r&2){let e=t.$implicit,n=d(2);l(),p("ngClass",xe(2,at,e===n.currentPage)),l(),O(" ",e," ")}}function mt(r,t){if(r&1){let e=ae();o(0,"div")(1,"div",6)(2,"div",7)(3,"h3",8),c(4,"Filtrovat po\u017Eadavky"),a(),o(5,"div",9)(6,"div")(7,"label",10),c(8,"Obecn\xE9 hled\xE1n\xED"),a(),o(9,"input",11),H("ngModelChange",function(i){_(e);let s=d();return q(s.filterSearch,i)||(s.filterSearch=i),C(i)}),P("keyup.enter",function(){_(e);let i=d();return C(i.applyFilters())}),a()(),o(10,"div")(11,"label",12),c(12,"E-mail"),a(),o(13,"input",13),H("ngModelChange",function(i){_(e);let s=d();return q(s.filterEmail,i)||(s.filterEmail=i),C(i)}),P("keyup.enter",function(){_(e);let i=d();return C(i.applyFilters())}),a()(),o(14,"div")(15,"label",14),c(16,"Stav"),a(),o(17,"select",15),H("ngModelChange",function(i){_(e);let s=d();return q(s.filterStatus,i)||(s.filterStatus=i),C(i)}),o(18,"option",16),c(19,"-- Vybrat stav --"),a(),u(20,ct,2,2,"option",17),a()(),o(21,"div")(22,"label",18),c(23,"Priorita"),a(),o(24,"select",19),H("ngModelChange",function(i){_(e);let s=d();return q(s.filterPriority,i)||(s.filterPriority=i),C(i)}),o(25,"option",16),c(26,"-- Vybrat prioritu --"),a(),u(27,dt,2,2,"option",17),a()()(),o(28,"div",20)(29,"button",21),P("click",function(){_(e);let i=d();return C(i.clearFilters())}),c(30," Vy\u010Distit filtry "),a(),o(31,"button",22),P("click",function(){_(e);let i=d();return C(i.applyFilters())}),c(32," Pou\u017E\xEDt filtry "),a()()(),o(33,"div",23),w(34,"app-generic-table",24),o(35,"div",25)(36,"div",26),c(37),a(),o(38,"div",27)(39,"label",28),c(40,"Polo\u017Eek na str\xE1nku:"),a(),o(41,"select",29),P("change",function(i){_(e);let s=d();return C(s.onItemsPerPageChange(i))}),o(42,"option",30),c(43,"5"),a(),o(44,"option",31),c(45,"10"),a(),o(46,"option",32),c(47,"15"),a(),o(48,"option",33),c(49,"20"),a(),o(50,"option",34),c(51,"50"),a()()(),o(52,"nav",35)(53,"button",36),P("click",function(){_(e);let i=d();return C(i.goToPage(i.currentPage-1))}),o(54,"span",37),c(55,"P\u0159edchoz\xED"),a(),re(),o(56,"svg",38),w(57,"path",39),a()(),u(58,pt,3,4,"ng-container",40),ue(),o(59,"button",41),P("click",function(){_(e);let i=d();return C(i.goToPage(i.currentPage+1))}),o(60,"span",37),c(61,"Dal\u0161\xED"),a(),re(),o(62,"svg",38),w(63,"path",42),a()()()()()()()}if(r&2){let e=d();l(9),U("ngModel",e.filterSearch),l(4),U("ngModel",e.filterEmail),l(4),U("ngModel",e.filterStatus),l(3),p("ngForOf",e.statusOptions),l(4),U("ngModel",e.filterPriority),l(3),p("ngForOf",e.priorityOptions),l(7),p("data",e.data)("columns",e.userRequestColumns)("tableCaption","Seznam po\u017Eadavk\u016F na provize")("isLoading",e.isLoading)("uploadsBaseUrl","https://your-upload-domain.com/uploads/"),l(3),Ce(" Zobrazuji ",(e.currentPage-1)*e.itemsPerPage+1," - ",(e.currentPage-1)*e.itemsPerPage+e.data.length," z celkem ",e.totalItems," z\xE1znam\u016F. "),l(9),p("selected",e.itemsPerPage===15),l(7),p("disabled",e.currentPage===1),l(5),p("ngForOf",e.pagesArray),l(),p("disabled",e.currentPage===e.totalPages)}}var ne=class r extends N{constructor(e,n,i,s,m){super(e,n);this.dataHandler=e;this.cd=n;this.genericTableService=i;this.authService=s;this.router=m}apiEndpoint="raw_request_commissions";currentPage=1;itemsPerPage=15;totalItems=0;totalPages=0;filterSearch="";filterStatus="";filterPriority="";filterEmail="";statusOptions=["Nov\u011B zadan\xE9","Zpracov\xE1v\xE1 se","Dokon\u010Deno","Zru\u0161eno"];priorityOptions=["N\xEDzk\xE1","Neutr\xE1ln\xED","Vysok\xE1"];userRequestColumns=[{key:"id",header:"ID",type:"text"},{key:"thema",header:"T\xE9ma",type:"text"},{key:"contact_email",header:"Email",type:"text"},{key:"contact_phone",header:"Telefon",type:"text"},{key:"status",header:"Stav",type:"text"},{key:"priority",header:"Priorita",type:"text"},{key:"created_at",header:"Vytvo\u0159eno",type:"date",format:"short"},{key:"order_description",header:"Popis objedn\xE1vky",type:"text"},{key:"deleted_at",header:"Smaz\xE1no",type:"date",format:"short"},{key:"is_deleted",header:"Smazan\xE9?",type:"boolean"},{key:"last_changed_at",header:"Zm\u011Bn\u011Bno",type:"date",format:"short"}];ngOnInit(){super.ngOnInit(),console.log("UserRequestComponent inicializov\xE1na. Data se na\u010D\xEDtaj\xED..."),this.authService.isLoggedIn$.subscribe(e=>{e?this.loadUserRequests():this.router.navigate(["/auth/login"])})}loadUserRequests(){this.isLoading=!0,this.errorMessage=null;let e={search:this.filterSearch,status:this.filterStatus,priority:this.filterPriority,email:this.filterEmail};console.log(`Po\u017Eaduji data pro str\xE1nku: ${this.currentPage}, polo\u017Eek na str\xE1nku: ${this.itemsPerPage}, filtry:`,e),this.genericTableService.getPaginatedData(this.apiEndpoint,this.currentPage,this.itemsPerPage,e).subscribe({next:n=>{this.data=n.data,this.totalItems=n.total,this.totalPages=n.last_page,this.currentPage=n.current_page,this.isLoading=!1,this.cd.detectChanges(),console.log("Data na\u010Dtena. Aktu\xE1ln\xED str\xE1nka:",this.currentPage),console.log("Celkem z\xE1znam\u016F (total):",this.totalItems),console.log("Celkem str\xE1nek (last_page):",this.totalPages),console.log("Z\xE1znam\u016F na str\xE1nce (per_page):",this.itemsPerPage),console.log("Po\u010Det z\xE1znam\u016F v p\u0159ijat\xE9m poli data:",this.data.length),console.log("P\u0159ijat\xE1 data:",this.data),this.genericTableService.preloadAdjacentPages(this.apiEndpoint,this.currentPage,this.totalPages,this.itemsPerPage,2,e)},error:n=>{console.error("Chyba p\u0159i na\u010D\xEDt\xE1n\xED po\u017Eadavk\u016F u\u017Eivatel\u016F:",n),this.errorMessage="Nepoda\u0159ilo se na\u010D\xEDst data po\u017Eadavk\u016F.",this.isLoading=!1,this.cd.detectChanges()}})}goToPage(e){console.log(`Pokus o p\u0159echod na str\xE1nku: ${e}`),e>=1&&e<=this.totalPages&&e!==this.currentPage?(this.currentPage=e,this.loadUserRequests()):console.warn(`Neplatn\xFD po\u017Eadavek na str\xE1nku: ${e}. Aktu\xE1ln\xED str\xE1nka: ${this.currentPage}, Celkem str\xE1nek: ${this.totalPages}`)}onItemsPerPageChange(e){let n=e.target,i=Number(n.value);console.log(`Zm\u011Bna polo\u017Eek na str\xE1nku na: ${i}`),i!==this.itemsPerPage&&(this.itemsPerPage=i,this.currentPage=1,this.loadUserRequests())}applyFilters(){console.log("Aplikuji filtry:",{search:this.filterSearch,status:this.filterStatus,priority:this.filterPriority,email:this.filterEmail}),this.currentPage=1,this.loadUserRequests()}clearFilters(){console.log("\u010Cist\xEDm filtry."),this.filterSearch="",this.filterStatus="",this.filterPriority="",this.filterEmail="",this.currentPage=1,this.loadUserRequests()}get pagesArray(){let n=Math.max(1,this.currentPage-Math.floor(2.5)),i=Math.min(this.totalPages,n+5-1);i-n+1<5&&(n=Math.max(1,i-5+1));let s=[];for(let m=n;m<=i;m++)s.push(m);return s}static \u0275fac=function(n){return new(n||r)(f(T),f($),f(te),f(j),f(A))};static \u0275cmp=E({type:r,selectors:[["app-user-request"]],features:[W],decls:4,vars:3,consts:[[1,"user-request-container","container","mx-auto","p-4"],["class","text-center text-blue-500",4,"ngIf"],["class","text-center text-red-500",4,"ngIf"],[4,"ngIf"],[1,"text-center","text-blue-500"],[1,"text-center","text-red-500"],[1,"main-content-layout"],[1,"filter-form-container"],[1,"filter-form-title"],[1,"filter-grid"],["for","filterSearch",1,"filter-label"],["type","text","id","filterSearch","placeholder","Hledat t\xE9ma, popis, e-mail, telefon",1,"filter-input",3,"ngModelChange","keyup.enter","ngModel"],["for","filterEmail",1,"filter-label"],["type","email","id","filterEmail","placeholder","Hledat podle e-mailu",1,"filter-input",3,"ngModelChange","keyup.enter","ngModel"],["for","filterStatus",1,"filter-label"],["id","filterStatus",1,"filter-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","filterPriority",1,"filter-label"],["id","filterPriority",1,"filter-select",3,"ngModelChange","ngModel"],[1,"filter-buttons-container"],[1,"filter-button","clear",3,"click"],[1,"filter-button","apply",3,"click"],[1,"table-and-pagination-container"],[3,"data","columns","tableCaption","isLoading","uploadsBaseUrl"],[1,"pagination-controls-wrapper"],[1,"text-sm","text-gray-700","p-b-10"],[1,"flex","items-center","space-x-2","pg-m","p-b-10"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"items-per-page-select",3,"change"],["value","5"],["value","10"],["value","15",3,"selected"],["value","20"],["value","50"],["aria-label","Pagination",1,"pagination-nav"],[1,"pagination-button","first-page-btn",3,"click","disabled"],[1,"sr-only"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true"],["fill-rule","evenodd","d","M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule","evenodd"],[4,"ngFor","ngForOf"],[1,"pagination-button","last-page-btn",3,"click","disabled"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[3,"value"],[1,"pagination-button",3,"click","ngClass"]],template:function(n,i){n&1&&(o(0,"div",0),u(1,st,2,0,"div",1)(2,lt,2,1,"div",2)(3,mt,64,18,"div",3),a()),n&2&&(l(),p("ngIf",i.isLoading),l(),p("ngIf",i.errorMessage),l(),p("ngIf",!i.isLoading&&!i.errorMessage))},dependencies:[M,Se,Z,L,Q,Le,Ae,Re,$e,Fe,ze,ee],styles:[".p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.pagination-nav[_ngcontent-%COMP%]{display:inline-flex;border-radius:.375rem;box-shadow:0 1px 2px #0000000d}.pg-m[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.pagination-button[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:.5rem .75rem;border:1px solid #D1D5DB;background-color:#fff;font-size:.875rem;font-weight:500;color:#4b5563;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,color .15s ease-in-out,box-shadow .15s ease-in-out;cursor:pointer;box-shadow:0 1px 2px #0000000d}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f9fafb;border-color:#a0aec0;box-shadow:0 2px 4px #0000001a}.pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background-color:#f3f4f6}.pagination-button.active-page[_ngcontent-%COMP%]{z-index:10;background-color:#eef2ff;border-color:#6366f1;color:#4f46e5;font-weight:700;cursor:default;box-shadow:0 2px 4px #6366f133}.pagination-button.first-page-btn[_ngcontent-%COMP%]{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.pagination-button.last-page-btn[_ngcontent-%COMP%]{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.pagination-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1.25rem;width:1.25rem;vertical-align:middle;fill:currentColor}.items-per-page-select[_ngcontent-%COMP%]{display:block;width:5rem;border-radius:.375rem;border:1px solid #D1D5DB;box-shadow:0 1px 2px #0000000d;padding:.375rem .75rem;font-size:.875rem;color:#4b5563;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.items-per-page-select[_ngcontent-%COMP%]:focus{border-color:#6366f1;box-shadow:0 0 0 3px #6366f133}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.filter-form-container[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 1px 2px #0000000d;border-radius:6px;border:1px solid #dee2e6;padding:.75rem;margin-bottom:1rem}.filter-form-title[_ngcontent-%COMP%]{margin-top:0;font-size:1rem;font-weight:700;color:#333;margin-bottom:.5rem;font-family:Arial,sans-serif}.filter-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}.filter-label[_ngcontent-%COMP%]{display:block;font-size:.8rem;font-weight:500;color:#444;margin-bottom:.15rem;font-family:Arial,sans-serif}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{margin-top:.15rem;display:block;width:100%;border-radius:6px;border:1px solid #dee2e6;box-shadow:0 1px 2px #0000000d;padding:.3rem .5rem;font-size:.8rem;color:#444;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;font-family:Arial,sans-serif}.filter-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.filter-input[_ngcontent-%COMP%]:focus, .filter-select[_ngcontent-%COMP%]:focus{border-color:#6366f1;box-shadow:0 0 0 1px #6366f1,0 0 0 3px #6366f133}.filter-buttons-container[_ngcontent-%COMP%]{margin-top:.75rem;display:flex;justify-content:flex-end;gap:.5rem}.filter-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.4rem .8rem;border-radius:6px;box-shadow:0 1px 2px #0000000d;font-size:.8rem;font-weight:500;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,color .15s ease-in-out,box-shadow .15s ease-in-out;cursor:pointer;outline:none;font-family:Arial,sans-serif}.filter-button[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 2px #6366f133}.filter-button.clear[_ngcontent-%COMP%]{border:1px solid #dee2e6;background-color:#fff;color:#444}.filter-button.clear[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.filter-button.apply[_ngcontent-%COMP%]{border:1px solid transparent;background-color:#4f46e5;color:#fff}.filter-button.apply[_ngcontent-%COMP%]:hover{background-color:#4338ca}.main-content-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}@media (min-width: 1024px){.main-content-layout[_ngcontent-%COMP%]{flex-direction:row;gap:10px}.filter-form-container[_ngcontent-%COMP%]{width:25%;margin-bottom:0}.table-and-pagination-container[_ngcontent-%COMP%]{flex-grow:1}}"],changeDetection:0})};var ie=class r{constructor(t,e){this.authService=t;this.router=e}canActivate(t,e){return this.authService.isLoggedIn$.pipe(G(n=>{n||(console.warn("AuthGuard: U\u017Eivatel nen\xED p\u0159ihl\xE1\u0161en, p\u0159esm\u011Brov\xE1n\xED na login."),this.router.navigate(["/auth/login"]))}))}static \u0275fac=function(e){return new(e||r)(D(j),D(A))};static \u0275prov=F({token:r,factory:r.\u0275fac,providedIn:"root"})};var gt=[{path:"",component:X,canActivate:[ie],children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:Y},{path:"user-request",component:ne}]}],qe=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=fe({type:r});static \u0275inj=ge({imports:[V.forChild(gt),V]})};export{qe as AdminRoutingModule};
