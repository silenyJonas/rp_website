import{a as j,b as Qt}from"./chunk-KSDGTPNP.js";import{d as Rt,e as X,f as Vt,g as At,i as ze}from"./chunk-KCTVJKTI.js";import{a as ke,b as Ie,c as Ne,d as U,e as Ke,f as Lt,g as G,h as Ye,i as zt,j as Nt,k as Ut,l as jt,m as qt,n as oe,o as re,p as ae,q as Bt,r as Gt,s as Xe,t as $t,w as Ht,x as Wt,y as $,z as Zt}from"./chunk-4F7SMVZK.js";import{A as ct,B as dt,C as Ft,j as ne,k as N,l as F,m as Me,n as Oe,o as Je,r as ie,s as fe,t as M,y as It}from"./chunk-AYEDX2M7.js";import{A as I,Aa as Ee,Bb as Y,Cb as Et,D as vt,Da as c,Db as We,E as q,Eb as Mt,F as Le,Gb as Ot,Hb as Ze,I as Te,Ia as v,Jb as kt,K as xt,Lb as z,N as Q,Na as E,O as pe,Oa as wt,Pa as Pt,R as J,Ra as K,S as yt,Sa as b,Sb as Qe,W as B,Ya as Be,Za as Ge,_ as qe,_a as d,a as W,aa as me,ab as ge,b as ft,ba as u,bb as $e,c as ht,ca as g,cb as a,da as Z,db as s,ea as ue,eb as O,fb as y,gb as w,hb as C,i as bt,ka as R,lb as h,m as De,mb as l,n as A,ob as St,pb as Dt,q as Ct,qb as Tt,r as de,rb as we,sb as p,tb as k,ub as x,vb as _e,wb as P,x as je,xb as S,yb as D,zb as He}from"./chunk-ZGXC4ISU.js";var Fe=class i{rolePermissions=new Map([["sysadmin",["manage-administrators","view-business-logs","view-personal-info","view-user-requests","view-dashboard"]],["primeadmin",["manage-administrators","view-dashboard","view-business-logs"]],["admin",["view-user-requests","view-dashboard","view-personal-info"]]]);constructor(){}hasPermission(o,e){let n=this.rolePermissions.get(o);return n?n.includes(e):!1}static \u0275fac=function(e){return new(e||i)};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};function xn(i,o){if(i&1&&(y(0),p(1),w()),i&2){let e=l();c(),x(" ",e.userEmail," | ")}}function yn(i,o){i&1&&(y(0),p(1," Nep\u0159ihl\xE1\u0161en\xFD u\u017Eivatel | "),w())}function wn(i,o){if(i&1&&(y(0),p(1),w()),i&2){let e=l();c(),x(" ",e.userRole," | ")}}function Pn(i,o){i&1&&(a(0,"li")(1,"a",8),p(2,"Dashboard"),s()())}function Sn(i,o){i&1&&(a(0,"li")(1,"a",9),p(2,"User Requests"),s()())}function Dn(i,o){i&1&&(a(0,"li")(1,"a",10),p(2,"Administr\xE1to\u0159i"),s()())}function Tn(i,o){i&1&&(a(0,"li")(1,"a",11),p(2,"Business Logs"),s()())}function En(i,o){i&1&&(a(0,"li")(1,"a",12),p(2,"Osobn\xED Informace"),s()())}It(Qt);var et=class i{constructor(o,e,n){this.router=o;this.authService=e;this.permissionService=n}userEmail=null;userRole=null;isLoggedIn=!1;currentDate=new Date;authSubscription;userEmailSubscription;intervalId;ngOnInit(){this.authSubscription=this.authService.isLoggedIn$.subscribe(o=>{this.isLoggedIn=o,o?this.userRole=this.authService.getUserRole():(this.userEmail=null,this.userRole=null)}),this.userEmailSubscription=this.authService.userEmail$.subscribe(o=>{this.userEmail=o}),this.authService.checkAuth().subscribe(o=>{this.isLoggedIn=o,o&&(this.userRole=this.authService.getUserRole())}),this.intervalId=setInterval(()=>{this.currentDate=new Date},1e3)}logout(){this.authService.logout().subscribe({next:()=>{console.log("Odhl\xE1\u0161en\xED \xFAsp\u011B\u0161n\xE9."),this.router.navigate(["/auth/login"])},error:o=>{console.error("Chyba p\u0159i odhl\xE1\u0161en\xED:",o),this.router.navigate(["/auth/login"])}})}hasPermission(o){return this.permissionService.hasPermission(this.userRole,o)}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe(),this.intervalId&&clearInterval(this.intervalId),this.userEmailSubscription&&this.userEmailSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||i)(v(X),v(j),v(Fe))};static \u0275cmp=E({type:i,selectors:[["app-admin-layout"]],features:[He([{provide:kt,useValue:"cs"}])],decls:23,vars:12,consts:[[1,"header-item"],[4,"ngIf"],[1,"admin-dashboard-wrapper"],[1,"admin-sidebar"],[1,"admin-nav"],[1,"sidebar-footer"],[1,"delete_button",3,"click"],[1,"admin-content"],["routerLink","/admin/dashboard","routerLinkActive","active"],["routerLink","/admin/user-request","routerLinkActive","active"],["routerLink","/admin/administrators","routerLinkActive","active"],["routerLink","/admin/business-logs","routerLinkActive","active"],["routerLink","/admin/personal-info","routerLinkActive","active"]],template:function(e,n){e&1&&(a(0,"header")(1,"div",0),b(2,xn,2,1,"ng-container",1)(3,yn,2,0,"ng-container",1),s(),a(4,"div",0),b(5,wn,2,1,"ng-container",1),s(),a(6,"div",0),p(7),Mt(8,"date"),s()(),a(9,"div",2)(10,"aside",3)(11,"nav",4)(12,"ul"),b(13,Pn,3,0,"li",1)(14,Sn,3,0,"li",1)(15,Dn,3,0,"li",1)(16,Tn,3,0,"li",1)(17,En,3,0,"li",1),s()(),a(18,"div",5)(19,"button",6),h("click",function(){return n.logout()}),p(20,"Logout"),s()()(),a(21,"main",7),O(22,"router-outlet"),s()()),e&2&&(c(2),d("ngIf",n.isLoggedIn&&n.userEmail),c(),d("ngIf",!n.isLoggedIn&&!n.userEmail),c(2),d("ngIf",n.isLoggedIn&&n.userRole),c(2),x(" ",Ot(8,9,n.currentDate,"HH:mm:ss d. MMMM yyyy"),`
`),c(6),d("ngIf",n.hasPermission("view-dashboard")),c(),d("ngIf",n.hasPermission("view-user-requests")),c(),d("ngIf",n.hasPermission("manage-administrators")),c(),d("ngIf",n.hasPermission("view-business-logs")),c(),d("ngIf",n.hasPermission("view-personal-info")))},dependencies:[M,F,ie,ze,Rt,Vt,At],styles:[".admin-dashboard-wrapper[_ngcontent-%COMP%]{display:flex;min-height:calc(100vh - 25px);background-color:#f0f2f5;font-family:Segoe UI,Roboto,sans-serif;font-size:.95rem}.admin-sidebar[_ngcontent-%COMP%]{width:160px;background-color:#fff;color:#546e7a;display:flex;flex-direction:column;border-right:none;border-right:1px solid rgb(121,121,121)}.sidebar-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;padding:0 10px}.sidebar-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem;margin:0;color:#64b5f6;font-weight:600}.admin-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:6px 25px;color:#000;text-decoration:none;font-size:.9rem;border-left:3px solid transparent}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#e3f2fd;color:#000;border-left-color:#42a5f5}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#bbdefb;color:#1e88e5;font-weight:600;border-left-color:#1e88e5}.sidebar-footer[_ngcontent-%COMP%]{margin-top:auto;padding:15px;text-align:center;border-top:1px solid #eceff1}.admin-content[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;background-color:#fff;color:#424242;padding:10px}header[_ngcontent-%COMP%]{width:100vw;border-bottom:1px solid rgb(121,121,121);display:flex;align-items:center;background-color:#fff;flex-wrap:wrap;margin-top:-18px}.header-item[_ngcontent-%COMP%]{height:auto;width:auto;padding:3px;text-align:center}@media (max-width: 480px){.admin-dashboard-wrapper[_ngcontent-%COMP%]{flex-direction:column}.admin-sidebar[_ngcontent-%COMP%]{width:100%;min-height:auto;border-right:none;border-bottom:1px solid rgb(121,121,121)}.admin-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-wrap:wrap;padding:10px 0}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:6px 10px;font-size:.8rem;border-left:none;border-bottom:3px solid transparent}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%], .admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{border-left:none;border-bottom:3px solid #1e88e5}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:5px}.sidebar-footer[_ngcontent-%COMP%]{display:none}}@media (min-width: 481px) and (max-width: 1024px){.admin-sidebar[_ngcontent-%COMP%]{width:120px}.admin-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:6px 15px}}"]})};var tt=class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=E({type:i,selectors:[["app-dashboard"]],decls:7,vars:0,consts:[[1,"dashboard-container"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"h1"),p(2,"Admin Dashboard"),s(),a(3,"p"),p(4,"Welcome to the administration panel!"),s(),a(5,"p"),p(6,"Here you can manage your website's content."),s()())},dependencies:[M],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:40px;text-align:center;max-width:900px;margin:50px auto;background-color:#e8f5e9;border-radius:8px;box-shadow:0 4px 12px #0000001a;border:1px solid #c8e6c9}h1[_ngcontent-%COMP%]{color:#2e7d32;margin-bottom:20px}p[_ngcontent-%COMP%]{color:#43a047;line-height:1.6}"]})};function Mn(i,o){if(i&1){let e=C();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),p(4),s()(),a(5,"div",5)(6,"p",6),p(7),s()(),a(8,"div",7)(9,"button",8),h("click",function(){u(e);let t=l();return g(t.ok())}),p(10,"OK"),s()()()()}if(i&2){let e=l();c(),d("ngClass",e.getDialogClass()),c(3),k(e.title),c(3),k(e.message)}}var nt=class i{title="";message="";type="info";onOk=new R;isVisible=!1;show(){this.isVisible=!0,this.blockBackgroundScroll()}hide(){this.isVisible=!1,this.unblockBackgroundScroll()}ok(){this.onOk.emit()}getDialogClass(){switch(this.type){case"warning":return"warning-dialog";case"danger":return"danger-dialog";case"success":case"info":default:return"info-dialog"}}blockBackgroundScroll(){document.body.classList.add("no-scroll")}unblockBackgroundScroll(){document.body.classList.remove("no-scroll")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=E({type:i,selectors:[["app-alert-dialog"]],inputs:{title:"title",message:"message",type:"type"},outputs:{onOk:"onOk"},decls:1,vars:1,consts:[["class","dialog-overlay",4,"ngIf"],[1,"dialog-overlay"],[1,"dialog-container",3,"ngClass"],[1,"dialog-header"],[1,"dialog-title"],[1,"dialog-body"],[1,"dialog-message"],[1,"dialog-footer"],[1,"confirm_button",3,"click"]],template:function(e,n){e&1&&b(0,Mn,11,3,"div",0),e&2&&d("ngIf",n.isVisible)},dependencies:[M,ne,F],styles:[".dialog-overlay[_ngcontent-%COMP%]{cursor:default;position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.dialog-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 4px 6px #0000001a;width:400px;max-width:90%;overflow:hidden;display:flex;flex-direction:column}.dialog-header[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #e0e0e0}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700}.dialog-body[_ngcontent-%COMP%]{padding:16px;flex-grow:1}.dialog-message[_ngcontent-%COMP%]{margin:0}.dialog-footer[_ngcontent-%COMP%]{padding:16px;border-top:1px solid #e0e0e0;display:flex;justify-content:flex-end}.dialog-button[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-weight:700}.info-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{background-color:#f0f8ff}.warning-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{background-color:#fff8f0}.warning-dialog[_ngcontent-%COMP%]   .ok-button[_ngcontent-%COMP%]{background-color:#ffc107;color:#333}.danger-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{background-color:#fff0f0}.danger-dialog[_ngcontent-%COMP%]   .ok-button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.success-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{background-color:#f0fff0}.success-dialog[_ngcontent-%COMP%]   .ok-button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.no-scroll[_ngcontent-%COMP%]{overflow:hidden}"]})};var le=class i{constructor(o,e){this.environmentInjector=o;this.appRef=e}componentRef;open(o,e,n="info"){this.closeDialog(),this.componentRef=Qe(nt,{environmentInjector:this.environmentInjector});let t=this.componentRef.hostView.rootNodes[0];return this.appRef.attachView(this.componentRef.hostView),document.body.appendChild(t),this.componentRef.instance.title=o,this.componentRef.instance.message=e,this.componentRef.instance.type=n,this.componentRef.instance.show(),new Promise(r=>{this.componentRef?.instance.onOk.pipe(Le()).subscribe(()=>{this.closeDialog(),r()})})}closeDialog(){this.componentRef&&(this.componentRef.instance.hide(),this.appRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.componentRef=void 0)}static \u0275fac=function(e){return new(e||i)(B(qe),B(Be))};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{constructor(o,e){this.http=o;this.alertDialogService=e}baseUrl="api/";getHeaders(o="application/json"){return o==="application/json"?new ct({"Content-Type":"application/json",Accept:"application/json"}):new ct({Accept:"application/json"})}handleError=o=>{let e="Nastala nezn\xE1m\xE1 chyba!";if(o.error instanceof ErrorEvent)e=`Chyba na stran\u011B klienta: ${o.error.message}`;else if(console.error(`Backend vr\xE1til k\xF3d ${o.status}, t\u011Blo odpov\u011Bdi: ${JSON.stringify(o.error)}`),o.status===0)e="Nelze se p\u0159ipojit k serveru. Zkontrolujte s\xED\u0165ov\xE9 p\u0159ipojen\xED nebo zda API b\u011B\u017E\xED.";else if(o.status===403)o.error&&o.error.error_code==="CANNOT_DELETE_OWN_ACCOUNT"?e="Nelze smazat u\u017Eivatele, za kter\xE9ho jste pr\xE1v\u011B p\u0159ihl\xE1\u0161en\xFD/\xE1.":o.error&&o.error.message?e=o.error.message:e="P\u0159i maz\xE1n\xED polo\u017Eky nastala chyba.";else if(o.status===422&&o.error&&o.error.errors){let n=Object.values(o.error.errors).flat().join("; ");e=`Chyba validace (${o.status}): ${n}`}else if(o.status>=400&&o.status<500)if(o.error&&o.error.message)e=`Chyba klienta (${o.status}): ${o.error.message}`;else if(o.error&&o.error.errors){let n=Object.values(o.error.errors).flat().join("; ");e=`Chyba validace (${o.status}): ${n}`}else e=`Chyba klienta: ${o.status} ${o.statusText||""}`;else o.status>=500&&(e=`Chyba serveru (${o.status}): ${o.statusText||"Intern\xED chyba serveru"}`);return console.error(`Chyba API: ${e}`),this.alertDialogService.open("Chyba API",e,"danger"),A(()=>new Error(e))};getCollection(o){return this.http.get(`${this.baseUrl}/${o}`,{headers:this.getHeaders()}).pipe(de(e=>e&&typeof e=="object"&&"data"in e?e.data:e),I(this.handleError))}getPaginatedCollection(o){return console.log("dotaz na:",this.baseUrl+o),this.http.get(`${this.baseUrl}${o}`,{headers:this.getHeaders()}).pipe(I(this.handleError))}get(o){return console.log("DataHandler: GET request na:",`${this.baseUrl}${o}`),this.http.get(`${this.baseUrl}${o}`,{headers:this.getHeaders()}).pipe(I(this.handleError))}getOne(o){return console.log("--------",o),this.http.get(`${this.baseUrl}${o}`,{headers:this.getHeaders()}).pipe(de(e=>e.data),I(this.handleError))}post(o,e){return this.http.post(`${this.baseUrl}${o}`,e,{headers:this.getHeaders()}).pipe(de(n=>n.data),I(this.handleError))}put(o,e){return this.http.put(`${this.baseUrl}${o}`,e,{headers:this.getHeaders()}).pipe(de(n=>n.data),I(this.handleError))}patch(o,e){return this.http.patch(`${this.baseUrl}${o}`,e,{headers:this.getHeaders()}).pipe(de(n=>n.data),I(this.handleError))}delete(o){return console.log(`DataService: Ma\u017Eu data z ${this.baseUrl}${o}`),this.http.delete(`${this.baseUrl}${o}`,{headers:this.getHeaders()}).pipe(I(this.handleError))}upload(o,e){console.log("DataService: Odes\xEDl\xE1m FormData na",`${this.baseUrl}${o}`);let n={};return e.forEach((t,r)=>{try{n[r]=JSON.parse(t)}catch{n[r]=t}}),console.log("Data formul\xE1\u0159e k odesl\xE1n\xED (bez soubor\u016F):",JSON.stringify(n,null,2)),this.http.post(`${this.baseUrl}${o}`,e,{headers:this.getHeaders("multipart/form-data")}).pipe(I(this.handleError))}static \u0275fac=function(e){return new(e||i)(B(Ft),B(le))};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};var H=class i{constructor(o,e){this.dataHandler=o;this.cd=e}data=[];trashData=[];isLoading=!1;errorMessage=null;destroy$=new bt;showLoaderTimeout;ngOnInit(){}ngOnChanges(o){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.showLoaderTimeout&&clearTimeout(this.showLoaderTimeout)}loadData(){if(!this.apiEndpoint){let e="Chyba: API endpoint nen\xED definov\xE1n v d\u011Bd\xEDc\xED komponent\u011B. Nelze na\u010D\xEDst data.";this.errorMessage=e,console.error(e);return}console.log("base-data: Spou\u0161t\xEDm na\u010D\xEDt\xE1n\xED dat. isLoading je true."),this.isLoading=!0,this.errorMessage=null;let o=this.apiEndpoint;this.dataHandler.getCollection(o).pipe(Q(this.destroy$),I(e=>(console.error(`base-data: Chyba p\u0159i na\u010D\xEDt\xE1n\xED z ${o}:`,e),this.isLoading=!1,this.errorMessage=e.message||"Nezn\xE1m\xE1 chyba p\u0159i na\u010D\xEDt\xE1n\xED dat.",this.cd.markForCheck(),A(()=>e)))).subscribe({next:e=>{console.log("base-data: Na\u010D\xEDt\xE1n\xED dat prob\u011Bhlo \xFAsp\u011B\u0161n\u011B. isLoading je false."),this.data=e,this.isLoading=!1,this.cd.markForCheck()},error:()=>{},complete:()=>{this.isLoading=!1,this.cd.markForCheck()}})}loadAllData(o){if(!this.apiEndpoint)return A(()=>new Error("Chyba: API endpoint nen\xED definov\xE1n pro na\u010Dten\xED v\u0161ech dat."));let e=new URLSearchParams;e.set("no_pagination","true"),o&&Object.keys(o).forEach(t=>{let r=o[t];r!==""&&r!==null&&r!==void 0&&e.set(t,r.toString())});let n=`${this.apiEndpoint}?${e.toString()}`;return console.log("base-data: Spou\u0161t\xEDm na\u010D\xEDt\xE1n\xED v\u0161ech dat s filtry:",o),this.dataHandler.getCollection(n).pipe(Q(this.destroy$),I(t=>(console.error(`base-data: Chyba p\u0159i na\u010D\xEDt\xE1n\xED v\u0161ech dat z ${this.apiEndpoint}:`,t),A(()=>t))))}getItemDetails(o){if(o==null){let n="Chyba: ID z\xE1znamu pro na\u010Dten\xED detail\u016F nen\xED definov\xE1no.";return this.errorMessage=n,console.error(n),A(()=>new Error(n))}let e=`${this.apiEndpoint}/${o}/details`;return console.log(`base-data: Spou\u0161t\xEDm na\u010D\xEDt\xE1n\xED detail\u016F pro ID ${o}.`),this.showLoaderTimeout=setTimeout(()=>{this.isLoading=!0,this.cd.markForCheck(),console.log("base-data: Na\u010D\xEDt\xE1n\xED trv\xE1 d\xE9le, zobrazuji loader.")},3e3),this.errorMessage=null,this.dataHandler.get(e).pipe(Q(this.destroy$),I(n=>(this.showLoaderTimeout&&clearTimeout(this.showLoaderTimeout),console.error(`base-data: Chyba p\u0159i na\u010D\xEDt\xE1n\xED detail\u016F z ${e}:`,n),this.isLoading=!1,this.errorMessage=n.message||"Nezn\xE1m\xE1 chyba p\u0159i na\u010D\xEDt\xE1n\xED detail\u016F.",this.cd.markForCheck(),A(()=>n))),q(()=>{this.showLoaderTimeout&&clearTimeout(this.showLoaderTimeout),this.isLoading=!1,this.cd.markForCheck()}))}getOnlySoftDeleted(o,e){let n=new URLSearchParams;n.set("only_trashed","true"),n.set("no_pagination","true"),e&&Object.keys(e).forEach(r=>{let m=e[r];m!==""&&m!==null&&m!==void 0&&n.set(r,m.toString())});let t=`${o}?${n.toString()}`;return console.log("base-data: Spou\u0161t\xEDm na\u010D\xEDt\xE1n\xED soft-deleted dat s filtry:",e),this.dataHandler.getCollection(t).pipe(Q(this.destroy$),I(r=>(console.error(`base-data: Chyba p\u0159i na\u010D\xEDt\xE1n\xED soft-deleted dat z ${o}:`,r),A(()=>r))))}postData(o){return console.log("base-data: Spou\u0161t\xEDm POST request."),console.log("base-data: Odes\xEDl\xE1m data:",o),this.isLoading=!0,this.errorMessage=null,this.dataHandler.post(this.apiEndpoint,o).pipe(Q(this.destroy$),I(e=>(console.error(`base-data: Chyba p\u0159i POST na ${this.apiEndpoint}:`,e),console.log("base-data: POST request selhal. isLoading je false."),this.isLoading=!1,this.errorMessage=e.message||"Nezn\xE1m\xE1 chyba p\u0159i vytv\xE1\u0159en\xED dat.",this.cd.markForCheck(),A(()=>e))))}updateData(o,e){if(o==null){let t="Chyba: ID z\xE1znamu pro aktualizaci nen\xED definov\xE1no.";return this.errorMessage=t,console.error(t),A(()=>new Error(t))}console.log("base-data: Spou\u0161t\xEDm PUT request."),console.log("base-data: Odes\xEDl\xE1m data k aktualizaci:",e),this.isLoading=!0,this.errorMessage=null;let n=`${this.apiEndpoint}/${o}`;return this.dataHandler.put(n,e).pipe(Q(this.destroy$),I(t=>(console.error(`base-data: Chyba p\u0159i PUT na ${n}:`,t),console.log("base-data: PUT request selhal. isLoading je false."),this.isLoading=!1,this.errorMessage=t.message||"Nezn\xE1m\xE1 chyba p\u0159i aktualizaci dat.",this.cd.markForCheck(),A(()=>t))))}updatePassword(o,e){console.log("base-data: Spou\u0161t\xEDm POST request pro zm\u011Bnu hesla."),this.isLoading=!0,this.errorMessage=null;let n=`${this.apiEndpoint}/${o}/change-password`;return this.dataHandler.post(n,e).pipe(Q(this.destroy$),q(()=>{this.isLoading=!1,this.cd.markForCheck()}),I(t=>(console.error(`base-data: Chyba p\u0159i zm\u011Bn\u011B hesla na ${n}:`,t),this.errorMessage=t.message||"Nezn\xE1m\xE1 chyba p\u0159i zm\u011Bn\u011B hesla.",this.cd.markForCheck(),A(()=>t))))}deleteData(o,e=!1){if(o==null){let t="Chyba: ID z\xE1znamu pro smaz\xE1n\xED nen\xED definov\xE1no.";return this.errorMessage=t,console.error(t),A(()=>new Error(t))}console.log("base-data: Spou\u0161t\xEDm DELETE request. isLoading je true."),this.isLoading=!0,this.errorMessage=null;let n=`${this.apiEndpoint}/${o}`;return e&&(n+="?force_delete=true"),this.dataHandler.delete(n).pipe(Q(this.destroy$),I(t=>(console.error(`base-data: Chyba p\u0159i DELETE na ${n}:`,t),console.log("base-data: DELETE request selhal. isLoading je false."),this.isLoading=!1,this.errorMessage=t.message||"Nezn\xE1m\xE1 chyba p\u0159i maz\xE1n\xED dat.",this.cd.markForCheck(),A(()=>t))))}hardDeleteDataFromApi(o){return console.log("base-data: Spou\u0161t\xEDm trval\xE9 smaz\xE1n\xED dat."),this.deleteData(o,!0)}hardDeleteAllTrashedDataFromApi(){if(!this.apiEndpoint)return A(()=>new Error("Chyba: API endpoint nen\xED definov\xE1n pro hromadn\xE9 smaz\xE1n\xED."));let o=`${this.apiEndpoint}/force-delete-all`;return console.log("base-data: Spou\u0161t\xEDm hromadn\xFD DELETE request."),this.isLoading=!0,this.errorMessage=null,this.dataHandler.delete(o).pipe(Q(this.destroy$),I(e=>(console.error(`base-data: Chyba p\u0159i hromadn\xE9m DELETE na ${o}:`,e),this.isLoading=!1,this.errorMessage=e.message||"Nezn\xE1m\xE1 chyba p\u0159i hromadn\xE9m maz\xE1n\xED.",this.cd.markForCheck(),A(()=>e))),q(()=>{this.isLoading=!1,this.cd.markForCheck()}))}restoreDataFromApi(o){console.log("base-data: Spou\u0161t\xEDm obnoven\xED dat. isLoading je true."),this.isLoading=!0,this.errorMessage=null;let e=`${this.apiEndpoint}/${o}/restore`;return this.dataHandler.post(e,{}).pipe(Q(this.destroy$),I(n=>(console.error(`base-data: Chyba p\u0159i obnovov\xE1n\xED na ${e}:`,n),console.log("base-data: Obnoven\xED dat selhalo. isLoading je false."),this.isLoading=!1,this.errorMessage=n.message||"Nezn\xE1m\xE1 chyba p\u0159i obnovov\xE1n\xED dat.",this.cd.markForCheck(),A(()=>n))),q(()=>{this.isLoading=!1,this.cd.markForCheck()}))}uploadData(o,e){let n=e||this.apiEndpoint;return console.log("base-data: Spou\u0161t\xEDm nahr\xE1v\xE1n\xED dat. isLoading je true."),this.isLoading=!0,this.errorMessage=null,this.dataHandler.upload(n,o).pipe(Q(this.destroy$),I(t=>(console.error(`base-data: Chyba p\u0159i nahr\xE1v\xE1n\xED na ${n}:`,t),console.log("base-data: Nahr\xE1v\xE1n\xED dat selhalo. isLoading je false."),this.isLoading=!1,this.errorMessage=t.message||"Nezn\xE1m\xE1 chyba p\u0159i nahr\xE1v\xE1n\xED dat.",this.cd.markForCheck(),A(()=>t))))}static \u0275fac=function(e){return new(e||i)(v(L),v(z))};static \u0275dir=Pt({type:i,features:[me]})};var ot=class i{title="";message="";onConfirm=new R;onCancel=new R;isVisible=!1;show(){this.isVisible=!0,this.blockBackgroundScroll()}hide(){this.isVisible=!1,this.unblockBackgroundScroll()}confirm(){this.onConfirm.emit()}cancel(){this.onCancel.emit()}blockBackgroundScroll(){document.body.classList.add("no-scroll")}unblockBackgroundScroll(){document.body.classList.remove("no-scroll")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=E({type:i,selectors:[["app-confirm-dialog"]],inputs:{title:"title",message:"message"},outputs:{onConfirm:"onConfirm",onCancel:"onCancel"},decls:13,vars:4,consts:[[1,"dialog-overlay"],[1,"dialog-container"],[1,"dialog-header"],[1,"dialog-content"],[1,"dialog-actions"],[1,"neutral_button",3,"click"],[1,"confirm_button",3,"click"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),p(4),s()(),a(5,"div",3)(6,"p"),p(7),s()(),a(8,"div",4)(9,"button",5),h("click",function(){return n.cancel()}),p(10,"Zru\u0161it"),s(),a(11,"button",6),h("click",function(){return n.confirm()}),p(12,"Potvrdit"),s()()()()),e&2&&(ge("visible",n.isVisible),c(4),k(n.title),c(3),k(n.message))},dependencies:[M],styles:[".dialog-overlay[_ngcontent-%COMP%]{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;justify-content:center;align-items:center;z-index:1000;cursor:default}.dialog-overlay.visible[_ngcontent-%COMP%]{display:flex}.dialog-container[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 6px #0000001a;max-width:400px;width:90%;font-family:Arial,sans-serif}.dialog-header[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;padding-bottom:10px;margin-bottom:10px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5em;color:#333}.dialog-content[_ngcontent-%COMP%]{margin-bottom:20px}.dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#555;line-height:1.5}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px}.no-scroll[_ngcontent-%COMP%]{overflow:hidden}"]})};var Re=class i{constructor(o,e){this.environmentInjector=o;this.appRef=e}componentRef;open(o,e){this.closeDialog(),this.componentRef=Qe(ot,{environmentInjector:this.environmentInjector});let n=this.componentRef.hostView.rootNodes[0];return this.appRef.attachView(this.componentRef.hostView),document.body.appendChild(n),this.componentRef.instance.title=o,this.componentRef.instance.message=e,this.componentRef.instance.show(),new Promise(t=>{this.componentRef?.instance.onConfirm.pipe(Le()).subscribe(()=>{this.closeDialog(),t(!0)}),this.componentRef?.instance.onCancel.pipe(Le()).subscribe(()=>{this.closeDialog(),t(!1)})})}closeDialog(){this.componentRef&&(this.componentRef.instance.hide(),this.appRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.componentRef=void 0)}static \u0275fac=function(e){return new(e||i)(B(qe),B(Be))};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};function On(i,o){if(i&1&&(a(0,"caption")(1,"div",10)(2,"div",11),p(3),s()()()),i&2){let e=l();c(3),x(" ",e.tableCaption," ")}}function kn(i,o){if(i&1&&(a(0,"th"),y(1),a(2,"span",12),p(3),s(),w(),s()),i&2){let e=o.$implicit;c(3),x(" ",e.header," ")}}function In(i,o){if(i&1&&(a(0,"th",14),p(1),s()),i&2){let e=l().$implicit;c(),x(" ",e.display_name," ")}}function Fn(i,o){if(i&1&&(y(0),b(1,In,2,1,"th",13),w()),i&2){let e=o.$implicit;c(),d("ngIf",e.isActive)}}function Rn(i,o){if(i&1&&O(0,"img",19),i&2){let e=l(3).$implicit,n=l().$implicit,t=l(2);d("src",t.getCellValue(n,e),Ee)}}function Vn(i,o){i&1&&(a(0,"span"),p(1,"Nen\xED obr\xE1zek"),s())}function An(i,o){if(i&1&&(y(0),b(1,Rn,1,1,"img",18)(2,Vn,2,0,"span",2),w()),i&2){let e=l(2).$implicit,n=l().$implicit,t=l(2);c(),d("ngIf",t.getCellValue(n,e)),c(),d("ngIf",!t.getCellValue(n,e))}}function Ln(i,o){if(i&1&&(y(0),a(1,"a",20),p(2),s(),w()),i&2){let e=l(2).$implicit,n=l().$implicit,t=l(2);c(),d("href",t.getCellValue(n,e),Ee),c(),k(t.getCellValue(n,e))}}function zn(i,o){if(i&1&&(y(0),p(1),w()),i&2){let e=l(2).$implicit,n=l().$implicit,t=l(2);c(),x(" ",t.getCellValue(n,e)," ")}}function Nn(i,o){if(i&1&&(a(0,"td"),y(1,15),b(2,An,3,2,"ng-container",16)(3,Ln,3,2,"ng-container",16)(4,zn,2,1,"ng-container",17),w(),s()),i&2){let e=l().$implicit;c(),d("ngSwitch",e.type),c(),d("ngSwitchCase","image"),c(),d("ngSwitchCase","link")}}function Un(i,o){if(i&1&&(y(0),b(1,Nn,5,3,"td",2),w()),i&2){let e=o.$implicit;c(),d("ngIf",!e.hidden)}}function jn(i,o){if(i&1){let e=C();a(0,"td",22)(1,"button",23),h("click",function(){u(e);let t=l().$implicit,r=l().$implicit,m=l(2);return g(m.handleAction(r,t.action))}),p(2),s()()}if(i&2){let e=l().$implicit,n=l().$implicit,t=l(2);c(),$e(e.type),d("disabled",e.type==="delete_button"&&n.id==t.authService.getUserId()),c(),x(" ",e.display_name," ")}}function qn(i,o){if(i&1&&(y(0),b(1,jn,3,4,"td",21),w()),i&2){let e=o.$implicit;c(),d("ngIf",e.isActive)}}function Bn(i,o){if(i&1&&(a(0,"tr"),b(1,Un,2,1,"ng-container",3)(2,qn,2,1,"ng-container",3),s()),i&2){let e=l(2);c(),d("ngForOf",e.columnDefinitions),c(),d("ngForOf",e.buttons)}}function Gn(i,o){if(i&1&&(y(0),b(1,Bn,3,2,"tr",3),w()),i&2){let e=l();c(),d("ngForOf",e.data)}}function $n(i,o){if(i&1&&(a(0,"tr")(1,"td",24),p(2," Nebyla nalezena \u017E\xE1dn\xE1 data. "),s()()),i&2){let e=l();c(),Ge("colspan",e.colspanValue)}}function Hn(i,o){if(i&1){let e=C();a(0,"button",25),h("click",function(){u(e);let t=l();return g(t.openCreateForm())}),p(1,"P\u0159idat z\xE1znam"),s()}}var be=class i extends H{constructor(e,n,t,r,m){super(e,n);this.dataHandler=e;this.cd=n;this.confirmDialogService=t;this.alertDialogService=r;this.authService=m}data=[];columnDefinitions=[];tableCaption;apiEndpoint="";isLoading=!1;uploadsBaseUrl="";buttons=[];isLogsTable=!1;itemDeleted=new R;createFormOpened=new R;editFormOpened=new R;resetPasswordFormOpened=new R;viewDetailsOpened=new R;isFullWidth=!0;ngOnChanges(e){super.ngOnChanges(e)}ngOnInit(){super.ngOnInit()}getCellValue(e,n){let r=n.key.split(".").reduce((m,_)=>m?.[_],e);switch(n.type){case"currency":return r?new fe("cs-CZ").transform(r,"CZK","symbol-narrow","1.2-2"):"";case"date":return r?new ie("cs-CZ").transform(r,n.format||"shortDate"):"";case"boolean":return r?"Ano":"Ne";case"image":return r?`${this.uploadsBaseUrl}${r}`:"";case"array":return Array.isArray(r)?r.join(", "):r;case"object":return this.isObject(r)?JSON.stringify(r):r;default:return r}}isObject(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}handleAction(e,n){switch(n){case"details":this.viewDetailsOpened.emit(e);break;case"create":this.createFormOpened.emit();break;case"delete":this.confirmDialogService.open("Potvrzen\xED smaz\xE1n\xED","Opravdu si p\u0159ejete smazat tuto polo\u017Eku?").then(t=>{t?this.deleteData(e.id).subscribe({next:()=>{this.alertDialogService.open("\xDAsp\u011Bch","Polo\u017Eka byla \xFAsp\u011B\u0161n\u011B smaz\xE1na.","success");let r=this.data.findIndex(m=>m.id===e.id);r>-1&&(this.data.splice(r,1),this.cd.markForCheck(),this.itemDeleted.emit(e))},error:r=>{console.error("Soft delete error:",r)}}):this.alertDialogService.open("Zru\u0161eno","Smaz\xE1n\xED polo\u017Eky bylo zru\u0161eno.","warning")}).catch(t=>{this.alertDialogService.open("Chyba","P\u0159i pokusu o smaz\xE1n\xED nastala chyba.","danger"),console.error("Dialog error:",t)});break;case"edit":this.editFormOpened.emit(e);break;case"password_reset":this.resetPasswordFormOpened.emit(e);break;default:console.warn("Nezn\xE1m\xFD typ tla\u010D\xEDtka:",n)}}get colspanValue(){let e=this.buttons?.filter(n=>n.isActive).length||0;return this.columnDefinitions.length+(e>0?1:0)}exportToCSV(){return ht(this,null,function*(){try{this.isLoading=!0,this.cd.markForCheck();let e=yield Ct(this.loadAllData()),n=Array.isArray(e)?e:[];if(n.length>0){let t="",r=this.columnDefinitions.map(f=>f.header||f.key).join(";");t+=r+`
`,n.forEach(f=>{let T=this.columnDefinitions.map(te=>{let ce=this.getCellValue(f,te);return ce==null&&(ce=""),`"${String(ce).replace(/"/g,'""')}"`}).join(";");t+=T+`
`});let m=new Blob([t],{type:"text/csv;charset=utf-8;"}),_=document.createElement("a");if(_.download!==void 0){let f=URL.createObjectURL(m);_.setAttribute("href",f),_.setAttribute("download",`${this.tableCaption||"export"}.csv`),_.style.visibility="hidden",document.body.appendChild(_),_.click(),document.body.removeChild(_)}else this.alertDialogService.open("Upozorn\u011Bn\xED","V\xE1\u0161 prohl\xED\u017Ee\u010D nepodporuje automatick\xE9 sta\u017Een\xED. Zkop\xEDrujte data ru\u010Dn\u011B.","info")}else this.alertDialogService.open("Export","\u017D\xE1dn\xE1 data k exportu.","warning")}catch(e){this.alertDialogService.open("Chyba","P\u0159i exportu dat nastala chyba. V\xEDce informac\xED v konzoli pro v\xFDvoj\xE1\u0159e.","danger"),console.error("Export error:",e),console.error("Error name:",e.name),console.error("Error message:",e.message)}finally{this.isLoading=!1,this.cd.markForCheck()}})}openCreateForm(){this.createFormOpened.emit()}static \u0275fac=function(n){return new(n||i)(v(L),v(z),v(Re),v(le),v(j))};static \u0275cmp=E({type:i,selectors:[["app-generic-table"]],inputs:{data:"data",columnDefinitions:[0,"columns","columnDefinitions"],tableCaption:"tableCaption",apiEndpoint:"apiEndpoint",isLoading:"isLoading",uploadsBaseUrl:"uploadsBaseUrl",buttons:"buttons",isLogsTable:"isLogsTable"},outputs:{itemDeleted:"itemDeleted",createFormOpened:"createFormOpened",editFormOpened:"editFormOpened",resetPasswordFormOpened:"resetPasswordFormOpened",viewDetailsOpened:"viewDetailsOpened"},features:[K,me],decls:18,vars:9,consts:[["noDataContent",""],[1,"table-responsive"],[4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"toolbar"],[1,"neutral_button",3,"click"],["class","confirm_button",3,"click",4,"ngIf"],[1,"checkbox-container"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"caption-content-wrapper"],[1,"caption-text"],[1,"header-content"],["class","button-header",4,"ngIf"],[1,"button-header"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["alt","Obr\xE1zek","class","table-cell-image",3,"src",4,"ngIf"],["alt","Obr\xE1zek",1,"table-cell-image",3,"src"],["target","_blank",3,"href"],["class","action-button-cell",4,"ngIf"],[1,"action-button-cell"],[3,"click","disabled"],[1,"no-data-msg"],[1,"confirm_button",3,"click"]],template:function(n,t){if(n&1){let r=C();a(0,"div",1)(1,"table"),b(2,On,4,1,"caption",2),a(3,"thead")(4,"tr"),b(5,kn,4,1,"th",3)(6,Fn,2,1,"ng-container",3),s()(),a(7,"tbody"),b(8,Gn,2,1,"ng-container",4)(9,$n,3,1,"ng-template",null,0,Ze),s()()(),a(11,"div",5)(12,"button",6),h("click",function(){return u(r),g(t.exportToCSV())}),p(13,"Exportovat tabulku"),s(),b(14,Hn,2,0,"button",7),a(15,"label",8)(16,"input",9),D("ngModelChange",function(_){return u(r),S(t.isFullWidth,_)||(t.isFullWidth=_),g(_)}),s(),p(17," Zobrazit tabulku na \u0161\xED\u0159ce str\xE1nky "),s()()}if(n&2){let r=we(10);c(),ge("fit-content-table",!t.isFullWidth),c(),d("ngIf",t.tableCaption),c(3),d("ngForOf",t.columnDefinitions),c(),d("ngForOf",t.buttons),c(2),d("ngIf",t.data&&t.data.length>0)("ngIfElse",r),c(6),d("ngIf",t.isLogsTable==!1),c(2),P("ngModel",t.isFullWidth)}},dependencies:[M,N,F,Me,Oe,Je,$,ke,U,G],styles:[".table-responsive[_ngcontent-%COMP%]{overflow-x:auto;border:1px solid #dee2e6;border-radius:6px}.toolbar[_ngcontent-%COMP%]{margin-bottom:1rem;margin-top:.5rem;display:flex;justify-content:start;align-items:center;gap:15px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-family:Arial,sans-serif;font-size:.85rem;table-layout:fixed}table.fit-content-table[_ngcontent-%COMP%]{width:fit-content;table-layout:auto}caption[_ngcontent-%COMP%]{caption-side:top;font-weight:700;text-align:left;padding:.4rem;border-bottom:1px solid #dee2e6;font-size:.9rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:2px 4px;text-align:left;border:1px solid #dee2e6;vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}th.button-header[_ngcontent-%COMP%]{text-align:center;width:100px;overflow:visible;white-space:normal;text-overflow:clip}thead[_ngcontent-%COMP%]{background-color:#f1f1f1}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#fafafa}tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}p[_ngcontent-%COMP%]{font-style:normal;color:#444;margin:0;padding:0;font-size:.85rem;line-height:1.5}.table-cell-image[_ngcontent-%COMP%]{max-width:50px;max-height:50px;object-fit:cover;border-radius:4px;display:block;margin:0 auto}.no-data-msg[_ngcontent-%COMP%]{color:#888;font-style:italic;font-size:.85rem;padding-left:15px;text-align:center}td.action-button-cell[_ngcontent-%COMP%]{text-align:center;width:120px;min-width:120px;overflow:visible;white-space:normal;text-overflow:clip}.checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.85rem;color:#4a5568;cursor:pointer;-webkit-user-select:none;user-select:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:.5rem}@media (max-width: 1024px){.table-responsive[_ngcontent-%COMP%]{width:100%}}.delete_button[_ngcontent-%COMP%]:disabled{background-color:#c8d1d8;cursor:not-allowed;opacity:.8;border-color:transparent}"],changeDetection:0})};function Wn(i,o){if(i&1&&(a(0,"caption")(1,"div",9)(2,"div",10),p(3),s()()()),i&2){let e=l();c(3),x(" ",e.tableCaption," ")}}function Zn(i,o){if(i&1&&(a(0,"th"),y(1),a(2,"span",11),p(3),s(),w(),s()),i&2){let e=o.$implicit;c(3),x(" ",e.header," ")}}function Qn(i,o){if(i&1&&(a(0,"th",13),p(1),s()),i&2){let e=l().$implicit;c(),x(" ",e.display_name," ")}}function Jn(i,o){if(i&1&&(y(0),b(1,Qn,2,1,"th",12),w()),i&2){let e=o.$implicit;c(),d("ngIf",e.isActive)}}function Kn(i,o){if(i&1&&O(0,"img",18),i&2){let e=l(3).$implicit,n=l().$implicit,t=l(2);d("src",t.getCellValue(n,e),Ee)}}function Yn(i,o){i&1&&(a(0,"span"),p(1,"Nen\xED obr\xE1zek"),s())}function Xn(i,o){if(i&1&&(y(0),b(1,Kn,1,1,"img",17)(2,Yn,2,0,"span",2),w()),i&2){let e=l(2).$implicit,n=l().$implicit,t=l(2);c(),d("ngIf",t.getCellValue(n,e)),c(),d("ngIf",!t.getCellValue(n,e))}}function ei(i,o){if(i&1&&(y(0),a(1,"a",19),p(2),s(),w()),i&2){let e=l(2).$implicit,n=l().$implicit,t=l(2);c(),d("href",t.getCellValue(n,e),Ee),c(),k(t.getCellValue(n,e))}}function ti(i,o){if(i&1&&(y(0),p(1),w()),i&2){let e=l(2).$implicit,n=l().$implicit,t=l(2);c(),x(" ",t.getCellValue(n,e)," ")}}function ni(i,o){if(i&1&&(a(0,"td"),y(1,14),b(2,Xn,3,2,"ng-container",15)(3,ei,3,2,"ng-container",15)(4,ti,2,1,"ng-container",16),w(),s()),i&2){let e=l().$implicit;c(),d("ngSwitch",e.type),c(),d("ngSwitchCase","image"),c(),d("ngSwitchCase","link")}}function ii(i,o){if(i&1&&(y(0),b(1,ni,5,3,"td",2),w()),i&2){let e=o.$implicit;c(),d("ngIf",!e.hidden)}}function oi(i,o){if(i&1){let e=C();a(0,"td",21)(1,"button",22),h("click",function(){u(e);let t=l().$implicit,r=l().$implicit,m=l(2);return g(m.handleAction(r,t.type))}),p(2),s()()}if(i&2){let e=l().$implicit;c(),$e(e.type),c(),x(" ",e.display_name," ")}}function ri(i,o){if(i&1&&(y(0),b(1,oi,3,3,"td",20),w()),i&2){let e=o.$implicit;c(),d("ngIf",e.isActive)}}function ai(i,o){if(i&1&&(a(0,"tr"),b(1,ii,2,1,"ng-container",3)(2,ri,2,1,"ng-container",3),s()),i&2){let e=l(2);c(),d("ngForOf",e.columnDefinitions),c(),d("ngForOf",e.buttons)}}function si(i,o){if(i&1&&(y(0),b(1,ai,3,2,"tr",3),w()),i&2){let e=l();c(),d("ngForOf",e.data)}}function li(i,o){if(i&1&&(a(0,"tr")(1,"td",23),p(2," Nebyla nalezena \u017E\xE1dn\xE1 data. "),s()()),i&2){let e=l();c(),Ge("colspan",e.colspanValue)}}var Ve=class i extends H{constructor(e,n,t,r){super(e,n);this.dataHandler=e;this.cd=n;this.confirmDialogService=t;this.alertDialogService=r}data=[];columnDefinitions=[];tableCaption;apiEndpoint="";isLoading=!1;uploadsBaseUrl="";buttons=[{display_name:"Obnovit",isActive:!0,type:"confirm_button"},{display_name:"Trvale Smazat",isActive:!0,type:"delete_button"}];isFullWidth=!0;itemRestored=new R;ngOnChanges(e){e.data&&(console.log("Stav pole data v GenericTrashTableComponent po ngOnChanges:"),console.table(this.data)),super.ngOnChanges(e)}ngOnInit(){super.ngOnInit(),console.log("Stav pole data po ngOnInit:"),console.table(this.data)}getCellValue(e,n){let r=n.key.split(".").reduce((m,_)=>m?.[_],e);switch(n.type){case"currency":return r?new fe("cs-CZ").transform(r,"CZK","symbol-narrow","1.2-2"):"";case"date":return r?new ie("cs-CZ").transform(r,n.format||"shortDate"):"";case"boolean":return r?"Ano":"Ne";case"image":return r?`${this.uploadsBaseUrl}${r}`:"";case"array":return Array.isArray(r)?r.join(", "):r;case"object":return this.isObject(r)?JSON.stringify(r):r;default:return r}}isObject(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}handleAction(e,n){switch(n){case"confirm_button":this.confirmDialogService.open("Potvrzen\xED obnoven\xED","Opravdu chcete obnovit tuto polo\u017Eku?").then(t=>{t?this.restoreDataFromApi(e.id).subscribe({next:()=>{this.alertDialogService.open("\xDAsp\u011Bch","Polo\u017Eka byla \xFAsp\u011B\u0161n\u011B obnovena.","success");let r=this.data.findIndex(m=>m.id===e.id);r>-1&&(this.data.splice(r,1),this.cd.markForCheck(),console.log("Stav pole data po odstran\u011Bn\xED obnoven\xE9 polo\u017Eky:"),console.table(this.data),this.itemRestored.emit())},error:r=>{this.alertDialogService.open("Chyba","P\u0159i obnoven\xED polo\u017Eky nastala chyba.","danger"),console.error("Restore error:",r)}}):this.alertDialogService.open("Zru\u0161eno","Obnoven\xED polo\u017Eky bylo zru\u0161eno.","warning")}).catch(t=>{this.alertDialogService.open("Chyba","P\u0159i pokusu o obnoven\xED nastala chyba.","danger"),console.error("Dialog error:",t)});break;case"delete_button":this.confirmDialogService.open("Potvrzen\xED trval\xE9ho smaz\xE1n\xED","Opravdu si p\u0159ejete TRVALE smazat tuto polo\u017Eku? Tato akce je nevratn\xE1!").then(t=>{t?this.hardDeleteDataFromApi(e.id).subscribe({next:()=>{this.alertDialogService.open("\xDAsp\u011Bch","Polo\u017Eka byla trvale smaz\xE1na.","success");let r=this.data.findIndex(m=>m.id===e.id);r>-1&&(this.data.splice(r,1),this.cd.markForCheck(),console.log("Stav pole data po trval\xE9m odstran\u011Bn\xED polo\u017Eky:"),console.table(this.data))},error:r=>{this.alertDialogService.open("Chyba","P\u0159i trval\xE9m maz\xE1n\xED polo\u017Eky nastala chyba.","danger"),console.error("Hard delete error:",r)}}):this.alertDialogService.open("Zru\u0161eno","Trval\xE9 smaz\xE1n\xED polo\u017Eky bylo zru\u0161eno.","warning")}).catch(t=>{this.alertDialogService.open("Chyba","P\u0159i pokusu o smaz\xE1n\xED nastala chyba.","danger"),console.error("Dialog error:",t)});break;default:break}}deleteAll(){if(this.data.length===0){this.alertDialogService.open("Upozorn\u011Bn\xED","Nejsou k dispozici \u017E\xE1dn\xE9 polo\u017Eky ke smaz\xE1n\xED.","warning");return}this.confirmDialogService.open("Trval\xE9 smaz\xE1n\xED v\u0161ech polo\u017Eek","Opravdu si p\u0159ejete TRVALE smazat V\u0160ECHNY polo\u017Eky? Tato akce je nevratn\xE1!").then(e=>{e?this.hardDeleteAllTrashedDataFromApi().subscribe({next:()=>{this.alertDialogService.open("\xDAsp\u011Bch","V\u0161echny polo\u017Eky byly trvale smaz\xE1ny.","success"),this.data=[],this.cd.markForCheck()},error:n=>{this.alertDialogService.open("Chyba","P\u0159i trval\xE9m maz\xE1n\xED polo\u017Eek nastala chyba.","danger"),console.error("Hard delete all error:",n)}}):this.alertDialogService.open("Zru\u0161eno","Trval\xE9 smaz\xE1n\xED polo\u017Eek bylo zru\u0161eno.","warning")}).catch(e=>{this.alertDialogService.open("Chyba","P\u0159i pokusu o smaz\xE1n\xED nastala chyba.","danger"),console.error("Dialog error:",e)})}get colspanValue(){let e=this.buttons?.filter(n=>n.isActive).length||0;return this.columnDefinitions.length+(e>0?1:0)}static \u0275fac=function(n){return new(n||i)(v(L),v(z),v(Re),v(le))};static \u0275cmp=E({type:i,selectors:[["app-generic-trash-table"]],inputs:{data:"data",columnDefinitions:[0,"columns","columnDefinitions"],tableCaption:"tableCaption",apiEndpoint:"apiEndpoint",isLoading:"isLoading",uploadsBaseUrl:"uploadsBaseUrl"},outputs:{itemRestored:"itemRestored"},features:[K,me],decls:17,vars:8,consts:[["noDataContent",""],[1,"table-responsive"],[4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[1,"toolbar"],[1,"delete_button",3,"click"],[1,"checkbox-container"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"caption-content-wrapper"],[1,"caption-text"],[1,"header-content"],["class","button-header",4,"ngIf"],[1,"button-header"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["alt","Obr\xE1zek","class","table-cell-image",3,"src",4,"ngIf"],["alt","Obr\xE1zek",1,"table-cell-image",3,"src"],["target","_blank",3,"href"],["class","action-button-cell",4,"ngIf"],[1,"action-button-cell"],[3,"click"],[1,"no-data-msg"]],template:function(n,t){if(n&1){let r=C();a(0,"div",1)(1,"table"),b(2,Wn,4,1,"caption",2),a(3,"thead")(4,"tr"),b(5,Zn,4,1,"th",3)(6,Jn,2,1,"ng-container",3),s()(),a(7,"tbody"),b(8,si,2,1,"ng-container",4)(9,li,3,1,"ng-template",null,0,Ze),s()()(),a(11,"div",5)(12,"button",6),h("click",function(){return u(r),g(t.deleteAll())}),p(13," Smazat v\u0161e "),s(),a(14,"label",7)(15,"input",8),D("ngModelChange",function(_){return u(r),S(t.isFullWidth,_)||(t.isFullWidth=_),g(_)}),s(),p(16," Zobrazit tabulku na \u0161\xED\u0159ce str\xE1nky "),s()()}if(n&2){let r=we(10);c(),ge("fit-content-table",!t.isFullWidth),c(),d("ngIf",t.tableCaption),c(3),d("ngForOf",t.columnDefinitions),c(),d("ngForOf",t.buttons),c(2),d("ngIf",t.data&&t.data.length>0)("ngIfElse",r),c(7),P("ngModel",t.isFullWidth)}},dependencies:[M,N,F,Me,Oe,Je,$,ke,U,G],styles:[".table-responsive[_ngcontent-%COMP%]{overflow-x:auto;border:1px solid #dee2e6;border-radius:6px}.toolbar[_ngcontent-%COMP%]{margin-bottom:1rem;margin-top:.5rem;display:flex;justify-content:start;align-items:center;gap:15px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-family:Arial,sans-serif;font-size:.85rem;table-layout:fixed}.neutral_button[_ngcontent-%COMP%]{padding:.3rem .5rem;border-radius:4px;font-weight:700;font-size:.65rem;cursor:pointer;transition:background-color .2s;border:1px solid transparent;text-transform:uppercase}table.fit-content-table[_ngcontent-%COMP%]{width:fit-content;table-layout:auto}caption[_ngcontent-%COMP%]{caption-side:top;font-weight:700;text-align:left;padding:.4rem;border-bottom:1px solid #dee2e6;font-size:.9rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:2px 4px;text-align:left;border:1px solid #dee2e6;vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}th.button-header[_ngcontent-%COMP%]{text-align:center;width:120px;overflow:visible;white-space:normal;text-overflow:clip}thead[_ngcontent-%COMP%]{background-color:#f1f1f1}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#fafafa}tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}p[_ngcontent-%COMP%]{font-style:normal;color:#444;margin:0;padding:0;font-size:.85rem;line-height:1.5}.table-cell-image[_ngcontent-%COMP%]{max-width:50px;max-height:50px;object-fit:cover;border-radius:4px;display:block;margin:0 auto}.no-data-msg[_ngcontent-%COMP%]{color:#888;font-style:italic;font-size:.85rem;padding-left:15px;text-align:center}td.action-button-cell[_ngcontent-%COMP%]{text-align:center;width:120px;min-width:120px;overflow:visible;white-space:normal;text-overflow:clip}.action-button-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.3rem .5rem;border-radius:4px;font-weight:700;font-size:.65rem;cursor:pointer;transition:background-color .2s;border:1px solid transparent;text-transform:uppercase}.info_button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.info_button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.neutral_button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.neutral_button[_ngcontent-%COMP%]:hover{background-color:#5a6268}.delete_button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.delete_button[_ngcontent-%COMP%]:hover{background-color:#c82333}.checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.85rem;color:#4a5568;cursor:pointer;-webkit-user-select:none;user-select:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:.5rem}"],changeDetection:0})};var ci=["genericForm"];function di(i,o){if(i&1&&(a(0,"h2"),p(1),s()),i&2){let e=l();c(),k(e.headerText)}}function pi(i,o){if(i&1&&(a(0,"h2"),p(1),s()),i&2){let e=l();c(),x(" Resetovat heslo: ",e.formDataToEdit.user_email," ")}}function mi(i,o){i&1&&(a(0,"span",10),p(1,"*"),s())}function ui(i,o){if(i&1){let e=C();a(0,"input",30),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("type",e.type)("id",e.column_name)("placeholder",e.placeholder)("required",!!e.required)("pattern",e.pattern||"")("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function gi(i,o){if(i&1){let e=C();a(0,"input",30),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("type",e.type)("id",e.column_name)("placeholder",e.placeholder)("required",!!e.required)("pattern",e.pattern||"")("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function _i(i,o){if(i&1){let e=C();a(0,"input",30),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("type",e.type)("id",e.column_name)("placeholder",e.placeholder)("required",!!e.required)("pattern",e.pattern||"")("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function fi(i,o){if(i&1){let e=C();a(0,"input",30),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),h("ngModelChange",function(){u(e);let t=l(2);return g(t.checkPasswordMatch())}),s()}if(i&2){let e=l().$implicit,n=l();d("type",e.type)("id",e.column_name)("placeholder",e.placeholder)("required",!!e.required)("pattern",e.pattern||"")("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function hi(i,o){if(i&1){let e=C();a(0,"input",31),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("type",e.type)("id",e.column_name)("required",!!e.required)("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function bi(i,o){if(i&1){let e=C();a(0,"input",32),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("id",e.column_name)("placeholder",e.placeholder)("required",!!e.required)("min",e.min||null)("max",e.max||null)("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function Ci(i,o){if(i&1&&(a(0,"option",36),p(1),s()),i&2){let e=o.$implicit;d("value",e.value),c(),x(" ",e.label," ")}}function vi(i,o){if(i&1){let e=C();a(0,"select",33),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),a(1,"option",34),p(2,"-- Vyberte --"),s(),b(3,Ci,2,2,"option",35),s()}if(i&2){let e=l().$implicit,n=l();ge("locked-role",e.column_name==="role_id"&&n.isUserRoleLocked),d("id",e.column_name)("required",!!e.required)("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1||e.column_name==="role_id"&&n.isUserRoleLocked),c(3),d("ngForOf",e.options)}}function xi(i,o){i&1&&(a(0,"div",37),p(1," Vlastn\xED roli nelze editovat. "),s())}function yi(i,o){if(i&1){let e=C();a(0,"input",38),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("id",e.column_name)("required",!!e.required)("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function wi(i,o){if(i&1){let e=C();a(0,"input",39),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("id",e.column_name)("required",!!e.required)("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function Pi(i,o){if(i&1){let e=C();a(0,"label",42)(1,"input",43),D("ngModelChange",function(t){u(e);let r=l(2).$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s(),p(2),s()}if(i&2){let e=o.$implicit,n=l(2).$implicit,t=l();c(),d("name",n.column_name)("value",e.value)("required",!!n.required),P("ngModel",t.formData[n.column_name]),d("disabled",n.editable===!1),c(),x(" ",e.label," ")}}function Si(i,o){if(i&1&&(a(0,"div",40),b(1,Pi,3,6,"label",41),s()),i&2){let e=l().$implicit;c(),d("ngForOf",e.options)}}function Di(i,o){if(i&1){let e=C();a(0,"textarea",44),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()}if(i&2){let e=l().$implicit,n=l();d("id",e.column_name)("placeholder",e.placeholder)("required",!!e.required)("pattern",e.pattern||"")("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function Ti(i,o){if(i&1){let e=C();a(0,"div",45)(1,"input",46),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),s()()}if(i&2){let e=l().$implicit,n=l();c(),d("id",e.column_name)("required",!!e.required)("name",e.column_name),P("ngModel",n.formData[e.column_name]),d("disabled",e.editable===!1)}}function Ei(i,o){if(i&1){let e=C();a(0,"div",47)(1,"input",48),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.formData[r.column_name],t)||(m.formData[r.column_name]=t),g(t)}),h("input",function(){u(e);let t=l().$implicit,r=l();return g(r.onSliderChange(t))}),s(),a(2,"span",49),p(3),s()()}if(i&2){let e=l().$implicit,n=l();c(),d("id",e.column_name)("min",e.min)("max",e.max)("step",e.step||1),P("ngModel",n.formData[e.column_name]),d("name",e.column_name)("disabled",e.editable===!1),c(2),x(" ",n.formData[e.column_name]||50," % ")}}function Mi(i,o){if(i&1&&(a(0,"div",50),p(1),s()),i&2){let e=l().$implicit,n=l();c(),x(" ",n.getValidationErrorMessage(n.getControl(e.column_name),e)," ")}}function Oi(i,o){i&1&&(a(0,"div",50),p(1," Hesla se neshoduj\xED. "),s())}function ki(i,o){if(i&1&&(a(0,"div",14)(1,"label",15),p(2),b(3,mi,2,0,"span",16),s(),y(4,17),b(5,ui,1,8,"input",18)(6,gi,1,8,"input",18)(7,_i,1,8,"input",18)(8,fi,1,8,"input",18)(9,hi,1,6,"input",19)(10,bi,1,8,"input",20)(11,vi,4,8,"select",21)(12,xi,2,0,"div",22)(13,yi,1,5,"input",23)(14,wi,1,5,"input",24)(15,Si,2,1,"div",25)(16,Di,1,7,"textarea",26)(17,Ti,2,5,"div",27)(18,Ei,4,8,"div",28),w(),b(19,Mi,2,1,"div",29)(20,Oi,2,0,"div",29),s()),i&2){let e,n=o.$implicit,t=l();c(),d("for",n.column_name),c(),x(" ",n.label," "),c(),d("ngIf",n.required),c(),d("ngSwitch",n.type),c(),d("ngSwitchCase","text"),c(),d("ngSwitchCase","email"),c(),d("ngSwitchCase","tel"),c(),d("ngSwitchCase","password"),c(),d("ngSwitchCase","color"),c(),d("ngSwitchCase","number"),c(),d("ngSwitchCase","select"),c(),d("ngIf",n.column_name==="role_id"&&t.isUserRoleLocked),c(),d("ngSwitchCase","date"),c(),d("ngSwitchCase","datetime"),c(),d("ngSwitchCase","radio"),c(),d("ngSwitchCase","textarea"),c(),d("ngSwitchCase","checkbox"),c(),d("ngSwitchCase","range"),c(),d("ngIf",((e=t.getControl(n.column_name))==null?null:e.invalid)&&(((e=t.getControl(n.column_name))==null?null:e.dirty)||((e=t.getControl(n.column_name))==null?null:e.touched))),c(),d("ngIf",t.passwordsNotMatching&&n.column_name==="new_password_confirmation")}}var Ae=class i{constructor(o,e){this.cd=o;this.authService=e}headerText="Vytvo\u0159it nov\xFD z\xE1znam";inputDefinitions=[];formSubmitted=new R;formCanceled=new R;genericForm;formData={};isSubmitting=!1;passwordsNotMatching=!1;formDataToEdit=null;passwordReset=!1;visibleInputDefinitions=[];isUserRoleLocked=!1;ngOnInit(){console.log(this.formDataToEdit);let o=this.authService.getUserId();this.formDataToEdit?(console.log("generic-form: Inicializace pro editaci s daty:",this.formDataToEdit),this.formData=W({},this.formDataToEdit),this.headerText="Editovat z\xE1znam",this.visibleInputDefinitions=this.inputDefinitions.filter(e=>e.show_in_edit!==!1),o&&this.formData.id==o&&(this.isUserRoleLocked=!0,console.log("U\u017Eivatel se pokou\u0161\xED editovat vlastn\xED z\xE1znam. Pole pro roli bude uzam\u010Deno."))):(console.log("generic-form: Inicializace pro vytvo\u0159en\xED nov\xE9ho z\xE1znamu."),this.formData={},this.visibleInputDefinitions=this.inputDefinitions.filter(e=>e.show_in_create!==!1),this.visibleInputDefinitions.forEach(e=>{this.formData[e.column_name]=e.defaultValue||""}))}getControl(o){return this.genericForm&&this.genericForm.controls[o]||null}checkPasswordMatch(){if(!this.passwordReset)return;let o=this.formData.new_password,e=this.formData.new_password_confirmation;this.passwordsNotMatching=o!==e}getValidationErrorMessage(o,e){return!o||!o.invalid||!o.dirty&&!o.touched?null:o.errors?.required?e.errorMessage||"Toto pole je povinn\xE9.":o.errors?.pattern?e.errorMessage||"Neplatn\xFD form\xE1t.":o.errors?.email?e.errorMessage||"Neplatn\xFD form\xE1t e-mailu.":o.errors?.min?`Minim\xE1ln\xED hodnota je ${e.min}.`:o.errors?.max?`Maxim\xE1ln\xED hodnota je ${e.max}.`:null}onSliderChange(o){}onFormClick(o){o.stopPropagation()}onOverlayClick(o){o.target===o.currentTarget&&this.onCancel()}onCancel(){console.log("Formul\xE1\u0159 byl zru\u0161en a zav\u0159en."),this.formCanceled.emit()}onSubmit(o,e){if(e?.preventDefault(),!this.isSubmitting){if(Object.keys(o.controls).forEach(n=>{let t=o.controls[n];t&&(t.markAsTouched(),t.markAsDirty())}),this.passwordReset&&(this.checkPasswordMatch(),this.passwordsNotMatching)){console.warn("Formul\xE1\u0159 nelze odeslat. Hesla se neshoduj\xED.");return}if(o.valid){this.isSubmitting=!0,console.log("Odes\xEDlan\xE1 data:",this.formData);let n=this.authService.getUserId();this.formDataToEdit&&n&&this.formDataToEdit.id==n&&this.formData.user_email&&this.formData.user_email!==this.authService.getUserEmail()&&(this.authService.setUserEmail(this.formData.user_email),console.log("User Email byl \xFAsp\u011B\u0161n\u011B aktualizov\xE1n v Local Storage.")),this.formSubmitted.emit(W({},this.formData)),this.onCancel(),this.isSubmitting=!1}else console.warn("Formul\xE1\u0159 je neplatn\xFD. Opravte pros\xEDm chyby.")}}static \u0275fac=function(e){return new(e||i)(v(z),v(j))};static \u0275cmp=E({type:i,selectors:[["app-generic-form"]],viewQuery:function(e,n){if(e&1&&St(ci,5),e&2){let t;Dt(t=Tt())&&(n.genericForm=t.first)}},inputs:{headerText:"headerText",inputDefinitions:"inputDefinitions",formDataToEdit:"formDataToEdit",passwordReset:"passwordReset"},outputs:{formSubmitted:"formSubmitted",formCanceled:"formCanceled"},decls:20,vars:5,consts:[["genericForm","ngForm"],[1,"popup-overlay",3,"mousedown"],[1,"form-container",3,"click"],[1,"form-header"],[4,"ngIf"],[1,"close-button",3,"click"],["novalidate","",3,"ngSubmit"],[1,"form-columns"],["class","form-group",4,"ngFor","ngForOf"],[1,"required-note"],[1,"required-star"],[1,"form-actions"],["type","button",1,"neutral_button",3,"click"],["type","submit",1,"submit-button",3,"disabled"],[1,"form-group"],[3,"for"],["class","required-star",4,"ngIf"],[3,"ngSwitch"],["class","form-control",3,"type","id","placeholder","required","pattern","name","ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["class","form-control",3,"type","id","required","name","ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["type","number","class","form-control",3,"id","placeholder","required","min","max","name","ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["class","form-control",3,"id","required","name","ngModel","disabled","locked-role","ngModelChange",4,"ngSwitchCase"],["class","locked-role-message",4,"ngIf"],["type","date","class","form-control",3,"id","required","name","ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["type","datetime-local","class","form-control",3,"id","required","name","ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["class","radio-group",4,"ngSwitchCase"],["class","form-control",3,"id","placeholder","required","pattern","name","ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["class","checkbox-container",4,"ngSwitchCase"],["class","slider-container",4,"ngSwitchCase"],["class","validation-message",4,"ngIf"],[1,"form-control",3,"ngModelChange","type","id","placeholder","required","pattern","name","ngModel","disabled"],[1,"form-control",3,"ngModelChange","type","id","required","name","ngModel","disabled"],["type","number",1,"form-control",3,"ngModelChange","id","placeholder","required","min","max","name","ngModel","disabled"],[1,"form-control",3,"ngModelChange","id","required","name","ngModel","disabled"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"locked-role-message"],["type","date",1,"form-control",3,"ngModelChange","id","required","name","ngModel","disabled"],["type","datetime-local",1,"form-control",3,"ngModelChange","id","required","name","ngModel","disabled"],[1,"radio-group"],["class","radio-option",4,"ngFor","ngForOf"],[1,"radio-option"],["type","radio",3,"ngModelChange","name","value","required","ngModel","disabled"],[1,"form-control",3,"ngModelChange","id","placeholder","required","pattern","name","ngModel","disabled"],[1,"checkbox-container"],["type","checkbox",1,"form-control",3,"ngModelChange","id","required","name","ngModel","disabled"],[1,"slider-container"],["type","range",1,"form-control","slider-control",3,"ngModelChange","input","id","min","max","step","ngModel","name","disabled"],[1,"slider-value"],[1,"validation-message"]],template:function(e,n){if(e&1){let t=C();a(0,"div",1),h("mousedown",function(m){return u(t),g(n.onOverlayClick(m))}),a(1,"div",2),h("click",function(m){return u(t),g(m.stopPropagation())}),a(2,"div",3),b(3,di,2,1,"h2",4)(4,pi,2,1,"h2",4),a(5,"button",5),h("click",function(){return u(t),g(n.onCancel())}),p(6," \xD7 "),s()(),a(7,"form",6,0),h("ngSubmit",function(m){u(t);let _=we(8);return g(n.onSubmit(_,m))}),a(9,"div",7),b(10,ki,21,20,"div",8),s(),a(11,"div",9)(12,"span",10),p(13,"*"),s(),p(14," Povinn\xE1 pole "),s(),a(15,"div",11)(16,"button",12),h("click",function(){return u(t),g(n.onCancel())}),p(17,"Zru\u0161it"),s(),a(18,"button",13),p(19),s()()()()()}if(e&2){let t=we(8);c(3),d("ngIf",n.passwordReset==!1),c(),d("ngIf",n.passwordReset==!0),c(6),d("ngForOf",n.visibleInputDefinitions),c(8),d("disabled",n.isSubmitting||t.invalid||n.passwordsNotMatching),c(),x(" ",n.isSubmitting?"Odes\xEDl\xE1n\xED...":"Potvrdit"," ")}},dependencies:[M,N,F,Me,Oe,$,Ye,re,ae,Ie,zt,Ut,ke,oe,Nt,U,Ke,Xe,Ht,$t,Gt,Bt,G,Lt],styles:[".popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.form-container[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;box-shadow:0 1px 2px #0000000d;background-color:#fff;max-width:700px;width:90%;position:relative;animation:_ngcontent-%COMP%_fadeIn .3s ease-out;border:1px solid #dee2e6;font-family:Arial,sans-serif;box-sizing:border-box}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem;border-bottom:1px solid #e9ecef;padding-bottom:.5rem}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:#333}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;line-height:1;color:#adb5bd;cursor:pointer;transition:color .2s ease-in-out;padding:0}.close-button[_ngcontent-%COMP%]:hover{color:#495057}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:0}label[_ngcontent-%COMP%]{display:block;font-size:.85rem;font-weight:500;color:#444;margin-bottom:.15rem;font-family:Arial,sans-serif}.form-control[_ngcontent-%COMP%]{width:100%;padding:.3rem .5rem;border:1px solid #dee2e6;border-radius:6px;background-color:#fff;box-sizing:border-box;font-size:.85rem;color:#444;transition:border-color .2s,box-shadow .2s;box-shadow:0 1px 2px #0000000d}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 1px #6366f1,0 0 0 3px #6366f133;background-color:#fff}.form-group[_ngcontent-%COMP%]:has(textarea){grid-column:span 2}textarea.form-control[_ngcontent-%COMP%]{min-height:100px;resize:vertical}.form-control.ng-invalid.ng-touched[_ngcontent-%COMP%], .form-control.ng-invalid.ng-dirty[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 1px #dc3545,0 0 0 3px #dc354540}.validation-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.8rem;margin-top:.2rem}.required-star[_ngcontent-%COMP%]{color:#dc3545;margin-left:2px}.required-note[_ngcontent-%COMP%]{font-size:.85rem;color:#6c757d;margin-top:1rem}.radio-group[_ngcontent-%COMP%], .checkbox-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:.8rem}.radio-option[_ngcontent-%COMP%]{font-weight:400;display:inline-flex;align-items:center;cursor:pointer;font-size:.85rem}.radio-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%], .checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;margin-right:.4rem;transform:scale(1.1)}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1.5rem;padding-top:1rem;border-top:1px solid #e9ecef}.required-note[_ngcontent-%COMP%]{font-size:.85rem;color:#6c757d;margin-right:auto;margin-top:0;padding-top:.5rem}.submit-button[_ngcontent-%COMP%], .cancel-button[_ngcontent-%COMP%]{padding:.3rem .5rem;border-radius:4px;font-weight:700;font-size:.65rem;cursor:pointer;transition:background-color .2s;border:1px solid transparent;text-transform:uppercase;color:#fff;box-shadow:none}.cancel-button[_ngcontent-%COMP%]{background-color:#6c757d}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#5a6268}.submit-button[_ngcontent-%COMP%]{background-color:#28a745}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#218838}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#c8d1d8;cursor:not-allowed;opacity:.8;border-color:transparent}.slider-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.slider-value[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;min-width:50px;text-align:right}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.form-control[disabled][_ngcontent-%COMP%]{background-color:#e9ecef;cursor:not-allowed;opacity:.8}.radio-option[disabled][_ngcontent-%COMP%], .checkbox-container[disabled][_ngcontent-%COMP%]{cursor:not-allowed;opacity:.8}select[disabled][_ngcontent-%COMP%], input[type=radio][disabled][_ngcontent-%COMP%] + label[_ngcontent-%COMP%], input[type=checkbox][disabled][_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.8}.form-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-columns[_ngcontent-%COMP%]{max-height:50vh;overflow-y:auto;padding-right:1rem}.form-columns[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#888 #f1f1f1}.form-columns[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.form-columns[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.form-columns[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.locked-role-message[_ngcontent-%COMP%]{color:#444;font-size:.875rem;margin-top:5px;padding-left:2px}.hidden-field[_ngcontent-%COMP%]{display:none}@media (max-width: 600px){.form-columns[_ngcontent-%COMP%]{flex-direction:column}.form-group[_ngcontent-%COMP%]{width:100%}}"]})};function Ii(i,o){if(i&1){let e=C();a(0,"input",17),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.filterForm[r.key],t)||(m.filterForm[r.key]=t),g(t)}),h("keyup.enter",function(){u(e);let t=l(2);return g(t.applyFilters())}),s()}if(i&2){let e=l().$implicit,n=l();d("type",e.type)("id","filter"+e.key),P("ngModel",n.filterForm[e.key]),d("placeholder",e.placeholder)}}function Fi(i,o){if(i&1&&(a(0,"option",20),p(1),s()),i&2){let e=o.$implicit;d("value",e),c(),k(e)}}function Ri(i,o){if(i&1){let e=C();a(0,"select",18),D("ngModelChange",function(t){u(e);let r=l().$implicit,m=l();return S(m.filterForm[r.key],t)||(m.filterForm[r.key]=t),g(t)}),a(1,"option",6),p(2),s(),b(3,Fi,2,2,"option",19),s()}if(i&2){let e=l().$implicit,n=l();d("id","filter"+e.key),P("ngModel",n.filterForm[e.key]),c(2),k(e.placeholder),c(),d("ngForOf",e.options)}}function Vi(i,o){if(i&1&&(a(0,"div")(1,"label",14),p(2),s(),b(3,Ii,1,4,"input",15)(4,Ri,4,4,"select",16),s()),i&2){let e=o.$implicit;c(),d("for","filter"+e.key),c(),k(e.header),c(),d("ngIf",e.type==="text"||e.type==="email"||e.type==="search"),c(),d("ngIf",e.type==="select")}}function Ai(i,o){if(i&1&&(a(0,"option",20),p(1),s()),i&2){let e=l().$implicit;d("value",e.key),c(),k(e.header)}}function Li(i,o){if(i&1&&(y(0),b(1,Ai,2,2,"option",21),w()),i&2){let e=o.$implicit;c(),d("ngIf",e.canSort)}}var Ce=class i{filterColumns=[];filterFormTitle="Filtrovat data";initialFilters={};initialSortBy="";initialSortDirection="asc";filtersApplied=new R;filtersCleared=new R;filterForm={};sortBy="";sortDirection="asc";ngOnChanges(o){o.initialFilters&&(this.filterForm=W({},this.initialFilters)),o.initialSortBy&&(this.sortBy=this.initialSortBy),o.initialSortDirection&&(this.sortDirection=this.initialSortDirection),this.setFilterFormValues()}setFilterFormValues(){this.filterColumns.forEach(o=>{this.filterForm[o.key]=this.initialFilters[o.key]||""}),this.sortBy=this.initialSortBy||"",this.sortDirection=this.initialSortDirection||"asc"}applyFilters(){let o=ft(W({},this.filterForm),{sort_by:this.sortBy,sort_direction:this.sortDirection});this.filtersApplied.emit(o)}clearFilters(){this.filterColumns.forEach(o=>{this.filterForm[o.key]=""}),this.sortBy="",this.sortDirection="asc",this.filtersCleared.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=E({type:i,selectors:[["app-generic-filter-form"]],inputs:{filterColumns:"filterColumns",filterFormTitle:"filterFormTitle",initialFilters:"initialFilters",initialSortBy:"initialSortBy",initialSortDirection:"initialSortDirection"},outputs:{filtersApplied:"filtersApplied",filtersCleared:"filtersCleared"},features:[me],decls:27,vars:5,consts:[[1,"filter-form-container"],[1,"filter-form-title"],[1,"filter-grid"],[4,"ngFor","ngForOf"],["for","filterSortBy",1,"filter-label"],["id","filterSortBy",1,"filter-select",3,"ngModelChange","ngModel"],["value",""],["for","filterSortDirection",1,"filter-label"],["id","filterSortDirection",1,"filter-select",3,"ngModelChange","ngModel"],["value","asc"],["value","desc"],[1,"filter-buttons-container"],[1,"filter-button","clear",3,"click"],[1,"filter-button","apply",3,"click"],[1,"filter-label",3,"for"],["class","filter-input",3,"type","id","ngModel","placeholder","ngModelChange","keyup.enter",4,"ngIf"],["class","filter-select",3,"id","ngModel","ngModelChange",4,"ngIf"],[1,"filter-input",3,"ngModelChange","keyup.enter","type","id","ngModel","placeholder"],[1,"filter-select",3,"ngModelChange","id","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"value",4,"ngIf"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"h3",1),p(2),s(),a(3,"div",2),b(4,Vi,5,4,"div",3),s(),O(5,"hr"),a(6,"div",2)(7,"div")(8,"label",4),p(9,"Se\u0159adit podle"),s(),a(10,"select",5),D("ngModelChange",function(r){return S(n.sortBy,r)||(n.sortBy=r),r}),a(11,"option",6),p(12,"-- Vybrat sloupec --"),s(),b(13,Li,2,1,"ng-container",3),s()(),a(14,"div")(15,"label",7),p(16,"Sm\u011Br \u0159azen\xED"),s(),a(17,"select",8),D("ngModelChange",function(r){return S(n.sortDirection,r)||(n.sortDirection=r),r}),a(18,"option",9),p(19,"Vzestupn\u011B (A-Z, od nejmen\u0161\xEDho)"),s(),a(20,"option",10),p(21,"Sestupn\u011B (Z-A, od nejv\u011Bt\u0161\xEDho)"),s()()()(),a(22,"div",11)(23,"button",12),h("click",function(){return n.clearFilters()}),p(24," Vy\u010Distit filtry "),s(),a(25,"button",13),h("click",function(){return n.applyFilters()}),p(26," Pou\u017E\xEDt filtry "),s()()()),e&2&&(c(2),k(n.filterFormTitle),c(2),d("ngForOf",n.filterColumns),c(6),P("ngModel",n.sortBy),c(3),d("ngForOf",n.filterColumns),c(4),P("ngModel",n.sortDirection))},dependencies:[M,N,F,$,re,ae,Ie,oe,U,G],styles:[".filter-form-container[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 1px 2px #0000000d;border-radius:6px;border:1px solid #dee2e6;padding:.75rem;margin-bottom:1rem}.filter-form-title[_ngcontent-%COMP%]{margin-top:0;font-size:1rem;font-weight:700;color:#333;margin-bottom:.5rem;font-family:Arial,sans-serif}.filter-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}.filter-label[_ngcontent-%COMP%]{display:block;font-size:.8rem;font-weight:500;color:#444;margin-bottom:.15rem;font-family:Arial,sans-serif}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{margin-top:.15rem;display:block;width:100%;border-radius:6px;border:1px solid #dee2e6;box-shadow:0 1px 2px #0000000d;padding:.3rem .5rem;font-size:.8rem;color:#444;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;font-family:Arial,sans-serif}.filter-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.filter-input[_ngcontent-%COMP%]:focus, .filter-select[_ngcontent-%COMP%]:focus{border-color:#6366f1;box-shadow:0 0 0 1px #6366f1,0 0 0 3px #6366f133}.filter-buttons-container[_ngcontent-%COMP%]{margin-top:.75rem;display:flex;justify-content:flex-end;gap:.5rem}.filter-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.4rem .8rem;border-radius:6px;box-shadow:0 1px 2px #0000000d;font-size:.8rem;font-weight:500;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,color .15s ease-in-out,box-shadow .15s ease-in-out;cursor:pointer;outline:none;font-family:Arial,sans-serif}.filter-button[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 2px #6366f133}.filter-button.clear[_ngcontent-%COMP%]{border:1px solid #dee2e6;background-color:#fff;color:#444}.filter-button.clear[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.filter-button.apply[_ngcontent-%COMP%]{border:1px solid transparent;background-color:#4f46e5;color:#fff}.filter-button.apply[_ngcontent-%COMP%]:hover{background-color:#4338ca}"]})};function zi(i,o){if(i&1&&(a(0,"div",8)(1,"strong"),p(2),s(),p(3),s()),i&2){let e=o.$implicit,n=l(2);c(2),x("",e.displayName,":"),c(),x(" ",n.getFormattedValue(n.itemData,e.key,e)," ")}}function Ni(i,o){if(i&1&&(a(0,"div",6),b(1,zi,4,2,"div",7),s()),i&2){let e=l();c(),d("ngForOf",e.itemDetailColumns)}}var ve=class i{constructor(o,e){this.datePipe=o;this.currencyPipe=e}itemData;itemDetailColumns=[];closeDetails=new R;onClose(){this.closeDetails.emit()}onOverlayClick(o){o.target===o.currentTarget&&this.onClose()}getFormattedValue(o,e,n){let t=this.getValueByPath(o,e);switch(n.type){case"currency":return this.currencyPipe.transform(t,"CZK","symbol-narrow","1.2-2","cs-CZ");case"date":if(t instanceof Date)return this.datePipe.transform(t,n.format||"short","cs-CZ");if(typeof t=="string"){let r=new Date(t);return this.datePipe.transform(r,n.format||"short","cs-CZ")}else return t;case"boolean":return t?"Ano":"Ne";default:return t}}getValueByPath(o,e){if(!o||!e)return"";let n=e.split("."),t=o;for(let r=0;r<n.length;r++){let m=n[r];if(t==null)return"";t=t[m]}return t}static \u0275fac=function(e){return new(e||i)(v(ie),v(fe))};static \u0275cmp=E({type:i,selectors:[["app-generic-details"]],inputs:{itemData:"itemData",itemDetailColumns:"itemDetailColumns"},outputs:{closeDetails:"closeDetails"},features:[He([ie,fe])],decls:9,vars:1,consts:[[1,"popup-overlay",3,"mousedown"],[1,"form-container",3,"click"],[1,"form-header"],[1,"close-button",3,"click"],[1,"details-content"],["class","details-list",4,"ngIf"],[1,"details-list"],["class","details-item",4,"ngFor","ngForOf"],[1,"details-item"]],template:function(e,n){e&1&&(a(0,"div",0),h("mousedown",function(r){return n.onOverlayClick(r)}),a(1,"div",1),h("click",function(r){return r.stopPropagation()}),a(2,"div",2)(3,"h2"),p(4,"Detaily Vybran\xE9ho Z\xE1znamu"),s(),a(5,"button",3),h("click",function(){return n.onClose()}),p(6," \xD7 "),s()(),a(7,"div",4),b(8,Ni,2,1,"div",5),s()()()),e&2&&(c(8),d("ngIf",n.itemData))},dependencies:[M,N,F],styles:[".popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.form-container[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;box-shadow:0 1px 2px #0000000d;background-color:#fff;max-width:700px;width:90%;position:relative;animation:_ngcontent-%COMP%_fadeIn .3s ease-out;border:1px solid #dee2e6;font-family:Arial,sans-serif;box-sizing:border-box;max-height:80vh;display:flex;flex-direction:column}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem;border-bottom:1px solid #e9ecef;padding-bottom:.5rem}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:#333}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;line-height:1;color:#adb5bd;cursor:pointer;transition:color .2s ease-in-out;padding:0}.close-button[_ngcontent-%COMP%]:hover{color:#495057}.details-content[_ngcontent-%COMP%]{margin-top:1rem;flex:1;overflow-y:auto;padding-right:1rem}.details-content[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#888 #f1f1f1}.details-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.details-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.details-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px}.details-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.details-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:.5rem .75rem;background-color:#f9f9f9;border-radius:6px;border:1px solid #ececec}.details-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#444;font-weight:500;margin-bottom:.15rem;font-size:.85rem}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}"]})};var Yt=[{display_name:"Detaily",isActive:!0,type:"info_button",action:"details"},{display_name:"Editovat",isActive:!0,type:"neutral_button",action:"edit"},{display_name:"Nove button",isActive:!1,type:"neutral_button",action:""},{display_name:"Smazat",isActive:!0,type:"delete_button",action:"delete"}],Xt=[{column_name:"thema",label:"T\xE9ma",placeholder:"Zadejte t\xE9ma po\u017Eadavku",type:"text",required:!0,pattern:"^[a-zA-Z0-9\u011B\u0161\u010D\u0159\u017E\xFD\xE1\xED\xE9\xF3\xFA\u016F\u010F\u0165\u0148\u011A\u0160\u010C\u0158\u017D\xDD\xC1\xCD\xC9\xDA\u016E\u010E\u0164\u0147\\s]{3,100}$",errorMessage:"T\xE9ma mus\xED m\xEDt 3-100 znak\u016F.",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"contact_email",label:"Kontaktn\xED e-mail",placeholder:"Zadejte e-mail",type:"email",required:!0,pattern:"[^@]+@[^@]+\\.[^@]+",errorMessage:"Zadejte platnou e-mailovou adresu.",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"contact_phone",label:"Telefon",placeholder:"Zadejte telefonn\xED \u010D\xEDslo (voliteln\xE9)",type:"tel",required:!1,pattern:"^[0-9+\\s-]{9,20}$",errorMessage:"Zadejte platn\xE9 telefonn\xED \u010D\xEDslo.",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"order_description",label:"Popis objedn\xE1vky",placeholder:"Popi\u0161te sv\u016Fj po\u017Eadavek",type:"textarea",required:!0,errorMessage:"Popis je povinn\xFD.",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"note",label:"Pozn\xE1mka",placeholder:"Napi\u0161te pozn\xE1mku",type:"textarea",required:!1,errorMessage:"",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"status",label:"Status",placeholder:"",type:"select",options:[{value:"Nov\u011B zadan\xE9",label:"N\xEDzk\xE1"},{value:"Zpracov\xE1v\xE1 se",label:"Zpracov\xE1v\xE1 se"},{value:"Dokon\u010Deno",label:"Dokon\u010Deno"},{value:"Zru\u0161eno",label:"Zru\u0161eno"}],required:!0,errorMessage:"Pole je povinn\xE9.",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"priority",label:"Priorita",placeholder:"",type:"select",options:[{value:"N\xEDzk\xE1",label:"N\xEDzk\xE1"},{value:"Neutr\xE1ln\xED",label:"Neutr\xE1ln\xED"},{value:"Vysok\xE1",label:"Vysok\xE1"}],required:!0,errorMessage:"Pole je povinn\xE9.",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"id",label:"ID z\xE1znamu",type:"text",editable:!1,show_in_edit:!1,show_in_create:!1},{column_name:"created_at",label:"Vytvo\u0159eno",type:"text",editable:!1,show_in_edit:!1,show_in_create:!1}],en=[{key:"id",header:"ID",type:"text"},{key:"thema",header:"T\xE9ma",type:"text"},{key:"contact_email",header:"Email",type:"text"},{key:"contact_phone",header:"Telefon",type:"text"},{key:"status",header:"Stav",type:"text"},{key:"priority",header:"Priorita",type:"text"},{key:"created_at",header:"Vytvo\u0159eno",type:"date",format:"short"},{key:"order_description",header:"Popis objedn\xE1vky",type:"text"},{key:"note",header:"Pozn\xE1mka",type:"text"},{key:"updated_at",header:"Zm\u011Bn\u011Bno",type:"date",format:"short"}],tn=[{key:"id",header:"ID",type:"text"},{key:"thema",header:"T\xE9ma",type:"text"},{key:"contact_email",header:"Email",type:"text"},{key:"contact_phone",header:"Telefon",type:"text"},{key:"status",header:"Stav",type:"text"},{key:"priority",header:"Priorita",type:"text"},{key:"created_at",header:"Vytvo\u0159eno",type:"date",format:"short"},{key:"order_description",header:"Popis objedn\xE1vky",type:"text"},{key:"note",header:"Pozn\xE1mka",type:"text"},{key:"deleted_at",header:"Smaz\xE1no",type:"date",format:"short"},{key:"updated_at",header:"Zm\u011Bn\u011Bno",type:"date",format:"short"}],pt=["Nov\u011B zadan\xE9","Zpracov\xE1v\xE1 se","Dokon\u010Deno","Zru\u0161eno"],mt=["N\xEDzk\xE1","Neutr\xE1ln\xED","Vysok\xE1"],nn=[{key:"id",header:"ID",type:"text",placeholder:"Hledat podle ID",canSort:!0},{key:"thema",header:"T\xE9ma",type:"text",placeholder:"Hledat t\xE9ma",canSort:!0},{key:"contact_email",header:"E-mail",type:"email",placeholder:"Hledat podle e-mailu",canSort:!0},{key:"contact_phone",header:"Telefon",type:"text",placeholder:"Hledat telefon",canSort:!0},{key:"order_description",header:"Popis objedn\xE1vky",type:"text",placeholder:"Hledat v popisu objedn\xE1vky",canSort:!0},{key:"status",header:"Stav",type:"select",options:pt,placeholder:"-- Vybrat stav --",canSort:!0},{key:"priority",header:"Priorita",type:"select",options:mt,placeholder:"-- Vybrat prioritu --",canSort:!0},{key:"created_at",header:"Datum vytvo\u0159en\xED",type:"text",placeholder:"Hledat podle data vytvo\u0159en\xED",canSort:!0},{key:"updated_at",header:"Datum aktualizace",type:"text",placeholder:"Hledat podle data aktualizace",canSort:!0}],on=[{key:"id",displayName:"ID polo\u017Eky",type:"text"},{key:"thema",displayName:"T\xE9ma",type:"text"},{key:"contact_email",displayName:"Kontaktn\xED Email",type:"text"},{key:"contact_phone",displayName:"Kontaktn\xED Telefon",type:"text"},{key:"order_description",displayName:"Popis Po\u017Eadavku",type:"text"},{key:"status",displayName:"Status",type:"text"},{key:"priority",displayName:"Priorita",type:"text"},{key:"created_at",displayName:"Datum Vytvo\u0159en\xED",type:"date",format:"medium"},{key:"updated_at",displayName:"Posledn\xED Datum Zm\u011Bny",type:"date",format:"medium"},{key:"note",displayName:"Intern\xED Pozn\xE1mka",type:"text"}];var xe=class i{constructor(o){this.dataHandler=o}pageCache=new Map;lastFilterParams={};getPaginatedData(o,e=1,n=15,t={}){JSON.stringify(t)!==JSON.stringify(this.lastFilterParams)&&(this.clearCache(),this.lastFilterParams=W({},t));let r=this.getCacheKey(o,e,n,t);if(this.pageCache.has(r))return this.pageCache.get(r);let m=new dt;m=m.append("page",e.toString()),m=m.append("per_page",n.toString());for(let f in t){let T=t[f];T!=null&&T!==""&&(m=m.append(f,T.toString()))}let _=this.dataHandler.getPaginatedCollection(`${o}?${m.toString()}`).pipe(pe(()=>console.log(`Fetched from API: ${r}`)),xt(1));return this.pageCache.set(r,_),_}preloadAdjacentPages(o,e,n,t,r=2,m={}){let _=[];for(let f=1;f<=r;f++){let T=e-f;T>=1&&_.push(T)}for(let f=1;f<=r;f++){let T=e+f;T<=n&&_.push(T)}_.forEach(f=>{let T=this.getCacheKey(o,f,t,m);this.pageCache.has(T)||this.getPaginatedData(o,f,t,m).subscribe({error:te=>console.error(`Failed to preload ${T}:`,te)})})}clearCache(){this.pageCache.clear()}getCacheKey(o,e,n,t){let m=Object.keys(t).sort().reduce((_,f)=>{let T=t[f];return T!=null&&T!==""&&(_[f]=T),_},{});return`${o}-${e}-${n}-${JSON.stringify(m)}`}getAllData(o,e={}){let n=new dt;for(let t in e){let r=e[t];r!=null&&r!==""&&(n=n.append(t,r.toString()))}return n=n.append("no_pagination","true"),this.dataHandler.getCollection(`${o}?${n.toString()}`)}static \u0275fac=function(e){return new(e||i)(B(L))};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ui=(i,o,e,n,t,r,m,_,f,T)=>({search:i,status:o,priority:e,contact_email:n,contact_phone:t,thema:r,id:m,order_description:_,created_at:f,updated_at:T}),rn=i=>({"active-page":i});function ji(i,o){i&1&&(a(0,"div",6),p(1,"Na\u010D\xEDt\xE1n\xED dat..."),s())}function qi(i,o){if(i&1){let e=C();a(0,"div",6)(1,"button",7),h("click",function(){u(e);let t=l();return g(t.refreshData())}),p(2," Znovu na\u010D\xEDst data "),s()()}}function Bi(i,o){if(i&1&&(a(0,"div",8),p(1),s()),i&2){let e=l();c(),k(e.errorMessage)}}function Gi(i,o){if(i&1){let e=C();a(0,"div",8)(1,"button",7),h("click",function(){u(e);let t=l();return g(t.refreshData())}),p(2," Znovu na\u010D\xEDst data "),s()()}}function $i(i,o){if(i&1){let e=C();a(0,"app-generic-table",16),h("itemDeleted",function(){u(e);let t=l(2);return g(t.handleItemDeleted())})("createFormOpened",function(){u(e);let t=l(2);return g(t.handleCreateFormOpened())})("editFormOpened",function(t){u(e);let r=l(2);return g(r.handleEditFormOpened(t))})("viewDetailsOpened",function(t){u(e);let r=l(2);return g(r.handleViewDetails(t))}),s()}if(i&2){let e=l(2);d("buttons",e.buttons)("data",e.data)("columns",e.userRequestColumns)("tableCaption","Seznam po\u017Eadavk\u016F na provize")("isLoading",e.isLoading)("apiEndpoint",e.apiEndpoint)("uploadsBaseUrl","[https://your-upload-domain.com/uploads/](https://your-upload-domain.com/uploads/)")}}function Hi(i,o){if(i&1){let e=C();a(0,"app-generic-trash-table",17),h("itemRestored",function(){u(e);let t=l(2);return g(t.handleItemRestored())}),s()}if(i&2){let e=l(2);d("data",e.trashData)("columns",e.trashUserRequestColumns)("tableCaption","Obnova dat")("isLoading",e.isLoading)("apiEndpoint",e.apiEndpoint)("uploadsBaseUrl","[https://your-upload-domain.com/uploads/](https://your-upload-domain.com/uploads/)")}}function Wi(i,o){if(i&1){let e=C();y(0),a(1,"button",36),h("click",function(){let t=u(e).$implicit,r=l(3);return g(r.goToPage(t))}),p(2),s(),w()}if(i&2){let e=o.$implicit,n=l(3);c(),d("ngClass",Y(2,rn,e===n.currentPage)),c(),x(" ",e," ")}}function Zi(i,o){if(i&1){let e=C();a(0,"div",18)(1,"div",19),p(2),s(),a(3,"div",20)(4,"label",21),p(5,"Polo\u017Eek na str\xE1nku:"),s(),a(6,"select",22),h("change",function(t){u(e);let r=l(2);return g(r.onItemsPerPageChange(t))}),D("ngModelChange",function(t){u(e);let r=l(2);return S(r.itemsPerPage,t)||(r.itemsPerPage=t),g(t)}),a(7,"option",23),p(8,"5"),s(),a(9,"option",24),p(10,"10"),s(),a(11,"option",25),p(12,"15"),s(),a(13,"option",26),p(14,"20"),s(),a(15,"option",27),p(16,"50"),s()()(),a(17,"nav",28)(18,"button",29),h("click",function(){u(e);let t=l(2);return g(t.goToPage(t.currentPage-1))}),a(19,"span",30),p(20,"P\u0159edchoz\xED"),s(),Z(),a(21,"svg",31),O(22,"path",32),s()(),b(23,Wi,3,4,"ng-container",33),ue(),a(24,"button",34),h("click",function(){u(e);let t=l(2);return g(t.goToPage(t.currentPage+1))}),a(25,"span",30),p(26,"Dal\u0161\xED"),s(),Z(),a(27,"svg",31),O(28,"path",35),s()()()()}if(i&2){let e=l(2);c(2),_e(" Zobrazuji ",(e.currentPage-1)*e.itemsPerPage+1," - ",(e.currentPage-1)*e.itemsPerPage+e.data.length," z celkem ",e.totalItems," z\xE1znam\u016F. "),c(4),P("ngModel",e.itemsPerPage),c(12),d("disabled",e.currentPage===1),c(5),d("ngForOf",e.pagesArray),c(),d("disabled",e.currentPage===e.totalPages)}}function Qi(i,o){if(i&1){let e=C();y(0),a(1,"button",36),h("click",function(){let t=u(e).$implicit,r=l(3);return g(r.goToTrashPage(t))}),p(2),s(),w()}if(i&2){let e=o.$implicit,n=l(3);c(),d("ngClass",Y(2,rn,e===n.trashCurrentPage)),c(),x(" ",e," ")}}function Ji(i,o){if(i&1){let e=C();a(0,"div",18)(1,"div",19),p(2),s(),a(3,"div",20)(4,"label",37),p(5,"Polo\u017Eek na str\xE1nku:"),s(),a(6,"select",38),h("change",function(t){u(e);let r=l(2);return g(r.onTrashItemsPerPageChange(t))}),D("ngModelChange",function(t){u(e);let r=l(2);return S(r.trashItemsPerPage,t)||(r.trashItemsPerPage=t),g(t)}),a(7,"option",23),p(8,"5"),s(),a(9,"option",24),p(10,"10"),s(),a(11,"option",25),p(12,"15"),s(),a(13,"option",26),p(14,"20"),s(),a(15,"option",27),p(16,"50"),s()()(),a(17,"nav",28)(18,"button",29),h("click",function(){u(e);let t=l(2);return g(t.goToTrashPage(t.trashCurrentPage-1))}),a(19,"span",30),p(20,"P\u0159edchoz\xED"),s(),Z(),a(21,"svg",31),O(22,"path",32),s()(),b(23,Qi,3,4,"ng-container",33),ue(),a(24,"button",34),h("click",function(){u(e);let t=l(2);return g(t.goToTrashPage(t.trashCurrentPage+1))}),a(25,"span",30),p(26,"Dal\u0161\xED"),s(),Z(),a(27,"svg",31),O(28,"path",35),s()()()()}if(i&2){let e=l(2);c(2),_e(" Zobrazuji ",(e.trashCurrentPage-1)*e.trashItemsPerPage+1," - ",(e.trashCurrentPage-1)*e.trashItemsPerPage+e.trashData.length," z celkem ",e.trashTotalItems," z\xE1znam\u016F. "),c(4),P("ngModel",e.trashItemsPerPage),c(12),d("disabled",e.trashCurrentPage===1),c(5),d("ngForOf",e.trashPagesArray),c(),d("disabled",e.trashCurrentPage===e.trashTotalPages)}}function Ki(i,o){if(i&1){let e=C();a(0,"div")(1,"div",9)(2,"app-generic-filter-form",10),h("filtersApplied",function(t){u(e);let r=l();return g(r.applyFilters(t))})("filtersCleared",function(){u(e);let t=l();return g(t.clearFilters())}),s(),a(3,"div",11),b(4,$i,1,7,"app-generic-table",12)(5,Hi,1,6,"app-generic-trash-table",13),a(6,"button",14),h("click",function(){u(e);let t=l();return g(t.toggleTable())}),p(7),s(),b(8,Zi,29,7,"div",15)(9,Ji,29,7,"div",15),s()()()}if(i&2){let e=l();c(2),d("filterColumns",e.filterColumns)("initialFilters",We(9,Ui,[e.filterSearch,e.filterStatus,e.filterPriority,e.filterEmail,e.filterPhone,e.filterThema,e.filterId,e.filterDescription,e.filterCreatedAt,e.filterUpdatedAt]))("initialSortBy",e.filterSortBy)("initialSortDirection",e.filterSortDirection),c(2),d("ngIf",!e.showTrashTable),c(),d("ngIf",e.showTrashTable),c(2),x(" ",e.showTrashTable?"Zobrazit Aktivn\xED Po\u017Eadavky":"Zobrazit Smazan\xE9 Po\u017Eadavky"," "),c(),d("ngIf",!e.showTrashTable),c(),d("ngIf",e.showTrashTable)}}function Yi(i,o){if(i&1){let e=C();a(0,"app-generic-form",39),h("formSubmitted",function(t){u(e);let r=l();return g(r.handleFormSubmitted(t))})("formCanceled",function(){u(e);let t=l();return g(t.onCancelForm())}),s()}if(i&2){let e=l();d("inputDefinitions",e.formFields)("formDataToEdit",e.selectedItemForEdit)}}function Xi(i,o){if(i&1){let e=C();a(0,"app-generic-details",40),h("closeDetails",function(){u(e);let t=l();return g(t.handleCloseDetails())}),s()}if(i&2){let e=l();d("itemDetailColumns",e.detailsColumns)("itemData",e.selectedItemForDetails)}}var rt=class i extends H{constructor(e,n,t,r,m){super(e,n);this.dataHandler=e;this.cd=n;this.genericTableService=t;this.authService=r;this.router=m}apiEndpoint="raw_request_commissions";trashData=[];isLoading=!1;isTrashTableLoading=!1;buttons=Yt;formFields=Xt;userRequestColumns=en;trashUserRequestColumns=tn;statusOptions=pt;priorityOptions=mt;filterColumns=nn;detailsColumns=on;filterFormFields=[];showTrashTable=!1;showCreateForm=!1;currentPage=1;itemsPerPage=15;totalItems=0;totalPages=0;showDetails=!1;selectedItemForDetails=null;trashCurrentPage=1;trashItemsPerPage=15;trashTotalItems=0;trashTotalPages=0;filterSearch="";filterStatus="";filterPriority="";filterEmail="";filterSortBy="";filterPhone="";filterThema="";filterDescription="";filterCreatedAt="";filterUpdatedAt="";filterId="";filterSortDirection="asc";activeRequestsCache=new Map;trashRequestsCache=new Map;currentActiveFilters={};currentTrashFilters={};selectedItemForEdit=null;ngOnInit(){super.ngOnInit(),this.authService.isLoggedIn$.subscribe(e=>{e?this.forceFullRefresh():this.router.navigate(["/auth/login"])})}refreshData(){this.forceFullRefresh()}getBaseFilters(){return{search:this.filterSearch,status:this.filterStatus,priority:this.filterPriority,contact_email:this.filterEmail,contact_phone:this.filterPhone,id:this.filterId,order_description:this.filterDescription,thema:this.filterThema,created_at:this.filterCreatedAt,updated_at:this.filterUpdatedAt,sort_by:this.filterSortBy,sort_direction:this.filterSortDirection}}fetchPaginatedData(e,n,t,r,m){let _=this.getBaseFilters();if(e?_.only_trashed="true":_.is_deleted="false",JSON.stringify(_)!==JSON.stringify(m)&&(r.clear(),e?(this.trashCurrentPage=1,this.currentTrashFilters=_):(this.currentPage=1,this.currentActiveFilters=_)),r.has(n)){let f=r.get(n);return e?this.trashData=f:this.data=f,this.cd.detectChanges(),this.preloadPage(e,n+1,t,r),De({data:f,current_page:n,last_page:e?this.trashTotalPages:this.totalPages,total:e?this.trashTotalItems:this.totalItems})}return this.genericTableService.getPaginatedData(this.apiEndpoint,n,t,_).pipe(Te(1),pe(f=>{e?(this.trashData=f.data,this.trashTotalItems=f.total,this.trashTotalPages=f.last_page,this.trashCurrentPage=f.current_page):(this.data=f.data,this.totalItems=f.total,this.totalPages=f.last_page,this.currentPage=f.current_page),r.set(n,f.data),this.cd.detectChanges(),this.preloadPage(e,n+1,t,r)}))}preloadPage(e,n,t,r){let m=e?this.trashTotalPages:this.totalPages;if(n>m||r.has(n))return;let _=this.getBaseFilters();e?_.only_trashed="true":_.is_deleted="false",this.genericTableService.getPaginatedData(this.apiEndpoint,n,t,_).subscribe({next:f=>{r.set(n,f.data)},error:f=>{}})}loadActiveRequests(){return this.fetchPaginatedData(!1,this.currentPage,this.itemsPerPage,this.activeRequestsCache,this.currentActiveFilters)}loadTrashRequests(){return this.fetchPaginatedData(!0,this.trashCurrentPage,this.trashItemsPerPage,this.trashRequestsCache,this.currentTrashFilters)}toggleTable(){this.showTrashTable=!this.showTrashTable,this.forceFullRefresh()}applyFilters(e){this.filterSearch=e.search||"",this.filterStatus=e.status||"",this.filterPriority=e.priority||"",this.filterEmail=e.contact_email||"",this.filterPhone=e.contact_phone||"",this.filterThema=e.thema||"",this.filterCreatedAt=e.created_at||"",this.filterUpdatedAt=e.updated_at||"",this.filterId=e.id||"",this.filterDescription=e.order_description||"",this.filterSortBy=e.sort_by||"",this.filterSortDirection=e.sort_direction||"asc",this.forceFullRefresh()}clearFilters(){this.filterSearch="",this.filterStatus="",this.filterPriority="",this.filterEmail="",this.filterPhone="",this.filterThema="",this.filterId="",this.filterCreatedAt="",this.filterUpdatedAt="",this.filterDescription="",this.filterSortBy="",this.filterSortDirection="asc",this.forceFullRefresh()}goToPage(e){e>=1&&e<=this.totalPages&&e!==this.currentPage&&(this.currentPage=e,this.loadActiveRequests().subscribe())}goToTrashPage(e){e>=1&&e<=this.trashTotalPages&&e!==this.trashCurrentPage&&(this.trashCurrentPage=e,this.loadTrashRequests().subscribe())}onItemsPerPageChange(e){let n=e.target,t=Number(n.value);t!==this.itemsPerPage&&(this.itemsPerPage=t,this.forceFullRefresh())}onTrashItemsPerPageChange(e){let n=e.target,t=Number(n.value);t!==this.trashItemsPerPage&&(this.trashItemsPerPage=t,this.forceFullRefresh())}getPaginationArray(e,n){let r=Math.max(1,e-Math.floor(2.5)),m=Math.min(n,r+5-1);m-r+1<5&&(r=Math.max(1,m-5+1));let _=[];for(let f=r;f<=m;f++)_.push(f);return _}get pagesArray(){return this.getPaginationArray(this.currentPage,this.totalPages)}get trashPagesArray(){return this.getPaginationArray(this.trashCurrentPage,this.trashTotalPages)}handleItemRestored(){this.forceFullRefresh()}handleItemDeleted(){this.forceFullRefresh()}forceFullRefresh(){this.activeRequestsCache.clear(),this.trashRequestsCache.clear(),this.currentPage=1,this.trashCurrentPage=1,this.isLoading=!0,this.isTrashTableLoading=!0,this.cd.detectChanges(),je([this.loadActiveRequests(),this.loadTrashRequests()]).pipe(q(()=>{this.isLoading=!1,this.isTrashTableLoading=!1,this.cd.detectChanges()})).subscribe()}handleCreateFormOpened(){this.selectedItemForEdit=null,this.showCreateForm=!this.showCreateForm}handleEditFormOpened(e){this.selectedItemForEdit=e,this.showCreateForm=!0}handleFormSubmitted(e){this.showCreateForm=!1,this.isLoading=!0;let n;e.id?n=this.updateData(e.id,e):n=this.postData(e),n.pipe(q(()=>{this.isLoading=!1,this.cd.detectChanges()})).subscribe({next:()=>{this.forceFullRefresh()},error:t=>{}})}onCancelForm(){this.showCreateForm=!1,this.selectedItemForEdit=null}trackById(e,n){return n.id}handleViewDetails(e){e.id===void 0||e.id===null||(this.errorMessage=null,this.isLoading=!0,this.getItemDetails(e.id).subscribe({next:n=>{this.selectedItemForDetails=n,this.showDetails=!0,this.isLoading=!1,this.cd.markForCheck()},error:n=>{this.isLoading=!1,this.errorMessage="Nepoda\u0159ilo se na\u010D\xEDst detaily polo\u017Eky.",this.cd.markForCheck()}}))}handleCloseDetails(){this.selectedItemForDetails=null,this.showDetails=!1}static \u0275fac=function(n){return new(n||i)(v(L),v(z),v(xe),v(j),v(X))};static \u0275cmp=E({type:i,selectors:[["app-user-request"]],features:[K],decls:8,vars:7,consts:[[1,"user-request-container","container","mx-auto","p-4"],["class","text-center text-blue-500",4,"ngIf"],["class","text-center text-red-500",4,"ngIf"],[4,"ngIf"],[3,"inputDefinitions","formDataToEdit","formSubmitted","formCanceled",4,"ngIf"],[3,"itemDetailColumns","itemData","closeDetails",4,"ngIf"],[1,"text-center","text-blue-500"],[1,"neutral_button",2,"margin-top","15px",3,"click"],[1,"text-center","text-red-500"],[1,"main-content-layout"],[3,"filtersApplied","filtersCleared","filterColumns","initialFilters","initialSortBy","initialSortDirection"],[1,"table-and-pagination-container"],[3,"buttons","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl","itemDeleted","createFormOpened","editFormOpened","viewDetailsOpened",4,"ngIf"],[3,"data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl","itemRestored",4,"ngIf"],[1,"toggle-table-btn","neutral_button","m-b-10",3,"click"],["class","pagination-controls-wrapper",4,"ngIf"],[3,"itemDeleted","createFormOpened","editFormOpened","viewDetailsOpened","buttons","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl"],[3,"itemRestored","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl"],[1,"pagination-controls-wrapper"],[1,"text-sm","text-gray-700","p-b-10"],[1,"flex","items-center","space-x-2","pg-m","p-b-10"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"items-per-page-select",3,"change","ngModelChange","ngModel"],["value","5"],["value","10"],["value","15"],["value","20"],["value","50"],["aria-label","Pagination",1,"pagination-nav"],[1,"pagination-button","first-page-btn",3,"click","disabled"],[1,"sr-only"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true"],["fill-rule","evenodd","d","M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule","evenodd"],[4,"ngFor","ngForOf"],[1,"pagination-button","last-page-btn",3,"click","disabled"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"pagination-button",3,"click","ngClass"],["for","trashItemsPerPage",1,"text-sm","text-gray-700"],["id","trashItemsPerPage",1,"items-per-page-select",3,"change","ngModelChange","ngModel"],[3,"formSubmitted","formCanceled","inputDefinitions","formDataToEdit"],[3,"closeDetails","itemDetailColumns","itemData"]],template:function(n,t){n&1&&(a(0,"div",0),b(1,ji,2,0,"div",1)(2,qi,3,0,"div",1)(3,Bi,2,1,"div",2)(4,Gi,3,0,"div",2)(5,Ki,10,20,"div",3),s(),b(6,Yi,1,2,"app-generic-form",4)(7,Xi,1,2,"app-generic-details",5)),n&2&&(c(),d("ngIf",t.isLoading),c(),d("ngIf",t.isLoading),c(),d("ngIf",t.errorMessage),c(),d("ngIf",t.errorMessage),c(),d("ngIf",!t.isLoading&&!t.errorMessage),c(),d("ngIf",t.showCreateForm),c(),d("ngIf",t.showDetails))},dependencies:[M,ne,N,F,$,re,ae,oe,U,G,be,Ve,Ae,Ce,ve],styles:[".p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.pagination-nav[_ngcontent-%COMP%]{display:inline-flex;border-radius:.375rem;box-shadow:0 1px 2px #0000000d}.pg-m[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.pagination-button[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:.5rem .75rem;border:1px solid #D1D5DB;background-color:#fff;font-size:.875rem;font-weight:500;color:#4b5563;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,color .15s ease-in-out,box-shadow .15s ease-in-out;cursor:pointer;box-shadow:0 1px 2px #0000000d}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f9fafb;border-color:#a0aec0;box-shadow:0 2px 4px #0000001a}.pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background-color:#f3f4f6}.pagination-button.active-page[_ngcontent-%COMP%]{z-index:10;background-color:#eef2ff;border-color:#6366f1;color:#4f46e5;font-weight:700;cursor:default;box-shadow:0 2px 4px #6366f133}.pagination-button.first-page-btn[_ngcontent-%COMP%]{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.pagination-button.last-page-btn[_ngcontent-%COMP%]{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.pagination-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1.25rem;width:1.25rem;vertical-align:middle;fill:currentColor}.items-per-page-select[_ngcontent-%COMP%]{display:block;width:5rem;border-radius:.375rem;border:1px solid #D1D5DB;box-shadow:0 1px 2px #0000000d;padding:.375rem .75rem;font-size:.875rem;color:#4b5563;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.items-per-page-select[_ngcontent-%COMP%]:focus{border-color:#6366f1;box-shadow:0 0 0 3px #6366f133}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.main-content-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}@media (min-width: 1024px){.main-content-layout[_ngcontent-%COMP%]{flex-direction:row;gap:10px}.filter-form-container[_ngcontent-%COMP%]{width:25%;margin-bottom:0}.table-and-pagination-container[_ngcontent-%COMP%]{flex-grow:1}}.m-b-10[_ngcontent-%COMP%]{margin-bottom:10px}"],changeDetection:0})};var ye=class i{constructor(o,e,n){this.authService=o;this.router=e;this.permissionService=n}canActivate(o,e){return this.authService.isLoggedIn$.pipe(vt(1),de(n=>{if(!n)return console.warn("AuthGuard: U\u017Eivatel nen\xED p\u0159ihl\xE1\u0161en, p\u0159esm\u011Brov\xE1n\xED na login."),this.router.createUrlTree(["/auth/login"]);let t=o.data.permission,r=this.authService.getUserRole();return t&&r?this.permissionService.hasPermission(r,t)?(console.log(`AuthGuard: U\u017Eivatel s rol\xED '${r}' m\xE1 opr\xE1vn\u011Bn\xED '${t}'. P\u0159\xEDstup povolen.`),!0):(console.warn(`AuthGuard: U\u017Eivatel s rol\xED '${r}' nem\xE1 opr\xE1vn\u011Bn\xED '${t}'. P\u0159esm\u011Brov\xE1n\xED na dashboard.`),this.router.createUrlTree(["/admin/dashboard"])):(console.log("AuthGuard: Trasa nevy\u017Eaduje specifick\xE9 opr\xE1vn\u011Bn\xED, p\u0159\xEDstup povolen."),!0)}))}static \u0275fac=function(e){return new(e||i)(B(j),B(X),B(Fe))};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};var an=[{display_name:"Detaily",isActive:!0,type:"info_button",action:"details"},{display_name:"Editovat",isActive:!0,type:"neutral_button",action:"edit"},{display_name:"Nove button",isActive:!1,type:"neutral_button",action:""},{display_name:"Reset Hesla",isActive:!0,type:"neutral_button",action:"password_reset"},{display_name:"Smazat",isActive:!0,type:"delete_button",action:"delete"}],sn=[{column_name:"current_user_id",label:"",placeholder:"",type:"hidden",required:!1,pattern:"",errorMessage:"",editable:!1,show_in_edit:!0,show_in_create:!1,hide_in_edit:!1},{column_name:"target_user_id",label:"",placeholder:"",type:"hidden",required:!1,pattern:"",errorMessage:"",editable:!1,show_in_edit:!0,show_in_create:!1,hide_in_edit:!1},{column_name:"old_password",label:"Heslo aktu\xE1ln\u011B p\u0159ihl\xE1\u0161en\xE9ho u\u017Eivatele",placeholder:"Zadejte Heslo aktu\xE1ln\u011B p\u0159ihl\xE1\u0161en\xE9ho u\u017Eivate",type:"password",required:!0,pattern:"",errorMessage:"spatny format",editable:!0,show_in_edit:!0,show_in_create:!0,hide_in_edit:!0},{column_name:"new_password",label:"Nov\xE9 heslo vybran\xE9ho u\u017Eivatele",placeholder:"Zadejte nov\xE9 heslo u\u017Eivatele",type:"password",required:!0,pattern:"^.{8,}$",errorMessage:"Heslo musi mit 8 a vice znaku",editable:!0,show_in_edit:!0,show_in_create:!0,hide_in_edit:!0},{column_name:"new_password_confirmation",label:"Potvrzen\xED nov\xE9ho hesla vybran\xE9ho u\u017Eivatele",placeholder:"Zadejte potvrzen\xED nov\xE9ho hesla vybran\xE9ho u\u017Eivatele",type:"password",required:!0,pattern:"^.{8,}$",errorMessage:"Heslo musi mit 8 a vice znaku",editable:!0,show_in_edit:!0,show_in_create:!0,hide_in_edit:!0}],ln=[{column_name:"user_email",label:"P\u0159ihla\u0161ovaci email",placeholder:"Zadejte Email",type:"text",required:!0,pattern:"[^@]+@[^@]+\\.[^@]+",errorMessage:"spatny format",editable:!0,show_in_edit:!0,show_in_create:!0},{column_name:"user_password_hash",label:"Heslo",placeholder:"Zadejte heslo",type:"password",required:!0,pattern:"^.{8,}$",errorMessage:"Zadejte heslo minimalne 8 znaku",editable:!0,show_in_edit:!1,show_in_create:!0},{column_name:"role_id",label:"Role",placeholder:"",type:"select",options:[{value:"1",label:"sysadmin"},{value:"2",label:"admin"}],required:!0,errorMessage:"Pole je povinn\xE9.",editable:!0,show_in_edit:!0,show_in_create:!0}],cn=["Nov\u011B zadan\xE9","Zpracov\xE1v\xE1 se","Dokon\u010Deno","Zru\u0161eno"],dn=["N\xEDzk\xE1","Neutr\xE1ln\xED","Vysok\xE1"],pn=[{key:"id",header:"ID",type:"text"},{key:"user_email",header:"Email",type:"text"},{key:"last_login_at",header:"Naposled p\u0159ihl\xE1\u0161en",type:"date",format:"short"},{key:"created_at",header:"Vytvo\u0159en",type:"date",format:"short"},{key:"updated_at",header:"Zm\u011Bn\u011Bn",type:"date",format:"short"},{key:"roles.0.role_name",header:"Role",type:"text"}],mn=[{key:"id",header:"ID",type:"text"},{key:"user_email",header:"Email",type:"text"},{key:"last_login_at",header:"Naposled p\u0159ihl\xE1\u0161en",type:"date",format:"short"},{key:"created_at",header:"Vytvo\u0159en",type:"date",format:"short"},{key:"updated_at",header:"Zm\u011Bn\u011Bn",type:"date",format:"short"},{key:"roles.0.role_name",header:"Role",type:"text"},{key:"deleted_at",header:"Smaz\xE1no",type:"date",format:"short"}],un=[{key:"user_login_id",header:"ID",type:"text",placeholder:"Hledat podle ID",canSort:!0},{key:"user_email",header:"Email",type:"text",placeholder:"Hledat podle emailu",canSort:!0},{key:"last_login_at",header:"Naposled p\u0159ihl\xE1\u0161en",type:"text",placeholder:"Filtrovat podle posledn\xEDho p\u0159ihl\xE1\u0161en\xED",canSort:!0},{key:"created_at",header:"Vytvo\u0159en",type:"text",placeholder:"Filtrovat podle data vytvo\u0159en\xED",canSort:!0},{key:"updated_at",header:"Zm\u011Bn\u011Bn",type:"text",placeholder:"Filtrovat podle data zm\u011Bny",canSort:!0},{key:"role_name",header:"Role",type:"text",placeholder:"Hledat podle role",canSort:!0}],gn=[{key:"id",displayName:"ID",type:"text"},{key:"user_email",displayName:"Email",type:"text"},{key:"last_login_at",displayName:"Naposled p\u0159ihl\xE1\u0161en",type:"date",format:"medium"},{key:"created_at",displayName:"Vytvo\u0159en",type:"date",format:"medium"},{key:"updated_at",displayName:"Zm\u011Bn\u011Bn",type:"date",format:"medium"},{key:"roles.0.role_name",displayName:"Role",type:"text"}];var eo=(i,o,e,n,t,r)=>({user_login_id:i,user_email:o,last_login_at:e,created_at:n,updated_at:t,role_name:r}),_n=i=>({"active-page":i});function to(i,o){i&1&&(a(0,"div",7),p(1,"Na\u010D\xEDt\xE1n\xED dat..."),s())}function no(i,o){if(i&1){let e=C();a(0,"div",7)(1,"button",8),h("click",function(){u(e);let t=l();return g(t.refreshData())}),p(2," Znovu na\u010D\xEDst data "),s()()}}function io(i,o){if(i&1&&(a(0,"div",9),p(1),s()),i&2){let e=l();c(),k(e.errorMessage)}}function oo(i,o){if(i&1){let e=C();a(0,"div",9)(1,"button",8),h("click",function(){u(e);let t=l();return g(t.refreshData())}),p(2," Znovu na\u010D\xEDst data "),s()()}}function ro(i,o){if(i&1){let e=C();a(0,"app-generic-table",17),h("itemDeleted",function(){u(e);let t=l(2);return g(t.handleItemDeleted())})("createFormOpened",function(){u(e);let t=l(2);return g(t.handleCreateFormOpened())})("editFormOpened",function(t){u(e);let r=l(2);return g(r.handleEditFormOpened(t))})("viewDetailsOpened",function(t){u(e);let r=l(2);return g(r.handleViewDetails(t))})("resetPasswordFormOpened",function(t){u(e);let r=l(2);return g(r.handleResetPasswordFormOpened(t))}),s()}if(i&2){let e=l(2);d("buttons",e.buttons)("data",e.data)("columns",e.tableColumns)("tableCaption","Seznam po\u017Eadavk\u016F na provize")("isLoading",e.isLoading)("apiEndpoint",e.apiEndpoint)("uploadsBaseUrl","https://your-upload-domain.com/uploads/")}}function ao(i,o){if(i&1){let e=C();a(0,"app-generic-trash-table",18),h("itemRestored",function(){u(e);let t=l(2);return g(t.handleItemRestored())}),s()}if(i&2){let e=l(2);d("data",e.trashData)("columns",e.trashTableColumns)("tableCaption","Obnova dat")("isLoading",e.isLoading)("apiEndpoint",e.apiEndpoint)("uploadsBaseUrl","https://your-upload-domain.com/uploads/")}}function so(i,o){if(i&1){let e=C();y(0),a(1,"button",37),h("click",function(){let t=u(e).$implicit,r=l(3);return g(r.goToPage(t))}),p(2),s(),w()}if(i&2){let e=o.$implicit,n=l(3);c(),d("ngClass",Y(2,_n,e===n.currentPage)),c(),x(" ",e," ")}}function lo(i,o){if(i&1){let e=C();a(0,"div",19)(1,"div",20),p(2),s(),a(3,"div",21)(4,"label",22),p(5,"Polo\u017Eek na str\xE1nku:"),s(),a(6,"select",23),h("change",function(t){u(e);let r=l(2);return g(r.onItemsPerPageChange(t))}),D("ngModelChange",function(t){u(e);let r=l(2);return S(r.itemsPerPage,t)||(r.itemsPerPage=t),g(t)}),a(7,"option",24),p(8,"5"),s(),a(9,"option",25),p(10,"10"),s(),a(11,"option",26),p(12,"15"),s(),a(13,"option",27),p(14,"20"),s(),a(15,"option",28),p(16,"50"),s()()(),a(17,"nav",29)(18,"button",30),h("click",function(){u(e);let t=l(2);return g(t.goToPage(t.currentPage-1))}),a(19,"span",31),p(20,"P\u0159edchoz\xED"),s(),Z(),a(21,"svg",32),O(22,"path",33),s()(),b(23,so,3,4,"ng-container",34),ue(),a(24,"button",35),h("click",function(){u(e);let t=l(2);return g(t.goToPage(t.currentPage+1))}),a(25,"span",31),p(26,"Dal\u0161\xED"),s(),Z(),a(27,"svg",32),O(28,"path",36),s()()()()}if(i&2){let e=l(2);c(2),_e(" Zobrazuji ",(e.currentPage-1)*e.itemsPerPage+1," - ",(e.currentPage-1)*e.itemsPerPage+e.data.length," z celkem ",e.totalItems," z\xE1znam\u016F. "),c(4),P("ngModel",e.itemsPerPage),c(12),d("disabled",e.currentPage===1),c(5),d("ngForOf",e.pagesArray),c(),d("disabled",e.currentPage===e.totalPages)}}function co(i,o){if(i&1){let e=C();y(0),a(1,"button",37),h("click",function(){let t=u(e).$implicit,r=l(3);return g(r.goToTrashPage(t))}),p(2),s(),w()}if(i&2){let e=o.$implicit,n=l(3);c(),d("ngClass",Y(2,_n,e===n.trashCurrentPage)),c(),x(" ",e," ")}}function po(i,o){if(i&1){let e=C();a(0,"div",19)(1,"div",20),p(2),s(),a(3,"div",21)(4,"label",38),p(5,"Polo\u017Eek na str\xE1nku:"),s(),a(6,"select",39),h("change",function(t){u(e);let r=l(2);return g(r.onTrashItemsPerPageChange(t))}),D("ngModelChange",function(t){u(e);let r=l(2);return S(r.trashItemsPerPage,t)||(r.trashItemsPerPage=t),g(t)}),a(7,"option",24),p(8,"5"),s(),a(9,"option",25),p(10,"10"),s(),a(11,"option",26),p(12,"15"),s(),a(13,"option",27),p(14,"20"),s(),a(15,"option",28),p(16,"50"),s()()(),a(17,"nav",29)(18,"button",30),h("click",function(){u(e);let t=l(2);return g(t.goToTrashPage(t.trashCurrentPage-1))}),a(19,"span",31),p(20,"P\u0159edchoz\xED"),s(),Z(),a(21,"svg",32),O(22,"path",33),s()(),b(23,co,3,4,"ng-container",34),ue(),a(24,"button",35),h("click",function(){u(e);let t=l(2);return g(t.goToTrashPage(t.trashCurrentPage+1))}),a(25,"span",31),p(26,"Dal\u0161\xED"),s(),Z(),a(27,"svg",32),O(28,"path",36),s()()()()}if(i&2){let e=l(2);c(2),_e(" Zobrazuji ",(e.trashCurrentPage-1)*e.trashItemsPerPage+1," - ",(e.trashCurrentPage-1)*e.trashItemsPerPage+e.trashData.length," z celkem ",e.trashTotalItems," z\xE1znam\u016F. "),c(4),P("ngModel",e.trashItemsPerPage),c(12),d("disabled",e.trashCurrentPage===1),c(5),d("ngForOf",e.trashPagesArray),c(),d("disabled",e.trashCurrentPage===e.trashTotalPages)}}function mo(i,o){if(i&1){let e=C();a(0,"div")(1,"div",10)(2,"app-generic-filter-form",11),h("filtersApplied",function(t){u(e);let r=l();return g(r.applyFilters(t))})("filtersCleared",function(){u(e);let t=l();return g(t.clearFilters())}),s(),a(3,"div",12),b(4,ro,1,7,"app-generic-table",13)(5,ao,1,6,"app-generic-trash-table",14),a(6,"button",15),h("click",function(){u(e);let t=l();return g(t.toggleTable())}),p(7),s(),b(8,lo,29,7,"div",16)(9,po,29,7,"div",16),s()()()}if(i&2){let e=l();c(2),d("filterColumns",e.filterColumns)("initialFilters",Et(9,eo,e.filterUserLoginId,e.filterUserEmail,e.filterLastLoginAt,e.filterCreatedAt,e.filterUpdatedAt,e.filterRoleName))("initialSortBy",e.filterSortBy)("initialSortDirection",e.filterSortDirection),c(2),d("ngIf",!e.showTrashTable),c(),d("ngIf",e.showTrashTable),c(2),x(" ",e.showTrashTable?"Zobrazit Aktivn\xED Po\u017Eadavky":"Zobrazit Smazan\xE9 Po\u017Eadavky"," "),c(),d("ngIf",!e.showTrashTable),c(),d("ngIf",e.showTrashTable)}}function uo(i,o){if(i&1){let e=C();a(0,"app-generic-form",40),h("formSubmitted",function(t){u(e);let r=l();return g(r.handleFormSubmitted(t))})("formCanceled",function(){u(e);let t=l();return g(t.onCancelForm())}),s()}if(i&2){let e=l();d("inputDefinitions",e.formFields)("formDataToEdit",e.selectedItemForEdit)}}function go(i,o){if(i&1){let e=C();a(0,"app-generic-form",41),h("formSubmitted",function(t){u(e);let r=l();return g(r.handleResetPasswordFormSubmitted(t))})("formCanceled",function(){u(e);let t=l();return g(t.handleResetPasswordFormClosed())}),s()}if(i&2){let e=l();d("inputDefinitions",e.resetPasswordFormFields)("formDataToEdit",e.selectedItemForEdit)("passwordReset",!0)}}function _o(i,o){if(i&1){let e=C();a(0,"app-generic-details",42),h("closeDetails",function(){u(e);let t=l();return g(t.handleCloseDetails())}),s()}if(i&2){let e=l();d("itemDetailColumns",e.detailsColumns)("itemData",e.selectedItemForDetails)}}var at=class i extends H{constructor(e,n,t,r,m){super(e,n);this.dataHandler=e;this.cd=n;this.genericTableService=t;this.authService=r;this.router=m}apiEndpoint="user_login";trashData=[];isLoading=!1;isTrashTableLoading=!1;errorMessage=null;showResetPasswordForm=!1;buttons=an;formFields=ln;resetPasswordFormFields=sn;tableColumns=pn;trashTableColumns=mn;statusOptions=cn;priorityOptions=dn;filterColumns=un;detailsColumns=gn;filterFormFields=[];showTrashTable=!1;showCreateForm=!1;currentPage=1;itemsPerPage=15;totalItems=0;totalPages=0;showDetails=!1;selectedItemForDetails=null;trashCurrentPage=1;trashItemsPerPage=15;trashTotalItems=0;trashTotalPages=0;filterUserLoginId="";filterUserEmail="";filterLastLoginAt="";filterCreatedAt="";filterUpdatedAt="";filterRoleName="";filterSortBy="";filterSortDirection="asc";activeRequestsCache=new Map;trashRequestsCache=new Map;currentActiveFilters={};currentTrashFilters={};selectedItemForEdit=null;ngOnInit(){super.ngOnInit(),this.authService.isLoggedIn$.subscribe(e=>{e?this.forceFullRefresh():this.router.navigate(["/auth/login"])})}refreshData(){this.forceFullRefresh()}getBaseFilters(){let e={user_login_id:this.filterUserLoginId,user_email:this.filterUserEmail,last_login_at:this.filterLastLoginAt,created_at:this.filterCreatedAt,updated_at:this.filterUpdatedAt,sort_by:this.filterSortBy,sort_direction:this.filterSortDirection};return this.filterRoleName&&(e.role_name=this.filterRoleName),e}fetchPaginatedData(e,n,t,r,m){this.errorMessage=null;let _=this.getBaseFilters();if(e?_.only_trashed="true":_.is_deleted="false",console.log("Sending filters to backend:",_),JSON.stringify(_)!==JSON.stringify(m)&&(r.clear(),e?(this.trashCurrentPage=1,this.currentTrashFilters=_):(this.currentPage=1,this.currentActiveFilters=_)),r.has(n)){let f=r.get(n);return e?this.trashData=f:this.data=f,this.cd.detectChanges(),this.preloadPage(e,n+1,t,r),De({data:f,current_page:n,last_page:e?this.trashTotalPages:this.totalPages,total:e?this.trashTotalItems:this.totalItems})}return this.genericTableService.getPaginatedData(this.apiEndpoint,n,t,_).pipe(Te(1),pe(f=>{e?(this.trashData=f.data,this.trashTotalItems=f.total,this.trashTotalPages=f.last_page,this.trashCurrentPage=f.current_page):(this.data=f.data,this.totalItems=f.total,this.totalPages=f.last_page,this.currentPage=f.current_page),r.set(n,f.data),this.cd.detectChanges(),this.preloadPage(e,n+1,t,r)}))}preloadPage(e,n,t,r){let m=e?this.trashTotalPages:this.totalPages;if(n>m||r.has(n))return;let _=this.getBaseFilters();e?_.only_trashed="true":_.is_deleted="false",this.genericTableService.getPaginatedData(this.apiEndpoint,n,t,_).subscribe({next:f=>{r.set(n,f.data)},error:f=>{}})}loadActiveRequests(){return this.fetchPaginatedData(!1,this.currentPage,this.itemsPerPage,this.activeRequestsCache,this.currentActiveFilters)}loadTrashRequests(){return this.fetchPaginatedData(!0,this.trashCurrentPage,this.trashItemsPerPage,this.trashRequestsCache,this.currentTrashFilters)}toggleTable(){this.showTrashTable=!this.showTrashTable,this.forceFullRefresh()}applyFilters(e){this.filterUserLoginId=e.user_login_id||"",this.filterUserEmail=e.user_email||"",this.filterLastLoginAt=e.last_login_at||"",this.filterCreatedAt=e.created_at||"",this.filterUpdatedAt=e.updated_at||"",this.filterRoleName=e.role_name||"",this.filterSortBy=e.sort_by||"",this.filterSortDirection=e.sort_direction||"asc",this.forceFullRefresh()}clearFilters(){this.filterUserLoginId="",this.filterUserEmail="",this.filterLastLoginAt="",this.filterCreatedAt="",this.filterUpdatedAt="",this.filterRoleName="",this.filterSortBy="",this.filterSortDirection="asc",this.forceFullRefresh()}goToPage(e){e>=1&&e<=this.totalPages&&e!==this.currentPage&&(this.currentPage=e,this.loadActiveRequests().subscribe())}goToTrashPage(e){e>=1&&e<=this.trashTotalPages&&e!==this.trashCurrentPage&&(this.trashCurrentPage=e,this.loadTrashRequests().subscribe())}onItemsPerPageChange(e){let n=e.target,t=Number(n.value);t!==this.itemsPerPage&&(this.itemsPerPage=t,this.forceFullRefresh())}onTrashItemsPerPageChange(e){let n=e.target,t=Number(n.value);t!==this.trashItemsPerPage&&(this.trashItemsPerPage=t,this.forceFullRefresh())}getPaginationArray(e,n){let r=Math.max(1,e-Math.floor(2.5)),m=Math.min(n,r+5-1);m-r+1<5&&(r=Math.max(1,m-5+1));let _=[];for(let f=r;f<=m;f++)_.push(f);return _}get pagesArray(){return this.getPaginationArray(this.currentPage,this.totalPages)}get trashPagesArray(){return this.getPaginationArray(this.trashCurrentPage,this.trashTotalPages)}handleItemRestored(){this.forceFullRefresh()}handleItemDeleted(){this.forceFullRefresh()}forceFullRefresh(){this.activeRequestsCache.clear(),this.trashRequestsCache.clear(),this.currentPage=1,this.trashCurrentPage=1,this.isLoading=!0,this.isTrashTableLoading=!0,this.cd.detectChanges(),je([this.loadActiveRequests(),this.loadTrashRequests()]).pipe(q(()=>{this.isLoading=!1,this.isTrashTableLoading=!1,this.cd.detectChanges()})).subscribe()}handleCreateFormOpened(){this.selectedItemForEdit=null,this.showCreateForm=!this.showCreateForm}handleEditFormOpened(e){let n=W({},e);n.roles&&n.roles.length>0&&(n.role_id=n.roles[0].role_id),this.selectedItemForEdit=n,this.showCreateForm=!0}handleFormSubmitted(e){this.showCreateForm=!1,this.isLoading=!0;let n;e.id?n=this.updateData(e.id,e):n=this.postData(e),n.pipe(q(()=>{this.isLoading=!1,this.cd.detectChanges()})).subscribe({next:()=>{this.forceFullRefresh()},error:t=>{}})}onCancelForm(){this.showCreateForm=!1,this.selectedItemForEdit=null}trackById(e,n){return n.id}handleViewDetails(e){e.id===void 0||e.id===null||(this.errorMessage=null,this.isLoading=!0,this.getItemDetails(e.id).subscribe({next:n=>{this.selectedItemForDetails=n,this.showDetails=!0,this.isLoading=!1,this.cd.markForCheck()},error:n=>{this.isLoading=!1,this.errorMessage="Nepoda\u0159ilo se na\u010D\xEDst detaily polo\u017Eky.",this.cd.markForCheck()}}))}handleCloseDetails(){this.selectedItemForDetails=null,this.showDetails=!1}handleResetPasswordFormOpened(e){this.showResetPasswordForm=!0;let n=W({},e);n.target_user_id=n.id,n.current_user_id=this.authService.getUserId(),this.selectedItemForEdit=n}handleResetPasswordFormSubmitted(e){if(!e.target_user_id||!e.current_user_id){console.error("ID c\xEDlov\xE9ho nebo aktu\xE1ln\xEDho u\u017Eivatele chyb\xED."),this.handleResetPasswordFormClosed();return}let n={old_password:e.old_password,new_password:e.new_password,new_password_confirmation:e.new_password_confirmation,current_user_id:parseInt(e.current_user_id,10),target_user_id:e.target_user_id};console.log("Odes\xEDlan\xE1 data pro zm\u011Bnu hesla:",n),this.updatePassword(n.target_user_id,n).pipe(q(()=>{this.handleResetPasswordFormClosed()})).subscribe({next:t=>{console.log("Heslo bylo \xFAsp\u011B\u0161n\u011B zm\u011Bn\u011Bno.",t),this.forceFullRefresh()},error:t=>{console.error("Chyba p\u0159i zm\u011Bn\u011B hesla:",t),this.errorMessage=t.message||"Chyba p\u0159i zm\u011Bn\u011B hesla. Zkuste to pros\xEDm znovu.",this.cd.markForCheck()}})}handleResetPasswordFormClosed(){this.showResetPasswordForm=!1}static \u0275fac=function(n){return new(n||i)(v(L),v(z),v(xe),v(j),v(X))};static \u0275cmp=E({type:i,selectors:[["app-administrators"]],features:[K],decls:9,vars:8,consts:[[1,"user-request-container","container","mx-auto","p-4"],["class","text-center text-blue-500",4,"ngIf"],["class","text-center text-red-500",4,"ngIf"],[4,"ngIf"],[3,"inputDefinitions","formDataToEdit","formSubmitted","formCanceled",4,"ngIf"],[3,"inputDefinitions","formDataToEdit","passwordReset","formSubmitted","formCanceled",4,"ngIf"],[3,"itemDetailColumns","itemData","closeDetails",4,"ngIf"],[1,"text-center","text-blue-500"],[1,"neutral_button",2,"margin-top","15px",3,"click"],[1,"text-center","text-red-500"],[1,"main-content-layout"],[3,"filtersApplied","filtersCleared","filterColumns","initialFilters","initialSortBy","initialSortDirection"],[1,"table-and-pagination-container"],[3,"buttons","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl","itemDeleted","createFormOpened","editFormOpened","viewDetailsOpened","resetPasswordFormOpened",4,"ngIf"],[3,"data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl","itemRestored",4,"ngIf"],[1,"toggle-table-btn","neutral_button","m-b-10",3,"click"],["class","pagination-controls-wrapper",4,"ngIf"],[3,"itemDeleted","createFormOpened","editFormOpened","viewDetailsOpened","resetPasswordFormOpened","buttons","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl"],[3,"itemRestored","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl"],[1,"pagination-controls-wrapper"],[1,"text-sm","text-gray-700","p-b-10"],[1,"flex","items-center","space-x-2","pg-m","p-b-10"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"items-per-page-select",3,"change","ngModelChange","ngModel"],["value","5"],["value","10"],["value","15"],["value","20"],["value","50"],["aria-label","Pagination",1,"pagination-nav"],[1,"pagination-button","first-page-btn",3,"click","disabled"],[1,"sr-only"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true"],["fill-rule","evenodd","d","M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule","evenodd"],[4,"ngFor","ngForOf"],[1,"pagination-button","last-page-btn",3,"click","disabled"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"pagination-button",3,"click","ngClass"],["for","trashItemsPerPage",1,"text-sm","text-gray-700"],["id","trashItemsPerPage",1,"items-per-page-select",3,"change","ngModelChange","ngModel"],[3,"formSubmitted","formCanceled","inputDefinitions","formDataToEdit"],[3,"formSubmitted","formCanceled","inputDefinitions","formDataToEdit","passwordReset"],[3,"closeDetails","itemDetailColumns","itemData"]],template:function(n,t){n&1&&(a(0,"div",0),b(1,to,2,0,"div",1)(2,no,3,0,"div",1)(3,io,2,1,"div",2)(4,oo,3,0,"div",2)(5,mo,10,16,"div",3),s(),b(6,uo,1,2,"app-generic-form",4)(7,go,1,3,"app-generic-form",5)(8,_o,1,2,"app-generic-details",6)),n&2&&(c(),d("ngIf",t.isLoading),c(),d("ngIf",t.isLoading),c(),d("ngIf",t.errorMessage),c(),d("ngIf",t.errorMessage),c(),d("ngIf",!t.isLoading&&!t.errorMessage),c(),d("ngIf",t.showCreateForm),c(),d("ngIf",t.showResetPasswordForm),c(),d("ngIf",t.showDetails))},dependencies:[M,ne,N,F,$,re,ae,oe,U,G,be,Ve,Ae,Ce,ve],styles:[".p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.pagination-nav[_ngcontent-%COMP%]{display:inline-flex;border-radius:.375rem;box-shadow:0 1px 2px #0000000d}.pg-m[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.pagination-button[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:.5rem .75rem;border:1px solid #D1D5DB;background-color:#fff;font-size:.875rem;font-weight:500;color:#4b5563;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,color .15s ease-in-out,box-shadow .15s ease-in-out;cursor:pointer;box-shadow:0 1px 2px #0000000d}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f9fafb;border-color:#a0aec0;box-shadow:0 2px 4px #0000001a}.pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background-color:#f3f4f6}.pagination-button.active-page[_ngcontent-%COMP%]{z-index:10;background-color:#eef2ff;border-color:#6366f1;color:#4f46e5;font-weight:700;cursor:default;box-shadow:0 2px 4px #6366f133}.pagination-button.first-page-btn[_ngcontent-%COMP%]{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.pagination-button.last-page-btn[_ngcontent-%COMP%]{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.pagination-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1.25rem;width:1.25rem;vertical-align:middle;fill:currentColor}.items-per-page-select[_ngcontent-%COMP%]{display:block;width:5rem;border-radius:.375rem;border:1px solid #D1D5DB;box-shadow:0 1px 2px #0000000d;padding:.375rem .75rem;font-size:.875rem;color:#4b5563;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.items-per-page-select[_ngcontent-%COMP%]:focus{border-color:#6366f1;box-shadow:0 0 0 3px #6366f133}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.main-content-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}@media (min-width: 1024px){.main-content-layout[_ngcontent-%COMP%]{flex-direction:row;gap:10px}.filter-form-container[_ngcontent-%COMP%]{width:25%;margin-bottom:0}.table-and-pagination-container[_ngcontent-%COMP%]{flex-grow:1}}.m-b-10[_ngcontent-%COMP%]{margin-bottom:10px}"],changeDetection:0})};var fn=[{display_name:"Detaily",isActive:!0,type:"info_button",action:"details"},{display_name:"Editovat",isActive:!1,type:"neutral_button",action:""},{display_name:"Nove button",isActive:!1,type:"neutral_button",action:""},{display_name:"Smazat",isActive:!1,type:"delete_button",action:""}];var hn=[{key:"business_log_id",header:"ID",type:"text"},{key:"created_at",header:"Vytvo\u0159en",type:"date",format:"short"},{key:"origin",header:"IP zdroje",type:"text"},{key:"event_type",header:"Ud\xE1lost",type:"text"},{key:"module",header:"Modul",type:"text"},{key:"description",header:"Popis",type:"text"},{key:"affected_entity_type",header:"Ovlivn\u011Bn\xE1 Entita",type:"text"},{key:"affected_entity_id",header:"ID Ovlivn\u011Bn\xE1 Entita",type:"text"},{key:"user_login_id",header:"ID u\u017Eivatele",type:"text"},{key:"user.user_email",header:"U\u017Eivatel",type:"text"},{key:"context_data",header:"Dopl\u0148uj\xEDc\xED data",type:"text"}],bn=[{key:"business_log_id",header:"ID",type:"text",placeholder:"Hledat podle ID",canSort:!0},{key:"created_at",header:"Vytvo\u0159en",type:"text",placeholder:"Filtrovat podle data vytvo\u0159en\xED",canSort:!0},{key:"origin",header:"IP zdroje",type:"text",placeholder:"Hledat podle IP zdroje",canSort:!0},{key:"event_type",header:"Ud\xE1lost",type:"select",options:["create","update","soft_delete","hard_delete","restore"],placeholder:"-- Vybrat prioritu --",canSort:!0},{key:"module",header:"Modul",type:"text",placeholder:"Hledat podle modulu",canSort:!0},{key:"description",header:"Popis",type:"text",placeholder:"Hledat podle popisu",canSort:!0},{key:"affected_entity_type",header:"Ovlivn\u011Bn\xE1 Entita",type:"text",placeholder:"Hledat podle ovlivn\u011Bn\xE9 entity",canSort:!0},{key:"affected_entity_id",header:"ID Ovlivn\u011Bn\xE1 Entita",type:"text",placeholder:"Hledat podle ID ovlivn\u011Bn\xE9 entity",canSort:!0},{key:"user_login_id",header:"ID u\u017Eivatele",type:"text",placeholder:"Hledat podle ID u\u017Eivatele",canSort:!0},{key:"user.user_email",header:"U\u017Eivatel",type:"text",placeholder:"Hledat podle u\u017Eivatele",canSort:!0},{key:"context_data",header:"Dopl\u0148uj\xEDc\xED data",type:"text",placeholder:"Hledat podle dopl\u0148uj\xEDc\xEDch dat",canSort:!0}],Cn=[{key:"business_log_id",displayName:"ID",type:"text"},{key:"created_at",displayName:"Vytvo\u0159en",type:"date",format:"medium"},{key:"origin",displayName:"IP zdroje",type:"text"},{key:"event_type",displayName:"Ud\xE1lost",type:"text"},{key:"module",displayName:"Modul",type:"text"},{key:"description",displayName:"Popis",type:"text"},{key:"affected_entity_type",displayName:"Ovlivn\u011Bn\xE1 Entita",type:"text"},{key:"affected_entity_id",displayName:"ID Ovlivn\u011Bn\xE1 Entita",type:"text"},{key:"user.user_login_id",displayName:"ID u\u017Eivatele",type:"text"},{key:"user.user_email",displayName:"U\u017Eivatel",type:"text"},{key:"context_data",displayName:"Dopl\u0148uj\xEDc\xED data",type:"text"}];var fo=(i,o,e,n,t,r,m,_,f,T,te)=>({business_log_id:i,created_at:o,origin:e,event_type:n,module:t,description:r,affected_entity_type:m,affected_entity_id:_,user_login_id:f,"user.user_email":T,context_data:te}),ho=i=>({"active-page":i});function bo(i,o){i&1&&(a(0,"div",5),p(1,"Na\u010D\xEDt\xE1n\xED dat..."),s())}function Co(i,o){if(i&1){let e=C();a(0,"div",5)(1,"button",6),h("click",function(){u(e);let t=l();return g(t.refreshData())}),p(2," Znovu na\u010D\xEDst data "),s()()}}function vo(i,o){if(i&1&&(a(0,"div",7),p(1),s()),i&2){let e=l();c(),k(e.errorMessage)}}function xo(i,o){if(i&1){let e=C();a(0,"div",7)(1,"button",6),h("click",function(){u(e);let t=l();return g(t.refreshData())}),p(2," Znovu na\u010D\xEDst data "),s()()}}function yo(i,o){if(i&1){let e=C();y(0),a(1,"button",30),h("click",function(){let t=u(e).$implicit,r=l(2);return g(r.goToPage(t))}),p(2),s(),w()}if(i&2){let e=o.$implicit,n=l(2);c(),d("ngClass",Y(2,ho,e===n.currentPage)),c(),x(" ",e," ")}}function wo(i,o){if(i&1){let e=C();a(0,"div")(1,"div",8)(2,"app-generic-filter-form",9),h("filtersApplied",function(t){u(e);let r=l();return g(r.applyFilters(t))})("filtersCleared",function(){u(e);let t=l();return g(t.clearFilters())}),s(),a(3,"div",10)(4,"app-generic-table",11),h("itemDeleted",function(){u(e);let t=l();return g(t.handleItemDeleted())})("createFormOpened",function(){u(e);let t=l();return g(t.handleCreateFormOpened())})("editFormOpened",function(t){u(e);let r=l();return g(r.handleEditFormOpened(t))})("viewDetailsOpened",function(t){u(e);let r=l();return g(r.handleViewDetails(t))}),s(),a(5,"div",12)(6,"div",13),p(7),s(),a(8,"div",14)(9,"label",15),p(10,"Polo\u017Eek na str\xE1nku:"),s(),a(11,"select",16),h("change",function(t){u(e);let r=l();return g(r.onItemsPerPageChange(t))}),D("ngModelChange",function(t){u(e);let r=l();return S(r.itemsPerPage,t)||(r.itemsPerPage=t),g(t)}),a(12,"option",17),p(13,"5"),s(),a(14,"option",18),p(15,"10"),s(),a(16,"option",19),p(17,"15"),s(),a(18,"option",20),p(19,"20"),s(),a(20,"option",21),p(21,"50"),s()()(),a(22,"nav",22)(23,"button",23),h("click",function(){u(e);let t=l();return g(t.goToPage(t.currentPage-1))}),a(24,"span",24),p(25,"P\u0159edchoz\xED"),s(),Z(),a(26,"svg",25),O(27,"path",26),s()(),b(28,yo,3,4,"ng-container",27),ue(),a(29,"button",28),h("click",function(){u(e);let t=l();return g(t.goToPage(t.currentPage+1))}),a(30,"span",24),p(31,"Dal\u0161\xED"),s(),Z(),a(32,"svg",25),O(33,"path",29),s()()()()()()()}if(i&2){let e=l();c(2),d("filterColumns",e.filterColumns)("initialFilters",We(19,fo,[e.filterBusinessLogId,e.filterCreatedAt,e.filterOrigin,e.filterEventType,e.filterModule,e.filterDescription,e.filterAffectedEntityType,e.filterAffectedEntityId,e.filterUserLoginId,e.filterUserEmail,e.filterContextData]))("initialSortBy",e.filterSortBy)("initialSortDirection",e.filterSortDirection),c(2),d("buttons",e.buttons)("data",e.data)("columns",e.tableColumns)("tableCaption","Seznam ud\xE1lost\xED syst\xE9mu")("isLoading",e.isLoading)("apiEndpoint",e.apiEndpoint)("uploadsBaseUrl","[https://your-upload-domain.com/uploads/](https://your-upload-domain.com/uploads/)")("isLogsTable",!0),c(3),_e(" Zobrazuji ",(e.currentPage-1)*e.itemsPerPage+1," - ",(e.currentPage-1)*e.itemsPerPage+e.data.length," z celkem ",e.totalItems," z\xE1znam\u016F. "),c(4),P("ngModel",e.itemsPerPage),c(12),d("disabled",e.currentPage===1),c(5),d("ngForOf",e.pagesArray),c(),d("disabled",e.currentPage===e.totalPages)}}function Po(i,o){if(i&1){let e=C();a(0,"app-generic-details",31),h("closeDetails",function(){u(e);let t=l();return g(t.handleCloseDetails())}),s()}if(i&2){let e=l();d("itemDetailColumns",e.detailsColumns)("itemData",e.selectedItemForDetails)}}var st=class i extends H{constructor(e,n,t,r,m){super(e,n);this.dataHandler=e;this.cd=n;this.genericTableService=t;this.authService=r;this.router=m}apiEndpoint="business_logs";isLoading=!1;errorMessage=null;buttons=fn;tableColumns=hn;filterColumns=bn;detailsColumns=Cn;showCreateForm=!1;currentPage=1;itemsPerPage=15;totalItems=0;totalPages=0;showDetails=!1;selectedItemForDetails=null;filterBusinessLogId="";filterCreatedAt="";filterOrigin="";filterEventType="";filterModule="";filterDescription="";filterAffectedEntityType="";filterAffectedEntityId="";filterUserLoginId="";filterUserEmail="";filterContextData="";filterSortBy="";filterSortDirection="asc";activeRequestsCache=new Map;currentActiveFilters={};selectedItemForEdit=null;ngOnInit(){super.ngOnInit(),this.authService.isLoggedIn$.subscribe(e=>{e?this.forceFullRefresh():this.router.navigate(["/auth/login"])})}refreshData(){this.forceFullRefresh()}getBaseFilters(){return{business_log_id:this.filterBusinessLogId,created_at:this.filterCreatedAt,origin:this.filterOrigin,event_type:this.filterEventType,module:this.filterModule,description:this.filterDescription,affected_entity_type:this.filterAffectedEntityType,affected_entity_id:this.filterAffectedEntityId,user_login_id:this.filterUserLoginId,user_email:this.filterUserEmail,context_data:this.filterContextData,sort_by:this.filterSortBy,sort_direction:this.filterSortDirection}}fetchPaginatedData(e,n,t,r){this.errorMessage=null;let m=this.getBaseFilters();if(m.is_deleted="false",JSON.stringify(m)!==JSON.stringify(r)&&(t.clear(),this.currentPage=1,this.currentActiveFilters=m),t.has(e)){let _=t.get(e);return this.data=_,this.cd.detectChanges(),this.preloadPage(e+1,n,t),De({data:_,current_page:e,last_page:this.totalPages,total:this.totalItems})}return this.genericTableService.getPaginatedData(this.apiEndpoint,e,n,m).pipe(Te(1),pe(_=>{this.data=_.data,this.totalItems=_.total,this.totalPages=_.last_page,this.currentPage=_.current_page,t.set(e,_.data),this.cd.detectChanges(),this.preloadPage(e+1,n,t)}))}preloadPage(e,n,t){if(e>this.totalPages||t.has(e))return;let r=this.getBaseFilters();r.is_deleted="false",this.genericTableService.getPaginatedData(this.apiEndpoint,e,n,r).subscribe({next:m=>{t.set(e,m.data)},error:m=>{}})}loadActiveRequests(){return this.fetchPaginatedData(this.currentPage,this.itemsPerPage,this.activeRequestsCache,this.currentActiveFilters)}applyFilters(e){this.filterBusinessLogId=e.business_log_id||"",this.filterCreatedAt=e.created_at||"",this.filterOrigin=e.origin||"",this.filterEventType=e.event_type||"",this.filterModule=e.module||"",this.filterDescription=e.description||"",this.filterAffectedEntityType=e.affected_entity_type||"",this.filterAffectedEntityId=e.affected_entity_id||"",this.filterUserLoginId=e.user_login_id||"",this.filterUserEmail=e["user.user_email"]||"",this.filterContextData=e.context_data||"",this.filterSortBy=e.sort_by||"",this.filterSortDirection=e.sort_direction||"asc",this.forceFullRefresh()}clearFilters(){this.filterBusinessLogId="",this.filterCreatedAt="",this.filterOrigin="",this.filterEventType="",this.filterModule="",this.filterDescription="",this.filterAffectedEntityType="",this.filterAffectedEntityId="",this.filterUserLoginId="",this.filterUserEmail="",this.filterContextData="",this.filterSortBy="",this.filterSortDirection="asc",this.forceFullRefresh()}goToPage(e){e>=1&&e<=this.totalPages&&e!==this.currentPage&&(this.currentPage=e,this.loadActiveRequests().subscribe())}onItemsPerPageChange(e){let n=e.target,t=Number(n.value);t!==this.itemsPerPage&&(this.itemsPerPage=t,this.forceFullRefresh())}getPaginationArray(e,n){let r=Math.max(1,e-Math.floor(2.5)),m=Math.min(n,r+5-1);m-r+1<5&&(r=Math.max(1,m-5+1));let _=[];for(let f=r;f<=m;f++)_.push(f);return _}get pagesArray(){return this.getPaginationArray(this.currentPage,this.totalPages)}handleItemRestored(){this.forceFullRefresh()}handleItemDeleted(){this.forceFullRefresh()}forceFullRefresh(){this.activeRequestsCache.clear(),this.currentPage=1,this.isLoading=!0,this.cd.detectChanges(),this.loadActiveRequests().pipe(q(()=>{this.isLoading=!1,this.cd.detectChanges()})).subscribe()}handleCreateFormOpened(){this.selectedItemForEdit=null,this.showCreateForm=!this.showCreateForm}handleEditFormOpened(e){let n=W({},e);n.roles&&n.roles.length>0&&(n.role_id=n.roles[0].role_id),this.selectedItemForEdit=n,this.showCreateForm=!0}handleFormSubmitted(e){this.showCreateForm=!1,this.isLoading=!0;let n;e.id?n=this.updateData(e.id,e):n=this.postData(e),n.pipe(q(()=>{this.isLoading=!1,this.cd.detectChanges()})).subscribe({next:()=>{this.forceFullRefresh()},error:t=>{}})}onCancelForm(){this.showCreateForm=!1,this.selectedItemForEdit=null}trackById(e,n){return n.id}handleViewDetails(e){if(e.business_log_id===void 0||e.business_log_id===null){console.warn("Polo\u017Eka nem\xE1 business_log_id. Zobrazov\xE1n\xED detail\u016F zru\u0161eno.");return}this.errorMessage=null,this.isLoading=!0,this.cd.markForCheck(),this.getItemDetails(e.business_log_id).subscribe({next:n=>{console.log("Detaily \xFAsp\u011B\u0161n\u011B na\u010Dteny:",n),this.selectedItemForDetails=n,this.showDetails=!0,this.isLoading=!1,console.log("Stav showDetails nastaven na:",this.showDetails),this.cd.markForCheck()},error:n=>{console.error("Chyba p\u0159i na\u010D\xEDt\xE1n\xED detail\u016F:",n),this.isLoading=!1,this.errorMessage="Nepoda\u0159ilo se na\u010D\xEDst detaily polo\u017Eky.",this.cd.markForCheck()}})}handleCloseDetails(){this.selectedItemForDetails=null,this.showDetails=!1,console.log("Zobrazen\xED detail\u016F uzav\u0159eno. Stav showDetails:",this.showDetails)}static \u0275fac=function(n){return new(n||i)(v(L),v(z),v(xe),v(j),v(X))};static \u0275cmp=E({type:i,selectors:[["app-business-logs"]],features:[K],decls:7,vars:6,consts:[[1,"user-request-container","container","mx-auto","p-4"],["class","text-center text-blue-500",4,"ngIf"],["class","text-center text-red-500",4,"ngIf"],[4,"ngIf"],[3,"itemDetailColumns","itemData","closeDetails",4,"ngIf"],[1,"text-center","text-blue-500"],[1,"neutral_button",2,"margin-top","15px",3,"click"],[1,"text-center","text-red-500"],[1,"main-content-layout"],[3,"filtersApplied","filtersCleared","filterColumns","initialFilters","initialSortBy","initialSortDirection"],[1,"table-and-pagination-container"],[3,"itemDeleted","createFormOpened","editFormOpened","viewDetailsOpened","buttons","data","columns","tableCaption","isLoading","apiEndpoint","uploadsBaseUrl","isLogsTable"],[1,"pagination-controls-wrapper"],[1,"text-sm","text-gray-700","p-b-10"],[1,"flex","items-center","space-x-2","pg-m","p-b-10"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"items-per-page-select",3,"change","ngModelChange","ngModel"],["value","5"],["value","10"],["value","15"],["value","20"],["value","50"],["aria-label","Pagination",1,"pagination-nav"],[1,"pagination-button","first-page-btn",3,"click","disabled"],[1,"sr-only"],["xmlns","[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true"],["fill-rule","evenodd","d","M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule","evenodd"],[4,"ngFor","ngForOf"],[1,"pagination-button","last-page-btn",3,"click","disabled"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"pagination-button",3,"click","ngClass"],[3,"closeDetails","itemDetailColumns","itemData"]],template:function(n,t){n&1&&(a(0,"div",0),b(1,bo,2,0,"div",1)(2,Co,3,0,"div",1)(3,vo,2,1,"div",2)(4,xo,3,0,"div",2)(5,wo,34,31,"div",3),s(),b(6,Po,1,2,"app-generic-details",4)),n&2&&(c(),d("ngIf",t.isLoading),c(),d("ngIf",t.isLoading),c(),d("ngIf",t.errorMessage),c(),d("ngIf",t.errorMessage),c(),d("ngIf",!t.isLoading&&!t.errorMessage),c(),d("ngIf",t.showDetails))},dependencies:[M,ne,N,F,$,re,ae,oe,U,G,be,Ce,ve],styles:[".p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.pagination-nav[_ngcontent-%COMP%]{display:inline-flex;border-radius:.375rem;box-shadow:0 1px 2px #0000000d}.pg-m[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.pagination-button[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:.5rem .75rem;border:1px solid #D1D5DB;background-color:#fff;font-size:.875rem;font-weight:500;color:#4b5563;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,color .15s ease-in-out,box-shadow .15s ease-in-out;cursor:pointer;box-shadow:0 1px 2px #0000000d}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f9fafb;border-color:#a0aec0;box-shadow:0 2px 4px #0000001a}.pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background-color:#f3f4f6}.pagination-button.active-page[_ngcontent-%COMP%]{z-index:10;background-color:#eef2ff;border-color:#6366f1;color:#4f46e5;font-weight:700;cursor:default;box-shadow:0 2px 4px #6366f133}.pagination-button.first-page-btn[_ngcontent-%COMP%]{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.pagination-button.last-page-btn[_ngcontent-%COMP%]{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.pagination-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1.25rem;width:1.25rem;vertical-align:middle;fill:currentColor}.items-per-page-select[_ngcontent-%COMP%]{display:block;width:5rem;border-radius:.375rem;border:1px solid #D1D5DB;box-shadow:0 1px 2px #0000000d;padding:.375rem .75rem;font-size:.875rem;color:#4b5563;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.items-per-page-select[_ngcontent-%COMP%]:focus{border-color:#6366f1;box-shadow:0 0 0 3px #6366f133}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.main-content-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}@media (min-width: 1024px){.main-content-layout[_ngcontent-%COMP%]{flex-direction:row;gap:10px}.filter-form-container[_ngcontent-%COMP%]{width:25%;margin-bottom:0}.table-and-pagination-container[_ngcontent-%COMP%]{flex-grow:1}}.m-b-10[_ngcontent-%COMP%]{margin-bottom:10px}"],changeDetection:0})};var gt=i=>({"ng-invalid ng-touched":i});function So(i,o){if(i&1&&(a(0,"p",18)(1,"span"),p(2,"\u26A0"),s(),p(3),s()),i&2){let e=l();c(3),x(" ",e.errorMessage," ")}}function Do(i,o){i&1&&(a(0,"div",19),p(1," Star\xE9 heslo je povinn\xE9. "),s())}function To(i,o){i&1&&(a(0,"div",19),p(1," Nov\xE9 heslo je povinn\xE9. "),s())}function Eo(i,o){i&1&&(a(0,"div",19),p(1," Heslo mus\xED m\xEDt alespo\u0148 8 znak\u016F. "),s())}function Mo(i,o){i&1&&(a(0,"div",19),p(1," Potvrzen\xED nov\xE9ho hesla je povinn\xE9. "),s())}function Oo(i,o){i&1&&(a(0,"div",19),p(1," Hesla se neshoduj\xED. "),s())}function ko(i,o){i&1&&(a(0,"span"),p(1,"Ulo\u017Eit heslo"),s())}function Io(i,o){i&1&&(a(0,"span"),p(1,"Ukl\xE1d\xE1n\xED..."),s())}var lt=class i extends H{constructor(e,n,t,r,m,_){super(e,n);this.dataHandler=e;this.cd=n;this.fb=t;this.router=r;this.authService=m;this.alertDialogService=_;this.passwordForm=this.fb.group({old_password:["",[Ne.required]],new_password:["",[Ne.required,Ne.minLength(8)]],new_password_confirmation:["",[Ne.required]]},{validator:this.passwordsMatchValidator})}passwordForm;apiEndpoint="user_login";ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}passwordsMatchValidator(e){let n=e.get("new_password"),t=e.get("new_password_confirmation");return!n||!t||t.errors&&!t.errors.passwordsNotMatching?null:n.value!==t.value?(t.setErrors({passwordsNotMatching:!0}),{passwordsNotMatching:!0}):(t.setErrors(null),null)}onSubmit(){if(this.passwordForm.invalid){console.error("The form is invalid.");return}let e={old_password:this.passwordForm.get("old_password")?.value,new_password:this.passwordForm.get("new_password")?.value,new_password_confirmation:this.passwordForm.get("new_password_confirmation")?.value};console.log("Odes\xEDlan\xE1 data formul\xE1\u0159e:",e),this.updatePassword(parseInt(this.authService.getUserId(),10),e).subscribe({next:()=>{this.passwordForm.reset(),console.log("Password successfully changed."),this.alertDialogService.open("Zm\u011Bna hesla","Heslo bylo \xFAsp\u011B\u0161n\u011B zm\u011Bn\u011Bno.","success"),this.errorMessage=null,this.cd.markForCheck()},error:n=>{console.error("Error changing password:",n),this.errorMessage="Chyba p\u0159i zm\u011Bn\u011B hesla. Zkontrolujte pros\xEDm p\u016Fvodn\xED heslo.",this.cd.markForCheck()}})}static \u0275fac=function(n){return new(n||i)(v(L),v(z),v(Wt),v(X),v(j),v(le))};static \u0275cmp=E({type:i,selectors:[["app-personal-info"]],features:[K],decls:29,vars:19,consts:[[1,"personal-info-container"],[1,"password-card"],[1,"card-header"],[1,"card-title"],[1,"card-content"],[3,"ngSubmit","formGroup"],["class","error-message",4,"ngIf"],[1,"form-field"],["for","old_password"],["id","old_password","type","password","formControlName","old_password","required","",1,"form-control",3,"ngClass"],["class","error-text",4,"ngIf"],["for","new_password"],["id","new_password","type","password","formControlName","new_password","required","",1,"form-control",3,"ngClass"],["for","new_password_confirmation"],["id","new_password_confirmation","type","password","formControlName","new_password_confirmation","required","",1,"form-control",3,"ngClass"],[1,"button-container"],["type","submit",1,"confirm_button",3,"disabled"],[4,"ngIf"],[1,"error-message"],[1,"error-text"]],template:function(n,t){if(n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),p(4,"Zm\u011Bna hesla"),s()(),a(5,"div",4)(6,"form",5),h("ngSubmit",function(){return t.onSubmit()}),b(7,So,4,1,"p",6),a(8,"div",7)(9,"label",8),p(10,"Star\xE9 heslo"),s(),O(11,"input",9),b(12,Do,2,0,"div",10),s(),a(13,"div",7)(14,"label",11),p(15,"Nov\xE9 heslo"),s(),O(16,"input",12),b(17,To,2,0,"div",10)(18,Eo,2,0,"div",10),s(),a(19,"div",7)(20,"label",13),p(21,"Potvrzen\xED nov\xE9ho hesla"),s(),O(22,"input",14),b(23,Mo,2,0,"div",10)(24,Oo,2,0,"div",10),s(),a(25,"div",15)(26,"button",16),b(27,ko,2,0,"span",17)(28,Io,2,0,"span",17),s()()()()()()),n&2){let r,m,_,f,T,te,ce,_t;c(6),d("formGroup",t.passwordForm),c(),d("ngIf",t.errorMessage),c(4),d("ngClass",Y(13,gt,((r=t.passwordForm.get("old_password"))==null?null:r.invalid)&&((r=t.passwordForm.get("old_password"))==null?null:r.touched))),c(),d("ngIf",((m=t.passwordForm.get("old_password"))==null?null:m.hasError("required"))&&((m=t.passwordForm.get("old_password"))==null?null:m.touched)),c(4),d("ngClass",Y(15,gt,((_=t.passwordForm.get("new_password"))==null?null:_.invalid)&&((_=t.passwordForm.get("new_password"))==null?null:_.touched))),c(),d("ngIf",((f=t.passwordForm.get("new_password"))==null?null:f.hasError("required"))&&((f=t.passwordForm.get("new_password"))==null?null:f.touched)),c(),d("ngIf",((T=t.passwordForm.get("new_password"))==null?null:T.hasError("minlength"))&&((T=t.passwordForm.get("new_password"))==null?null:T.touched)),c(4),d("ngClass",Y(17,gt,((te=t.passwordForm.get("new_password_confirmation"))==null?null:te.invalid)&&((te=t.passwordForm.get("new_password_confirmation"))==null?null:te.touched))),c(),d("ngIf",((ce=t.passwordForm.get("new_password_confirmation"))==null?null:ce.hasError("required"))&&((ce=t.passwordForm.get("new_password_confirmation"))==null?null:ce.touched)),c(),d("ngIf",t.passwordForm.hasError("passwordsNotMatching")&&((_t=t.passwordForm.get("new_password_confirmation"))==null?null:_t.touched)),c(2),d("disabled",t.passwordForm.invalid||t.isLoading),c(),d("ngIf",!t.isLoading),c(),d("ngIf",t.isLoading)}},dependencies:[M,ne,F,Zt,Ye,Ie,U,Ke,Xe,jt,qt],styles:[".personal-info-container[_ngcontent-%COMP%]{font-family:Arial,sans-serif;box-sizing:border-box}.password-card[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;box-shadow:0 1px 2px #0000000d;background-color:#fff;max-width:300px;position:relative;border:1px solid #dee2e6;box-sizing:border-box}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem;border-bottom:1px solid #e9ecef;padding-bottom:.5rem}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:700;color:#333}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:.75rem}label[_ngcontent-%COMP%]{display:block;font-size:.8rem;font-weight:500;color:#444;margin-bottom:.15rem}.form-control[_ngcontent-%COMP%]{margin-top:.15rem;display:block;width:100%;border-radius:6px;border:1px solid #dee2e6;box-shadow:0 1px 2px #0000000d;padding:.3rem .5rem;font-size:.8rem;color:#444;outline:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;font-family:Arial,sans-serif}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 1px #6366f1,0 0 0 3px #6366f133;background-color:#fff}.error-message[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a;padding:.75rem;border-radius:6px;margin-bottom:1rem;display:flex;align-items:center;gap:8px;border:1px solid #dc3545}.error-text[_ngcontent-%COMP%]{color:#dc3545;font-size:.8rem;margin-top:.2rem}.form-control.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 1px #dc3545,0 0 0 3px #dc354540}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;margin-top:1.5rem;padding-top:1rem;border-top:1px solid #e9ecef}.button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#c8d1d8;cursor:not-allowed;opacity:.8;border-color:transparent}@media (max-width: 600px){.password-card[_ngcontent-%COMP%]{width:100%;margin:0 10px}}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.dialog-container[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;box-shadow:0 1px 2px #0000000d;background-color:#fff;max-width:400px;width:90%;position:relative;border:1px solid #dee2e6;box-sizing:border-box}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem;border-bottom:1px solid #e9ecef;padding-bottom:.5rem}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:#333}.dialog-content[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:.9rem;color:#444}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem;padding-top:1rem;border-top:1px solid #e9ecef}"]})};var Fo=[{path:"",component:et,children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:tt,canActivate:[ye],data:{permission:"view-dashboard"}},{path:"user-request",component:rt,canActivate:[ye],data:{permission:"view-user-requests"}},{path:"administrators",component:at,canActivate:[ye],data:{permission:"manage-administrators"}},{path:"business-logs",component:st,canActivate:[ye],data:{permission:"view-business-logs"}},{path:"personal-info",component:lt,canActivate:[ye],data:{permission:"view-personal-info"}}]}],vn=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=wt({type:i});static \u0275inj=yt({imports:[ze.forChild(Fo),ze]})};export{vn as a};
